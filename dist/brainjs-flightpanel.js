!function(){function t(t){return t*Math.PI/180}const e={skyColor:"#33f",earthColor:"#992",frontCameraFovY:200,majorWidth:100,minorWidth:60,zeroWidth:200,zeroGap:20,radialLimit:60,tickRadius:10,radialRadius:178,speedIndicatorHeight:250,speedIndicatorWidth:60,zeroPadding:100,speedAltOpacity:.2,pixelsPer10Kmph:50,minorTicksPer10Kmph:5,speedWarningWidth:10,yellowBoundarySpeed:100,redBoundarySpeed:130,altIndicatorHeight:250,altIndicatorWidth:50,majorTickWidth:10,minorTickWidth:5,pixelsPer100Ft:50,minorTicksPer100Ft:5};$$.control.registerControl("brainjs.flightpanel",{props:{roll:0,pitch:0,speed:0,altitude:0,options:{},showAltitude:!0,showSpeed:!0},init:function(i){const a=$.extend({},e,this.props.options);let l,o,r,n;var s=$("<canvas>").attr("width",640).attr("height",360).appendTo(i).get(0).getContext("2d"),h=s.canvas.height/(a.frontCameraFovY/2);function d(){!function(){var{radialRadius:t,majorWidth:e,minorWidth:i,skyColor:l,earthColor:o}=a;s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.rotate(-r);var d=n/(2*Math.PI)*360*h;s.translate(0,d),s.fillStyle=l,s.fillRect(-1e4,-1e4,2e4,1e4),s.fillStyle=o,s.fillRect(-1e4,0,2e4,1e4),s.strokeStyle="#fff",s.fillStyle="white",s.lineWidth=2,s.beginPath(),s.moveTo(-1e4,0),s.lineTo(2e4,0),s.stroke(),s.beginPath(),s.arc(0,-d,t,0,2*Math.PI,!1),s.closePath(),s.clip(),s.beginPath();for(var c=-18;c<=18;++c){var p=c/2*10;0!==c&&(c%2==0?(s.moveTo(-e/2,-h*p),s.lineTo(+e/2,-h*p),s.fillText(p,-e/2-20,10*-h/2*c),s.fillText(p,e/2+10,10*-h/2*c)):(s.moveTo(-i/2,-h*p),s.lineTo(+i/2,-h*p)))}s.closePath(),s.stroke(),s.restore()}(),function(){var{zeroWidth:t,zeroGap:e,radialRadius:i,radialLimit:l,tickRadius:o}=a;s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.strokeStyle="yellow",s.lineWidth=2,s.beginPath(),s.moveTo(-t/2,0),s.lineTo(-e/2,0),s.moveTo(+t/2,0),s.lineTo(+e/2,0),s.moveTo(-e/2,e/2),s.lineTo(0,0),s.lineTo(+e/2,e/2),s.stroke(),s.beginPath(),s.arc(0,0,i,-Math.PI/2-Math.PI*l/180,-Math.PI/2+Math.PI*l/180,!1),s.stroke();for(var r=-4;r<=4;++r)s.moveTo((i-o)*Math.cos(-Math.PI/2+15*r/180*Math.PI),(i-o)*Math.sin(-Math.PI/2+15*r/180*Math.PI)),s.lineTo(i*Math.cos(-Math.PI/2+15*r/180*Math.PI),i*Math.sin(-Math.PI/2+15*r/180*Math.PI));s.stroke(),s.restore()}(),function(){var{radialRadius:t}=a;s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.rotate(-r),s.fillStyle="white",s.lineWidth=2,s.beginPath(),s.moveTo(0,-t),s.lineTo(-5,10-t),s.lineTo(5,10-t),s.closePath(),s.fill();var e=Math.round(r/Math.PI/2*360)%360;e>180&&(e-=360),s.fillRect(-20,9-t,40,16),s.font="12px Arial",s.fillStyle="black",s.fillText(e,-7,22-t),s.restore()}(),o&&function(){var{speedIndicatorHeight:t,speedIndicatorWidth:e,speedWarningWidth:i,zeroPadding:l,zeroWidth:o,speedAltOpacity:r,yellowBoundarySpeed:n,redBoundarySpeed:h,pixelsPer10Kmph:d,majorTickWidth:c,minorTickWidth:p,minorTicksPer10Kmph:f,altIndicatorHeight:T,speed:v}=a;s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.translate(-o/2-l-e,0),s.fillStyle="rgba(0,0,0,"+r+")",s.strokeStyle="white",s.lineWidth=2,s.strokeRect(0,-t/2,e,t),s.fillRect(0,-t/2,e,t),s.restore(),s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.translate(-o/2-l-e,0),s.rect(0,-t/2,e,t),s.clip();var P=-(-v+n)/10*d,y=-(-v+h)/10*d;s.fillStyle="yellow",s.fillRect(e-i,P,i,y-P),s.fillStyle="red",s.fillRect(e-i,y,i,-t/2-y),s.fillStyle="green",s.fillRect(e-i,P,i,+t/2-P);for(var g=v/10*d,k=-Math.floor(v/10)-10,m=Math.ceil(v/10)+10,u=k;u<m;++u){for(s.moveTo(e-i,-u*d+g),s.lineTo(e-i-c,-u*d+g),j=1;j<f;++j)s.moveTo(e-i,-u*d-j*d/f+g),s.lineTo(e-i-p,-u*d-j*d/f+g);s.font="12px Arial",s.fillStyle="white",s.fillText(10*u,20,-u*d+g+4)}s.strokeStyle="white",s.lineWidth=2,s.stroke(),s.beginPath(),s.moveTo(e-i-p,0),s.lineTo(e-i-2*p,-5),s.lineTo(e-i-2*p,-10),s.lineTo(0,-10),s.lineTo(0,10),s.lineTo(e-i-2*p,10),s.lineTo(e-i-2*p,5),s.closePath(),s.fill(),s.strokeStyle="black",s.fillStyle="black",s.fillText(Math.round(100*v)/100,15,4.5,T),s.restore()}(),l&&function(){var{zeroWidth:t,zeroPadding:e,speedAltOpacity:i,altIndicatorHeight:l,altIndicatorWidth:o,pixelsPer100Ft:r,minorTickWidth:n,majorTickWidth:h,minorTicksPer100Ft:d,altitude:c}=a;s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.translate(t/2+e,0),s.fillStyle="rgba(0,0,0,"+i+")",s.strokeStyle="white",s.lineWidth=2,s.fillRect(0,-l/2,o,l),s.strokeRect(0,-l/2,o,l),s.restore(),s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.translate(t/2+e,0),s.rect(0,-l/2,o,l),s.clip();for(var p=c/1*r,f=Math.floor(c/1)-5,T=Math.ceil(c/1)+5,v=f;v<T;++v){s.moveTo(0,-v*r+p),s.lineTo(h,-v*r+p);for(var P=1;P<d;++P)s.moveTo(0,-v*r-P*r/d+p),s.lineTo(n,-v*r-P*r/d+p);s.font="12px Arial",s.fillStyle="white",s.fillText(1*v,15,-v*r+p+4)}s.strokeStyle="white",s.lineWidth=2,s.stroke(),s.restore(),s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.translate(t/2+e,0),s.strokeStyle="white",s.lineWidth=2,s.font="12px Arial",s.fillStyle="white",s.fillOpacity=1,s.beginPath(),s.moveTo(n,0),s.lineTo(2*n,-5),s.lineTo(2*n,-10),s.lineTo(o,-10),s.lineTo(o,10),s.lineTo(2*n,10),s.lineTo(2*n,5),s.closePath(),s.fill(),s.strokeStyle="black",s.fillStyle="black",s.fillText(Math.round(100*c)/100,15,4.5,l),s.restore()}()}this.setData=function(e){console.log("[flightpanel] setData",e),$.extend(this.props,e),l=this.props.showAltitude,o=this.props.showSpeed,r=t(this.props.roll),n=t(this.props.pitch),a.speed=this.props.speed,a.altitude=this.props.altitude,d()},this.setData()},$iface:"setData(data)"})}();
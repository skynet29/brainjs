/*
 Leaflet 1.0.3+ed36a04, a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2016 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*/
!function(t,e,i){function n(){var e=t.L;o.noConflict=function(){return t.L=e,this},t.L=o}var o={version:"1.0.3+ed36a04"};"object"==typeof module&&"object"==typeof module.exports?module.exports=o:"function"==typeof define&&define.amd&&define(o),"undefined"!=typeof t&&n(),o.Util={extend:function(t){var e,i,n,o;for(i=1,n=arguments.length;i<n;i++){o=arguments[i];for(e in o)t[e]=o[e]}return t},create:Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++o.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,s,r;return r=function(){n=!1,o&&(s.apply(i,o),o=!1)},s=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(r,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],s=n-o;return t===n&&i?t:((t-o)%s+s)%s+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return o.Util.trim(t).split(/\s+/)},setOptions:function(t,e){t.hasOwnProperty("options")||(t.options=t.options?o.Util.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&e.indexOf("?")!==-1?"&":"?")+n.join("&")},template:function(t,e){return t.replace(o.Util.templateRe,function(t,n){var o=e[n];if(o===i)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){return t["webkit"+e]||t["moz"+e]||t["ms"+e]}function i(e){var i=+new Date,o=Math.max(0,16-(i-n));return n=i+o,t.setTimeout(e,o)}var n=0,s=t.requestAnimationFrame||e("RequestAnimationFrame")||i,r=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};o.Util.requestAnimFrame=function(e,n,r){return r&&s===i?void e.call(n):s.call(t,o.bind(e,n))},o.Util.cancelAnimFrame=function(e){e&&r.call(t,e)}}(),o.extend=o.Util.extend,o.bind=o.Util.bind,o.stamp=o.Util.stamp,o.setOptions=o.Util.setOptions,o.Class=function(){},o.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,n=o.Util.create(i);n.constructor=e,e.prototype=n;for(var s in this)this.hasOwnProperty(s)&&"prototype"!==s&&(e[s]=this[s]);return t.statics&&(o.extend(e,t.statics),delete t.statics),t.includes&&(o.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=o.Util.extend(o.Util.create(n.options),t.options)),o.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;t<e;t++)n._initHooks[t].call(this)}},e},o.Class.include=function(t){return o.extend(this.prototype,t),this},o.Class.mergeOptions=function(t){return o.extend(this.prototype.options,t),this},o.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this},o.Evented=o.Class.extend({on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else{t=o.Util.splitWords(t);for(var s=0,r=t.length;s<r;s++)this._on(t[s],e,i)}return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=o.Util.splitWords(t);for(var s=0,r=t.length;s<r;s++)this._off(t[s],e,i)}else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var o=this._events[t];o||(o=[],this._events[t]=o),n===this&&(n=i);for(var s={fn:e,ctx:n},r=o,a=0,h=r.length;a<h;a++)if(r[a].fn===e&&r[a].ctx===n)return;r.push(s)},_off:function(t,e,n){var s,r,a;if(this._events&&(s=this._events[t])){if(!e){for(r=0,a=s.length;r<a;r++)s[r].fn=o.Util.falseFn;return void delete this._events[t]}if(n===this&&(n=i),s)for(r=0,a=s.length;r<a;r++){var h=s[r];if(h.ctx===n&&h.fn===e)return h.fn=o.Util.falseFn,this._firingCount&&(this._events[t]=s=s.slice()),void s.splice(r,1)}}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=o.Util.extend({},e,{type:t,target:this});if(this._events){var s=this._events[t];if(s){this._firingCount=this._firingCount+1||1;for(var r=0,a=s.length;r<a;r++){var h=s[r];h.fn.call(h.ctx||this,n)}this._firingCount--}}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var s=o.bind(function(){this.off(t,e,i).off(t,s,i)},this);return this.on(t,e,i).on(t,s,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[o.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[o.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,o.extend({layer:t.target},t),!0)}});var s=o.Evented.prototype;s.addEventListener=s.on,s.removeEventListener=s.clearAllEventListeners=s.off,s.addOneTimeEventListener=s.once,s.fireEvent=s.fire,s.hasEventListeners=s.listens,o.Mixin={Events:s},function(){var i=navigator.userAgent.toLowerCase(),n=e.documentElement,s="ActiveXObject"in t,r=i.indexOf("webkit")!==-1,a=i.indexOf("phantom")!==-1,h=i.search("android [23]")!==-1,l=i.indexOf("chrome")!==-1,u=i.indexOf("gecko")!==-1&&!r&&!t.opera&&!s,c=0===navigator.platform.indexOf("Win"),d="undefined"!=typeof orientation||i.indexOf("mobile")!==-1,_=!t.PointerEvent&&t.MSPointerEvent,m=t.PointerEvent||_,p=s&&"transition"in n.style,f="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!h,g="MozPerspective"in n.style,v="OTransition"in n.style,y=!t.L_NO_TOUCH&&(m||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch);o.Browser={ie:s,ielt9:s&&!e.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in e),webkit:r,gecko:u,android:i.indexOf("android")!==-1,android23:h,chrome:l,safari:!l&&i.indexOf("safari")!==-1,win:c,ie3d:p,webkit3d:f,gecko3d:g,opera12:v,any3d:!t.L_DISABLE_3D&&(p||f||g)&&!v&&!a,mobile:d,mobileWebkit:d&&r,mobileWebkit3d:d&&f,mobileOpera:d&&t.opera,mobileGecko:d&&u,touch:!!y,msPointer:!!_,pointer:!!m,retina:(t.devicePixelRatio||t.screen.deviceXDPI/t.screen.logicalXDPI)>1}}(),o.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},o.Point.prototype={clone:function(){return new o.Point(this.x,this.y)},add:function(t){return this.clone()._add(o.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(o.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new o.Point(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new o.Point(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){t=o.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=o.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=o.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+o.Util.formatNum(this.x)+", "+o.Util.formatNum(this.y)+")"}},o.point=function(t,e,n){return t instanceof o.Point?t:o.Util.isArray(t)?new o.Point(t[0],t[1]):t===i||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new o.Point(t.x,t.y):new o.Point(t,e,n)},o.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},o.Bounds.prototype={extend:function(t){return t=o.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new o.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new o.Point(this.min.x,this.max.y)},getTopRight:function(){return new o.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof o.Point?o.point(t):o.bounds(t),t instanceof o.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,s=t.max,r=s.x>=e.x&&n.x<=i.x,a=s.y>=e.y&&n.y<=i.y;return r&&a},overlaps:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,s=t.max,r=s.x>e.x&&n.x<i.x,a=s.y>e.y&&n.y<i.y;return r&&a},isValid:function(){return!(!this.min||!this.max)}},o.bounds=function(t,e){return!t||t instanceof o.Bounds?t:new o.Bounds(t,e)},o.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},o.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new o.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},o.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i]||t.currentStyle&&t.currentStyle[i];if((!n||"auto"===n)&&e.defaultView){var o=e.defaultView.getComputedStyle(t,null);n=o?o[i]:null}return"auto"===n?null:n},create:function(t,i,n){var o=e.createElement(t);return o.className=i||"",n&&n.appendChild(o),o},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=o.DomUtil.getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=o.Util.splitWords(e),s=0,r=n.length;s<r;s++)t.classList.add(n[s]);else if(!o.DomUtil.hasClass(t,e)){var a=o.DomUtil.getClass(t);o.DomUtil.setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):o.DomUtil.setClass(t,o.Util.trim((" "+o.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&o.DomUtil._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},setTransform:function(t,e,i){var n=e||new o.Point(0,0);t.style[o.DomUtil.TRANSFORM]=(o.Browser.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")},setPosition:function(t,e){t._leaflet_pos=e,o.Browser.any3d?o.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos||new o.Point(0,0)}},function(){o.DomUtil.TRANSFORM=o.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var i=o.DomUtil.TRANSITION=o.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(o.DomUtil.TRANSITION_END="webkitTransition"===i||"OTransition"===i?i+"End":"transitionend","onselectstart"in e)o.DomUtil.disableTextSelection=function(){o.DomEvent.on(t,"selectstart",o.DomEvent.preventDefault)},o.DomUtil.enableTextSelection=function(){o.DomEvent.off(t,"selectstart",o.DomEvent.preventDefault)};else{var n=o.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);o.DomUtil.disableTextSelection=function(){if(n){var t=e.documentElement.style;this._userSelect=t[n],t[n]="none"}},o.DomUtil.enableTextSelection=function(){n&&(e.documentElement.style[n]=this._userSelect,delete this._userSelect)}}o.DomUtil.disableImageDrag=function(){o.DomEvent.on(t,"dragstart",o.DomEvent.preventDefault)},o.DomUtil.enableImageDrag=function(){o.DomEvent.off(t,"dragstart",o.DomEvent.preventDefault)},o.DomUtil.preventOutline=function(e){for(;e.tabIndex===-1;)e=e.parentNode;e&&e.style&&(o.DomUtil.restoreOutline(),this._outlineElement=e,this._outlineStyle=e.style.outline,e.style.outline="none",o.DomEvent.on(t,"keydown",o.DomUtil.restoreOutline,this))},o.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,o.DomEvent.off(t,"keydown",o.DomUtil.restoreOutline,this))}}(),o.LatLng=function(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,n!==i&&(this.alt=+n)},o.LatLng.prototype={equals:function(t,e){if(!t)return!1;t=o.latLng(t);var n=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return n<=(e===i?1e-9:e)},toString:function(t){return"LatLng("+o.Util.formatNum(this.lat,t)+", "+o.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return o.CRS.Earth.distance(this,o.latLng(t))},wrap:function(){return o.CRS.Earth.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return o.latLngBounds([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new o.LatLng(this.lat,this.lng,this.alt)}},o.latLng=function(t,e,n){return t instanceof o.LatLng?t:o.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new o.LatLng(t[0],t[1],t[2]):2===t.length?new o.LatLng(t[0],t[1]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new o.LatLng(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===i?null:new o.LatLng(t,e,n)},o.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},o.LatLngBounds.prototype={extend:function(t){var e,i,n=this._southWest,s=this._northEast;if(t instanceof o.LatLng)e=t,i=t;else{if(!(t instanceof o.LatLngBounds))return t?this.extend(o.latLng(t)||o.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||s?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),s.lat=Math.max(i.lat,s.lat),s.lng=Math.max(i.lng,s.lng)):(this._southWest=new o.LatLng(e.lat,e.lng),this._northEast=new o.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,s=Math.abs(e.lng-i.lng)*t;return new o.LatLngBounds(new o.LatLng(e.lat-n,e.lng-s),new o.LatLng(i.lat+n,i.lng+s))},getCenter:function(){return new o.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new o.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new o.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof o.LatLng||"lat"in t?o.latLng(t):o.latLngBounds(t);var e,i,n=this._southWest,s=this._northEast;return t instanceof o.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=s.lat&&e.lng>=n.lng&&i.lng<=s.lng},intersects:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>=e.lat&&n.lat<=i.lat,a=s.lng>=e.lng&&n.lng<=i.lng;return r&&a},overlaps:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>e.lat&&n.lat<i.lat,a=s.lng>e.lng&&n.lng<i.lng;return r&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=o.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},o.latLngBounds=function(t,e){return t instanceof o.LatLngBounds?t:new o.LatLngBounds(t,e)},o.Projection={},o.Projection.LonLat={project:function(t){return new o.Point(t.lng,t.lat)},unproject:function(t){return new o.LatLng(t.y,t.x)},bounds:o.bounds([-180,-90],[180,90])},o.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),s=Math.sin(n*e);return new o.Point(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new o.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return o.bounds([-t,-t],[t,t])}()},o.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),n=this.transformation.transform(e.min,i),s=this.transformation.transform(e.max,i);return o.bounds(n,s)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?o.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?o.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat,n=t.alt;return o.latLng(i,e,n)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,s=e.lng-i.lng;if(0===n&&0===s)return t;var r=t.getSouthWest(),a=t.getNorthEast(),h=o.latLng({lat:r.lat-n,lng:r.lng-s}),l=o.latLng({lat:a.lat-n,lng:a.lng-s});return new o.LatLngBounds(h,l)}},o.CRS.Simple=o.extend({},o.CRS,{projection:o.Projection.LonLat,transformation:new o.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),o.CRS.Earth=o.extend({},o.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,s=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return this.R*Math.acos(Math.min(s,1))}}),o.CRS.EPSG3857=o.extend({},o.CRS.Earth,{code:"EPSG:3857",projection:o.Projection.SphericalMercator,transformation:function(){var t=.5/(Math.PI*o.Projection.SphericalMercator.R);return new o.Transformation(t,.5,-t,.5)}()}),o.CRS.EPSG900913=o.extend({},o.CRS.EPSG3857,{code:"EPSG:900913"}),o.CRS.EPSG4326=o.extend({},o.CRS.Earth,{code:"EPSG:4326",projection:o.Projection.LonLat,transformation:new o.Transformation(1/180,1,-1/180,.5)}),o.Map=o.Evented.extend({options:{crs:o.CRS.EPSG3857,center:i,zoom:i,minZoom:i,maxZoom:i,layers:[],maxBounds:i,renderer:i,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=o.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=o.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==i&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==i&&this.setView(o.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=o.DomUtil.TRANSITION&&o.Browser.any3d&&!o.Browser.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),o.DomEvent.on(this._proxy,o.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(o.latLng(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=o.extend({animate:n.animate},n.zoom),n.pan=o.extend({animate:n.animate,duration:n.duration},n.pan));var s=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(s)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(o.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(o.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),s=this.getSize().divideBy(2),r=t instanceof o.Point?t:this.latLngToContainerPoint(t),a=r.subtract(s).multiplyBy(1-1/n),h=this.containerPointToLatLng(s.add(a));return this.setView(h,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():o.latLngBounds(t);var i=o.point(e.paddingTopLeft||e.padding||[0,0]),n=o.point(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,i.add(n));s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s;var r=n.subtract(i).divideBy(2),a=this.project(t.getSouthWest(),s),h=this.project(t.getNorthEast(),s),l=this.unproject(a.add(h).divideBy(2).add(r),s);return{center:l,zoom:s}},fitBounds:function(t,e){if(t=o.latLngBounds(t),!t.isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=o.point(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new o.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){o.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){function s(t){var e=t?-1:1,i=t?v:g,n=v*v-g*g+e*L*L*y*y,o=2*i*L*y,s=n/o,r=Math.sqrt(s*s+1)-s,a=r<1e-9?-18:Math.log(r);return a}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function a(t){return(Math.exp(t)+Math.exp(-t))/2}function h(t){return r(t)/a(t)}function l(t){return g*(a(x)/a(x+P*t))}function u(t){return g*(a(x)*h(x+P*t)-r(x))/L}function c(t){return 1-Math.pow(1-t,1.5)}function d(){var i=(Date.now()-w)/T,n=c(i)*b;i<=1?(this._flyToFrame=o.Util.requestAnimFrame(d,this),this._move(this.unproject(_.add(m.subtract(_).multiplyBy(u(n)/y)),f),this.getScaleZoom(g/l(n),f),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(n=n||{},n.animate===!1||!o.Browser.any3d)return this.setView(t,e,n);this._stop();var _=this.project(this.getCenter()),m=this.project(t),p=this.getSize(),f=this._zoom;t=o.latLng(t),e=e===i?f:e;var g=Math.max(p.x,p.y),v=g*this.getZoomScale(f,e),y=m.distanceTo(_)||1,P=1.42,L=P*P,x=s(0),w=Date.now(),b=(s(1)-x)/P,T=n.duration?1e3*n.duration:1e3*b*.8;return this._moveStart(!0),d.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return t=o.latLngBounds(t),t.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,o.latLngBounds(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=o.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),s=i.divideBy(2).round(),r=n.subtract(s);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=o.extend({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o.bind(this._handleGeolocationResponse,this),i=o.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new o.LatLng(e,i),s=n.toBounds(t.coords.accuracy),r=this._locateOptions;if(r.setView){var a=this.getBoundsZoom(s);this.setView(n,r.maxZoom?Math.min(a,r.maxZoom):a)}var h={latlng:n,bounds:s,timestamp:t.timestamp};for(var l in t.coords)"number"==typeof t.coords[l]&&(h[l]=t.coords[l]);this.fire("locationfound",h)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=i,this._containerId=i}o.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var t in this._layers)this._layers[t].remove();return this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=o.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new o.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=o.latLngBounds(t),i=o.point(i||[0,0]);var n=this.getZoom()||0,s=this.getMinZoom(),r=this.getMaxZoom(),a=t.getNorthWest(),h=t.getSouthEast(),l=this.getSize().subtract(i),u=o.bounds(this.project(h,n),this.project(a,n)).getSize(),c=o.Browser.any3d?this.options.zoomSnap:1,d=Math.min(l.x/u.x,l.y/u.y);return n=this.getScaleZoom(d,n),c&&(n=Math.round(n/(c/100))*(c/100),n=e?Math.ceil(n/c)*c:Math.floor(n/c)*c),Math.max(s,Math.min(r,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new o.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new o.Bounds(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===i?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=e===i?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=e===i?this._zoom:e;var o=n.zoom(t*n.scale(e));return isNaN(o)?1/0:o},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(o.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(o.point(t),e)},layerPointToLatLng:function(t){var e=o.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(o.latLng(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(o.latLng(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(o.latLngBounds(t))},distance:function(t,e){return this.options.crs.distance(o.latLng(t),o.latLng(e))},containerPointToLayerPoint:function(t){return o.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return o.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(o.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(o.latLng(t)))},mouseEventToContainerPoint:function(t){return o.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=o.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");o.DomEvent.addListener(e,"scroll",this._onScroll,this),this._containerId=o.Util.stamp(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&o.Browser.any3d,
o.DomUtil.addClass(t,"leaflet-container"+(o.Browser.touch?" leaflet-touch":"")+(o.Browser.retina?" leaflet-retina":"")+(o.Browser.ielt9?" leaflet-oldie":"")+(o.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=o.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),o.DomUtil.setPosition(this._mapPane,new o.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(o.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),o.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){o.DomUtil.setPosition(this._mapPane,new o.Point(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,n){e===i&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return o.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){o.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(o.DomEvent){this._targets={},this._targets[o.stamp(this._container)]=this;var i=e?"off":"on";o.DomEvent[i](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&o.DomEvent[i](t,"resize",this._onResize,this),o.Browser.any3d&&this.options.transform3DLimit&&this[i]("moveend",this._onMoveEnd)}},_onResize:function(){o.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=o.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],s="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,a=!1;r;){if(i=this._targets[o.stamp(r)],i&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(s&&!o.DomEvent._isExternalTarget(r,t))break;if(n.push(i),s)break}if(r===this._container)break;r=r.parentNode}return n.length||a||s||!o.DomEvent._isExternalTarget(r,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!o.DomEvent._skipped(t)){var e="keypress"===t.type&&13===t.keyCode?"click":t.type;"mousedown"===e&&o.DomUtil.preventOutline(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_fireDOMEvent:function(t,e,i){if("click"===t.type){var n=o.Util.extend({},t);n.type="preclick",this._fireDOMEvent(n,n.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e)),i.length)){var s=i[0];"contextmenu"===e&&s.listens(e,!0)&&o.DomEvent.preventDefault(t);var r={originalEvent:t};if("keypress"!==t.type){var a=s instanceof o.Marker;r.containerPoint=a?this.latLngToContainerPoint(s.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=a?s.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var h=0;h<i.length;h++)if(i[h].fire(e,r,!0),r.originalEvent._stopped||i[h].options.nonBubblingEvents&&o.Util.indexOf(i[h].options.nonBubblingEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return o.DomUtil.getPosition(this._mapPane)||new o.Point(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var n=t&&e!==i?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return n.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return o.bounds([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),s=this.getSize().divideBy(2),r=new o.Bounds(n.subtract(s),n.add(s)),a=this._getBoundsOffset(r,i,e);return a.round().equals([0,0])?t:this.unproject(n.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new o.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=o.bounds(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),s=n.min.subtract(t.min),r=n.max.subtract(t.max),a=this._rebound(s.x,-r.x),h=this._rebound(s.y,-r.y);return new o.Point(a,h)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=o.Browser.any3d?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){o.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return!((e&&e.animate)!==!0&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)},_createAnimProxy:function(){var t=this._proxy=o.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var i=o.DomUtil.TRANSFORM,n=t.style[i];o.DomUtil.setTransform(t,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===t.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var e=this.getCenter(),i=this.getZoom();o.DomUtil.setTransform(t,this.project(e,i),this.getZoomScale(i,1))},this)},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/n);return!(i.animate!==!0&&!this.getSize().contains(s))&&(o.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,i,n){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,o.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),setTimeout(o.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(o.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),o.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}),o.map=function(t,e){return new o.Map(t,e)},o.Layer=o.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[o.stamp(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[o.stamp(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}}),o.Map.include({addLayer:function(t){var e=o.stamp(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=o.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&o.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?o.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[o.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=o.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-(1/0),n=this._getZoomSpan();for(var o in this._zoomBoundLayers){var s=this._zoomBoundLayers[o].options;t=s.minZoom===i?t:Math.min(t,s.minZoom),e=s.maxZoom===i?e:Math.max(e,s.maxZoom)}this._layersMaxZoom=e===-(1/0)?i:e,this._layersMinZoom=t===1/0?i:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===i&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===i&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var r="_leaflet_events";o.DomEvent={on:function(t,e,i,n){if("object"==typeof e)for(var s in e)this._on(t,s,e[s],i);else{e=o.Util.splitWords(e);for(var r=0,a=e.length;r<a;r++)this._on(t,e[r],i,n)}return this},off:function(t,e,i,n){if("object"==typeof e)for(var s in e)this._off(t,s,e[s],i);else{e=o.Util.splitWords(e);for(var r=0,a=e.length;r<a;r++)this._off(t,e[r],i,n)}return this},_on:function(e,i,n,s){var a=i+o.stamp(n)+(s?"_"+o.stamp(s):"");if(e[r]&&e[r][a])return this;var h=function(i){return n.call(s||e,i||t.event)},l=h;return o.Browser.pointer&&0===i.indexOf("touch")?this.addPointerListener(e,i,h,a):!o.Browser.touch||"dblclick"!==i||!this.addDoubleTapListener||o.Browser.pointer&&o.Browser.chrome?"addEventListener"in e?"mousewheel"===i?e.addEventListener("onwheel"in e?"wheel":"mousewheel",h,!1):"mouseenter"===i||"mouseleave"===i?(h=function(i){i=i||t.event,o.DomEvent._isExternalTarget(e,i)&&l(i)},e.addEventListener("mouseenter"===i?"mouseover":"mouseout",h,!1)):("click"===i&&o.Browser.android&&(h=function(t){return o.DomEvent._filterClick(t,l)}),e.addEventListener(i,h,!1)):"attachEvent"in e&&e.attachEvent("on"+i,h):this.addDoubleTapListener(e,h,a),e[r]=e[r]||{},e[r][a]=h,this},_off:function(t,e,i,n){var s=e+o.stamp(i)+(n?"_"+o.stamp(n):""),a=t[r]&&t[r][s];return a?(o.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,s):o.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,s):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",a,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,a,!1):"detachEvent"in t&&t.detachEvent("on"+e,a),t[r][s]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,o.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return o.DomEvent.on(t,"mousewheel",o.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=o.DomEvent.stopPropagation;return o.DomEvent.on(t,o.Draggable.START.join(" "),e),o.DomEvent.on(t,{click:o.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return o.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new o.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new o.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},_wheelPxFactor:o.Browser.win&&o.Browser.chrome?2:o.Browser.gecko?t.devicePixelRatio:1,getWheelDelta:function(t){return o.Browser.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/o.DomEvent._wheelPxFactor:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(t){o.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_isExternalTarget:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=o.DomEvent._lastClick&&i-o.DomEvent._lastClick;return n&&n>100&&n<500||t.target._simulatedClick&&!t._simulated?void o.DomEvent.stop(t):(o.DomEvent._lastClick=i,void e(t))}},o.DomEvent.addListener=o.DomEvent.on,o.DomEvent.removeListener=o.DomEvent.off,o.PosAnimation=o.Evented.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=o.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=o.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),o.DomUtil.setPosition(this._el,i),this.fire("step")},_complete:function(){o.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),o.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:o.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,s=this.R_MINOR/i,r=Math.sqrt(1-s*s),a=r*Math.sin(n),h=Math.tan(Math.PI/4-n/2)/Math.pow((1-a)/(1+a),r/2);return n=-i*Math.log(Math.max(h,1e-10)),new o.Point(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,s=this.R_MINOR/n,r=Math.sqrt(1-s*s),a=Math.exp(-t.y/n),h=Math.PI/2-2*Math.atan(a),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=r*Math.sin(h),e=Math.pow((1-e)/(1+e),r/2),u=Math.PI/2-2*Math.atan(a*e)-h,h+=u;return new o.LatLng(h*i,t.x*i/n)}},o.CRS.EPSG3395=o.extend({},o.CRS.Earth,{code:"EPSG:3395",projection:o.Projection.Mercator,transformation:function(){var t=.5/(Math.PI*o.Projection.Mercator.R);return new o.Transformation(t,.5,-t,.5)}()}),o.GridLayer=o.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:o.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:i,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){o.setOptions(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),o.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(o.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(o.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return e.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof o.Point?t:new o.Point(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-(1/0),1/0),o=0,s=i.length;o<s;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!o.Browser.ielt9){o.DomUtil.setOpacity(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var s=this._tiles[n];if(s.current&&s.loaded){var r=Math.min(1,(t-s.loaded)/200);o.DomUtil.setOpacity(s.el,r),r<1?e=!0:(s.active&&(i=!0),s.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(o.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=o.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=o.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t===i)return i;for(var n in this._levels)this._levels[n].el.children.length||n===t?this._levels[n].el.style.zIndex=e-Math.abs(t-n):(o.DomUtil.remove(this._levels[n].el),this._removeTilesAtZoom(n),delete this._levels[n]);var s=this._levels[t],r=this._map;return s||(s=this._levels[t]={},s.el=o.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),s.el.style.zIndex=e,s.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),s.zoom=t,this._setZoomTransform(s,r.getCenter(),r.getZoom()),o.Util.falseFn(s.el.offsetWidth)),this._level=s,s},_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)return void this._removeAllTiles();for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)o.DomUtil.remove(this._levels[t].el),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(t,e,i,n){var s=Math.floor(t/2),r=Math.floor(e/2),a=i-1,h=new o.Point(+s,+r);h.z=+a;var l=this._tileCoordsToKey(h),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),a>n&&this._retainParent(s,r,a,n))},_retainChildren:function(t,e,i,n){for(var s=2*t;s<2*t+2;s++)for(var r=2*e;r<2*e+2;r++){var a=new o.Point(s,r);a.z=i+1;var h=this._tileCoordsToKey(a),l=this._tiles[h];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<n&&this._retainChildren(s,r,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_setView:function(t,e,n,o){var s=Math.round(e);(this.options.maxZoom!==i&&s>this.options.maxZoom||this.options.minZoom!==i&&s<this.options.minZoom)&&(s=i);var r=this.options.updateWhenZooming&&s!==this._tileZoom;o&&!r||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),s!==i&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),s=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();o.Browser.any3d?o.DomUtil.setTransform(t.el,s,n):o.DomUtil.setPosition(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),s=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*n);return new o.Bounds(s.subtract(r),s.add(r))},_update:function(t){var n=this._map;if(n){var s=n.getZoom();if(t===i&&(t=n.getCenter()),this._tileZoom!==i){var r=this._getTiledPixelBounds(t),a=this._pxBoundsToTileRange(r),h=a.getCenter(),l=[],u=this.options.keepBuffer,c=new o.Bounds(a.getBottomLeft().subtract([u,-u]),a.getTopRight().add([u,-u]));for(var d in this._tiles){var _=this._tiles[d].coords;_.z===this._tileZoom&&c.contains(o.point(_.x,_.y))||(this._tiles[d].current=!1)}if(Math.abs(s-this._tileZoom)>1)return void this._setView(t,s);for(var m=a.min.y;m<=a.max.y;m++)for(var p=a.min.x;p<=a.max.x;p++){var f=new o.Point(p,m);if(f.z=this._tileZoom,this._isValidTile(f)){var g=this._tiles[this._tileCoordsToKey(f)];g?g.current=!0:l.push(f)}}if(l.sort(function(t,e){return t.distanceTo(h)-e.distanceTo(h)}),0!==l.length){this._loading||(this._loading=!0,this.fire("loading"));var v=e.createDocumentFragment();for(p=0;p<l.length;p++)this._addTile(l[p],v);this._level.el.appendChild(v)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return o.latLngBounds(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),s=n.add(i),r=e.unproject(n,t.z),a=e.unproject(s,t.z),h=new o.LatLngBounds(r,a);return this.options.noWrap||e.wrapLatLngBounds(h),h},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new o.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(o.DomUtil.remove(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){o.DomUtil.addClass(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=o.Util.falseFn,t.onmousemove=o.Util.falseFn,o.Browser.ielt9&&this.options.opacity<1&&o.DomUtil.setOpacity(t,this.options.opacity),o.Browser.android&&!o.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),s=this.createTile(this._wrapCoords(t),o.bind(this._tileReady,this,t));this._initTile(s),this.createTile.length<2&&o.Util.requestAnimFrame(o.bind(this._tileReady,this,t,null,s)),o.DomUtil.setPosition(s,i),this._tiles[n]={el:s,coords:t,current:!0},e.appendChild(s),this.fire("tileloadstart",{tile:s,coords:t})},_tileReady:function(t,e,i){if(this._map){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);i=this._tiles[n],i&&(i.loaded=+new Date,this._map._fadeAnimated?(o.DomUtil.setOpacity(i.el,0),o.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=o.Util.requestAnimFrame(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(o.DomUtil.addClass(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),o.Browser.ielt9||!this._map._fadeAnimated?o.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(o.bind(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new o.Point(this._wrapX?o.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?o.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new o.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),o.gridLayer=function(t){return new o.GridLayer(t)},o.TileLayer=o.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,e=o.setOptions(this,e),e.detectRetina&&o.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),o.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,i){var n=e.createElement("img");return o.DomEvent.on(n,"load",o.bind(this._tileOnLoad,this,i,n)),o.DomEvent.on(n,"error",o.bind(this._tileOnError,this,i,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:o.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return o.Util.template(this._url,o.extend(e,this.options))},_tileOnLoad:function(t,e){o.Browser.ielt9?setTimeout(o.bind(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.src!==n&&(e.src=n),t(i,e)},getTileSize:function(){var t=this._map,e=o.GridLayer.prototype.getTileSize.call(this),i=this._tileZoom+this.options.zoomOffset,n=this.options.minNativeZoom,s=this.options.maxNativeZoom;return null!==n&&i<n?e.divideBy(t.getZoomScale(n,i)).round():null!==s&&i>s?e.divideBy(t.getZoomScale(s,i)).round():e},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,i=this.options.zoomReverse,n=this.options.zoomOffset,o=this.options.minNativeZoom,s=this.options.maxNativeZoom;return i&&(t=e-t),t+=n,null!==o&&t<o?o:null!==s&&t>s?s:t},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=o.Util.falseFn,e.onerror=o.Util.falseFn,e.complete||(e.src=o.Util.emptyImageUrl,o.DomUtil.remove(e)))}}),o.tileLayer=function(t,e){return new o.TileLayer(t,e)},o.TileLayer.WMS=o.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=o.extend({},this.defaultWmsParams);for(var n in e)n in this.options||(i[n]=e[n]);e=o.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&o.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,o.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),n=this._crs.project(e.getSouthEast()),s=(this._wmsVersion>=1.3&&this._crs===o.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(","),r=o.TileLayer.prototype.getTileUrl.call(this,t);return r+o.Util.getParamString(this.wmsParams,r,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,e){return o.extend(this.wmsParams,t),e||this.redraw(),this}}),o.tileLayer.wms=function(t,e){return new o.TileLayer.WMS(t,e)},o.ImageOverlay=o.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(t,e,i){this._url=t,this._bounds=o.latLngBounds(e),o.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(o.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){o.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&o.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&o.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=t,this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=o.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=o.Util.falseFn,t.onmousemove=o.Util.falseFn,t.onload=o.bind(this.fire,this,"load"),this.options.crossOrigin&&(t.crossOrigin=""),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;
o.DomUtil.setTransform(this._image,i,e)},_reset:function(){var t=this._image,e=new o.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();o.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){o.DomUtil.setOpacity(this._image,this.options.opacity)}}),o.imageOverlay=function(t,e,i){return new o.ImageOverlay(t,e,i)},o.Icon=o.Class.extend({initialize:function(t){o.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var s=o.point(n),r=o.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return o.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),o.icon=function(t){return new o.Icon(t)},o.Icon.Default=o.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return o.Icon.Default.imagePath||(o.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||o.Icon.Default.imagePath)+o.Icon.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=o.DomUtil.create("div","leaflet-default-icon-path",e.body),i=o.DomUtil.getStyle(t,"background-image")||o.DomUtil.getStyle(t,"backgroundImage");return e.body.removeChild(t),0===i.indexOf("url")?i.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}}),o.Marker=o.Layer.extend({options:{icon:new o.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=o.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),o.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var s=t.icon.createShadow(this._shadow),r=!1;s!==this._shadow&&(this._removeShadow(),r=!0),s&&(o.DomUtil.addClass(s,e),s.alt=""),this._shadow=s,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),o.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&o.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){o.DomUtil.setPosition(this._icon,t),this._shadow&&o.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(o.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),o.Handler.MarkerDrag)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new o.Handler.MarkerDrag(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;o.DomUtil.setOpacity(this._icon,t),this._shadow&&o.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),o.marker=function(t,e){return new o.Marker(t,e)},o.DivIcon=o.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;if(i.innerHTML=n.html!==!1?n.html:"",n.bgPos){var s=o.point(n.bgPos);i.style.backgroundPosition=-s.x+"px "+-s.y+"px"}return this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),o.divIcon=function(t){return new o.DivIcon(t)},o.DivOverlay=o.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){o.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&o.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&o.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(o.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(o.bind(o.DomUtil.remove,o.DomUtil,this._container),200)):o.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&o.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&o.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=o.point(this.options.offset),i=this._getAnchor();this._zoomAnimated?o.DomUtil.setPosition(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}}),o.Popup=o.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){o.DivOverlay.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof o.Path||this._source.on("preclick",o.DomEvent.stopPropagation))},onRemove:function(t){o.DivOverlay.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof o.Path||this._source.off("preclick",o.DomEvent.stopPropagation))},getEvents:function(){var t=o.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=o.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var i=this._closeButton=o.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",o.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var n=this._wrapper=o.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=o.DomUtil.create("div",t+"-content",n),o.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",o.DomEvent.stopPropagation),this._tipContainer=o.DomUtil.create("div",t+"-tip-container",e),this._tip=o.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,s=this.options.maxHeight,r="leaflet-popup-scrolled";s&&n>s?(e.height=s+"px",o.DomUtil.addClass(t,r)):o.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();o.DomUtil.setPosition(this._container,e.add(i))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(o.DomUtil.getStyle(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,s=new o.Point(this._containerLeft,-i-this._containerBottom);s._add(o.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(s),a=o.point(this.options.autoPanPadding),h=o.point(this.options.autoPanPaddingTopLeft||a),l=o.point(this.options.autoPanPaddingBottomRight||a),u=t.getSize(),c=0,d=0;r.x+n+l.x>u.x&&(c=r.x+n-u.x+l.x),r.x-c-h.x<0&&(c=r.x-h.x),r.y+i+l.y>u.y&&(d=r.y+i-u.y+l.y),r.y-d-h.y<0&&(d=r.y-h.y),(c||d)&&t.fire("autopanstart").panBy([c,d])}},_onCloseButtonClick:function(t){this._close(),o.DomEvent.stop(t)},_getAnchor:function(){return o.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),o.popup=function(t,e){return new o.Popup(t,e)},o.Map.mergeOptions({closePopupOnClick:!0}),o.Map.include({openPopup:function(t,e,i){return t instanceof o.Popup||(t=new o.Popup(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),o.Layer.include({bindPopup:function(t,e){return t instanceof o.Popup?(o.setOptions(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new o.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof o.Layer||(e=t,t=this),t instanceof o.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;if(this._popup&&this._map)return o.DomEvent.stop(t),e instanceof o.Path?void this.openPopup(t.layer||t.target,t.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),o.Tooltip=o.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){o.DivOverlay.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){o.DivOverlay.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=o.DivOverlay.prototype.getEvents.call(this);return o.Browser.touch&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=o.DomUtil.create("div",e)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),s=e.layerPointToContainerPoint(t),r=this.options.direction,a=i.offsetWidth,h=i.offsetHeight,l=o.point(this.options.offset),u=this._getAnchor();"top"===r?t=t.add(o.point(-a/2+l.x,-h+l.y+u.y,!0)):"bottom"===r?t=t.subtract(o.point(a/2-l.x,-l.y,!0)):"center"===r?t=t.subtract(o.point(a/2+l.x,h/2-u.y+l.y,!0)):"right"===r||"auto"===r&&s.x<n.x?(r="right",t=t.add(o.point(l.x+u.x,u.y-h/2+l.y,!0))):(r="left",t=t.subtract(o.point(a+u.x-l.x,h/2-u.y-l.y,!0))),o.DomUtil.removeClass(i,"leaflet-tooltip-right"),o.DomUtil.removeClass(i,"leaflet-tooltip-left"),o.DomUtil.removeClass(i,"leaflet-tooltip-top"),o.DomUtil.removeClass(i,"leaflet-tooltip-bottom"),o.DomUtil.addClass(i,"leaflet-tooltip-"+r),o.DomUtil.setPosition(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&o.DomUtil.setOpacity(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return o.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),o.tooltip=function(t,e){return new o.Tooltip(t,e)},o.Map.include({openTooltip:function(t,e,i){return t instanceof o.Tooltip||(t=new o.Tooltip(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),o.Layer.include({bindTooltip:function(t,e){return t instanceof o.Tooltip?(o.setOptions(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=o.tooltip(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),o.Browser.touch&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof o.Layer||(e=t,t=this),t instanceof o.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(o.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(o.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:i)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}}),o.LayerGroup=o.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;e<i;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return o.stamp(t)}}),o.layerGroup=function(t){return new o.LayerGroup(t)},o.FeatureGroup=o.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),o.LayerGroup.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),o.LayerGroup.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new o.LatLngBounds;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),o.featureGroup=function(t){return new o.FeatureGroup(t)},o.Renderer=o.Layer.extend({options:{padding:.1},initialize:function(t){o.setOptions(this,t),o.stamp(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&o.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){o.DomUtil.remove(this._container),this.off("update",this._updatePaths,this)},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=o.DomUtil.getPosition(this._container),s=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),a=this._map.project(t,e),h=a.subtract(r),l=s.multiplyBy(-i).add(n).add(s).subtract(h);o.Browser.any3d?o.DomUtil.setTransform(this._container,l,i):o.DomUtil.setPosition(this._container,l)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new o.Bounds(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),o.Map.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&o.canvas()||o.svg()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||t===i)return!1;var e=this._paneRenderers[t];return e===i&&(e=o.SVG&&o.svg({pane:t})||o.Canvas&&o.canvas({pane:t}),this._paneRenderers[t]=e),e}}),o.Path=o.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return o.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(o.Browser.touch?10:0)}}),o.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,o=typeof Uint8Array!=i+""?Uint8Array:Array,s=new o(n);s[0]=s[n-1]=1,this._simplifyDPStep(t,s,e,0,n-1);var r,a=[];for(r=0;r<n;r++)s[r]&&a.push(t[r]);return a},_simplifyDPStep:function(t,e,i,n,o){var s,r,a,h=0;for(r=n+1;r<=o-1;r++)a=this._sqClosestPointOnSegment(t[r],t[n],t[o],!0),a>h&&(s=r,h=a);h>i&&(e[s]=1,this._simplifyDPStep(t,e,i,n,s),this._simplifyDPStep(t,e,i,s,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,s=t.length;n<s;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return o<s-1&&i.push(t[s-1]),i},clipSegment:function(t,e,i,n,o){var s,r,a,h=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(h|l))return[t,e];if(h&l)return!1;s=h||l,r=this._getEdgeIntersection(t,e,s,i,o),a=this._getBitCode(r,i),s===h?(t=r,h=a):(e=r,l=a)}},_getEdgeIntersection:function(t,e,i,n,s){var r,a,h=e.x-t.x,l=e.y-t.y,u=n.min,c=n.max;return 8&i?(r=t.x+h*(c.y-t.y)/l,a=c.y):4&i?(r=t.x+h*(u.y-t.y)/l,a=u.y):2&i?(r=c.x,a=t.y+l*(c.x-t.x)/h):1&i&&(r=u.x,a=t.y+l*(u.x-t.x)/h),new o.Point(r,a,s)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var s,r=e.x,a=e.y,h=i.x-r,l=i.y-a,u=h*h+l*l;return u>0&&(s=((t.x-r)*h+(t.y-a)*l)/u,s>1?(r=i.x,a=i.y):s>0&&(r+=h*s,a+=l*s)),h=t.x-r,l=t.y-a,n?h*h+l*l:new o.Point(r,a)}},o.Polyline=o.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){o.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,s=null,r=o.LineUtil._sqClosestPointOnSegment,a=0,h=this._parts.length;a<h;a++)for(var l=this._parts[a],u=1,c=l.length;u<c;u++){e=l[u-1],i=l[u];var d=r(t,e,i,!0);d<n&&(n=d,s=r(t,e,i))}return s&&(s.distance=Math.sqrt(n)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,s,r,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,e=0;t<h-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<h-1;t++)if(o=a[t],s=a[t+1],i=o.distanceTo(s),n+=i,n>e)return r=(n-e)/i,this._map.layerPointToLatLng([s.x-r*(s.x-o.x),s.y-r*(s.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=o.latLng(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new o.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return o.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=o.Polyline._flat(t),n=0,s=t.length;n<s;n++)i?(e[n]=o.latLng(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new o.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new o.Point(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,s,r=t[0]instanceof o.LatLng,a=t.length;if(r){for(s=[],n=0;n<a;n++)s[n]=this._map.latLngToLayerPoint(t[n]),i.extend(s[n]);e.push(s)}else for(n=0;n<a;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);var e,i,n,s,r,a,h,l=this._parts;for(e=0,n=0,s=this._rings.length;e<s;e++)for(h=this._rings[e],i=0,r=h.length;i<r-1;i++)a=o.LineUtil.clipSegment(h[i],h[i+1],t,i,!0),a&&(l[n]=l[n]||[],l[n].push(a[0]),a[1]===h[i+1]&&i!==r-2||(l[n].push(a[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=o.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),o.polyline=function(t,e){return new o.Polyline(t,e)},o.Polyline._flat=function(t){return!o.Util.isArray(t[0])||"object"!=typeof t[0][0]&&"undefined"!=typeof t[0][0]},o.PolyUtil={},o.PolyUtil.clipPolygon=function(t,e,i){var n,s,r,a,h,l,u,c,d,_=[1,4,2,8],m=o.LineUtil;for(s=0,u=t.length;s<u;s++)t[s]._code=m._getBitCode(t[s],e);for(a=0;a<4;a++){for(c=_[a],n=[],s=0,u=t.length,r=u-1;s<u;r=s++)h=t[s],l=t[r],h._code&c?l._code&c||(d=m._getEdgeIntersection(l,h,c,e,i),d._code=m._getBitCode(d,e),n.push(d)):(l._code&c&&(d=m._getEdgeIntersection(l,h,c,e,i),d._code=m._getBitCode(d,e),n.push(d)),n.push(h));t=n}return t},o.Polygon=o.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,s,r,a,h,l=this._rings[0],u=l.length;if(!u)return null;for(s=r=a=0,t=0,e=u-1;t<u;e=t++)i=l[t],n=l[e],o=i.y*n.x-n.y*i.x,r+=(i.x+n.x)*o,a+=(i.y+n.y)*o,s+=3*o;return h=0===s?l[0]:[r/s,a/s],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var e=o.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof o.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){o.Polyline.prototype._setLatLngs.call(this,t),o.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return o.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new o.Point(e,e);if(t=new o.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);for(var n,s=0,r=this._rings.length;s<r;s++)n=o.PolyUtil.clipPolygon(this._rings[s],t,!0),n.length&&this._parts.push(n)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),o.polygon=function(t,e){return new o.Polygon(t,e)},o.Rectangle=o.Polygon.extend({initialize:function(t,e){o.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=o.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),o.rectangle=function(t,e){return new o.Rectangle(t,e)},o.CircleMarker=o.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=o.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return o.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new o.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),o.circleMarker=function(t,e){return new o.CircleMarker(t,e)},o.Circle=o.CircleMarker.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=o.extend({},i,{radius:e})),o.setOptions(this,e),this._latlng=o.latLng(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,
this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new o.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:o.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===o.CRS.Earth.distance){var s=Math.PI/180,r=this._mRadius/o.CRS.Earth.R/s,a=i.project([e+r,t]),h=i.project([e-r,t]),l=a.add(h).divideBy(2),u=i.unproject(l).lat,c=Math.acos((Math.cos(r*s)-Math.sin(e*s)*Math.sin(u*s))/(Math.cos(e*s)*Math.cos(u*s)))/s;(isNaN(c)||0===c)&&(c=r/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(c)?0:Math.max(Math.round(l.x-i.project([u,t-c]).x),1),this._radiusY=Math.max(Math.round(l.y-a.y),1)}else{var d=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(d).x}this._updateBounds()}}),o.circle=function(t,e,i){return new o.Circle(t,e,i)},o.SVG=o.Renderer.extend({getEvents:function(){var t=o.Renderer.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=o.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=o.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){o.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),o.DomUtil.setPosition(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=o.SVG.create("path");t.options.className&&o.DomUtil.addClass(e,t.options.className),t.options.interactive&&o.DomUtil.addClass(e,"leaflet-interactive"),this._updateStyle(t),this._layers[o.stamp(t)]=t},_addPath:function(t){this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){o.DomUtil.remove(t._path),t.removeInteractiveTarget(t._path),delete this._layers[o.stamp(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,o.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n=t._radiusY||i,o="a"+i+","+n+" 0 1,0 ",s=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+o+2*i+",0 "+o+2*-i+",0 ";this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){o.DomUtil.toFront(t._path)},_bringToBack:function(t){o.DomUtil.toBack(t._path)}}),o.extend(o.SVG,{create:function(t){return e.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,n,s,r,a,h,l="";for(i=0,s=t.length;i<s;i++){for(a=t[i],n=0,r=a.length;n<r;n++)h=a[n],l+=(n?"L":"M")+h.x+" "+h.y;l+=e?o.Browser.svg?"z":"x":""}return l||"M0 0"}}),o.Browser.svg=!(!e.createElementNS||!o.SVG.create("svg").createSVGRect),o.svg=function(t){return o.Browser.svg||o.Browser.vml?new o.SVG(t):null},o.Browser.vml=!o.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(t){return!1}}(),o.SVG.include(o.Browser.vml?{_initContainer:function(){this._container=o.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(o.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=o.SVG.create("shape");o.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=o.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[o.stamp(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;o.DomUtil.remove(e),t.removeInteractiveTarget(e),delete this._layers[o.stamp(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,s=t._container;s.stroked=!!n.stroke,s.filled=!!n.fill,n.stroke?(e||(e=t._stroke=o.SVG.create("stroke")),s.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=o.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(s.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=o.SVG.create("fill")),s.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(s.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){o.DomUtil.toFront(t._container)},_bringToBack:function(t){o.DomUtil.toBack(t._container)}}:{}),o.Browser.vml&&(o.SVG.create=function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),o.Canvas=o.Renderer.extend({getEvents:function(){var t=o.Renderer.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){o.Renderer.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=e.createElement("canvas");o.DomEvent.on(t,"mousemove",o.Util.throttle(this._onMouseMove,32,this),this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},o.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=o.Browser.retina?2:1;o.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",o.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){o.Renderer.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[o.stamp(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[o.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(","),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||o.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(t){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new o.Bounds,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,o,s,r=t._parts,a=r.length,h=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,h.beginPath(),h.setLineDash&&h.setLineDash(t.options&&t.options._dashArray||[]),i=0;i<a;i++){for(n=0,o=r[i].length;n<o;n++)s=r[i][n],h[n?"lineTo":"moveTo"](s.x,s.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),s=this._drawFirst;s;s=s.next)e=s.layer,e.options.interactive&&e._containsPoint(n)&&!this._map._draggableMoved(e)&&(i=e);i&&(o.DomEvent._fakeStop(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(o.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var i,n,s=this._drawFirst;s;s=s.next)i=s.layer,i.options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(o.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order,i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),o.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),o.canvas=function(t){return o.Browser.canvas?new o.Canvas(t):null},o.Polyline.prototype._containsPoint=function(t,e){var i,n,s,r,a,h,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;i<r;i++)for(h=this._parts[i],n=0,a=h.length,s=a-1;n<a;s=n++)if((e||0!==n)&&o.LineUtil.pointToSegmentDistance(t,h[s],h[n])<=l)return!0;return!1},o.Polygon.prototype._containsPoint=function(t){var e,i,n,s,r,a,h,l,u=!1;if(!this._pxBounds.contains(t))return!1;for(s=0,h=this._parts.length;s<h;s++)for(e=this._parts[s],r=0,l=e.length,a=l-1;r<l;a=r++)i=e[r],n=e[a],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u||o.Polyline.prototype._containsPoint.call(this,t,!0)},o.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},o.GeoJSON=o.FeatureGroup.extend({initialize:function(t,e){o.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,s=o.Util.isArray(t)?t:t.features;if(s){for(e=0,i=s.length;e<i;e++)n=s[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var a=o.GeoJSON.geometryToLayer(t,r);return a?(a.feature=o.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),r.onEachFeature&&r.onEachFeature(t,a),this.addLayer(a)):this},resetStyle:function(t){return t.options=o.Util.extend({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),o.extend(o.GeoJSON,{geometryToLayer:function(t,e){var i,n,s,r,a="Feature"===t.type?t.geometry:t,h=a?a.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||this.coordsToLatLng;if(!h&&!a)return null;switch(a.type){case"Point":return i=c(h),u?u(t,i):new o.Marker(i);case"MultiPoint":for(s=0,r=h.length;s<r;s++)i=c(h[s]),l.push(u?u(t,i):new o.Marker(i));return new o.FeatureGroup(l);case"LineString":case"MultiLineString":return n=this.coordsToLatLngs(h,"LineString"===a.type?0:1,c),new o.Polyline(n,e);case"Polygon":case"MultiPolygon":return n=this.coordsToLatLngs(h,"Polygon"===a.type?1:2,c),new o.Polygon(n,e);case"GeometryCollection":for(s=0,r=a.geometries.length;s<r;s++){var d=this.geometryToLayer({geometry:a.geometries[s],type:"Feature",properties:t.properties},e);d&&l.push(d)}return new o.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new o.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],s=0,r=t.length;s<r;s++)n=e?this.coordsToLatLngs(t[s],e-1,i):(i||this.coordsToLatLng)(t[s]),o.push(n);return o},latLngToCoords:function(t){return t.alt!==i?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var n=[],s=0,r=t.length;s<r;s++)n.push(e?o.GeoJSON.latLngsToCoords(t[s],e-1,i):o.GeoJSON.latLngToCoords(t[s]));return!e&&i&&n.push(n[0]),n},getFeature:function(t,e){return t.feature?o.extend({},t.feature,{geometry:e}):o.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var a={toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"Point",coordinates:o.GeoJSON.latLngToCoords(this.getLatLng())})}};o.Marker.include(a),o.Circle.include(a),o.CircleMarker.include(a),o.Polyline.prototype.toGeoJSON=function(){var t=!o.Polyline._flat(this._latlngs),e=o.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return o.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},o.Polygon.prototype.toGeoJSON=function(){var t=!o.Polyline._flat(this._latlngs),e=t&&!o.Polyline._flat(this._latlngs[0]),i=o.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t||(i=[i]),o.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},o.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),o.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var n=t.toGeoJSON();i.push(e?n.geometry:o.GeoJSON.asFeature(n))}}),e?o.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),o.geoJSON=function(t,e){return new o.GeoJSON(t,e)},o.geoJson=o.geoJSON,o.Draggable=o.Evented.extend({options:{clickTolerance:3},statics:{START:o.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e,i){this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(o.DomEvent.on(this._dragStartTarget,o.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(o.Draggable._dragging===this&&this.finishDrag(),o.DomEvent.off(this._dragStartTarget,o.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!o.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(o.Draggable._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(o.Draggable._dragging=this,this._preventOutline&&o.DomUtil.preventOutline(this._element),o.DomUtil.disableImageDrag(),o.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var i=t.touches?t.touches[0]:t;this._startPoint=new o.Point(i.clientX,i.clientY),o.DomEvent.on(e,o.Draggable.MOVE[t.type],this._onMove,this).on(e,o.Draggable.END[t.type],this._onUp,this)}},_onMove:function(i){if(!i._simulated&&this._enabled){if(i.touches&&i.touches.length>1)return void(this._moved=!0);var n=i.touches&&1===i.touches.length?i.touches[0]:i,s=new o.Point(n.clientX,n.clientY),r=s.subtract(this._startPoint);(r.x||r.y)&&(Math.abs(r.x)+Math.abs(r.y)<this.options.clickTolerance||(o.DomEvent.preventDefault(i),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=o.DomUtil.getPosition(this._element).subtract(r),o.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,t.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),o.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,o.Util.cancelAnimFrame(this._animRequest),this._lastEvent=i,this._animRequest=o.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),o.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){o.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(o.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in o.Draggable.MOVE)o.DomEvent.off(e,o.Draggable.MOVE[t],this._onMove,this).off(e,o.Draggable.END[t],this._onUp,this);o.DomUtil.enableImageDrag(),o.DomUtil.enableTextSelection(),this._moved&&this._moving&&(o.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,o.Draggable._dragging=!1}}),o.Handler=o.Class.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),o.Map.mergeOptions({dragging:!0,inertia:!o.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),o.Map.Drag=o.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new o.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}o.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){o.DomUtil.removeClass(this._map._container,"leaflet-grab"),o.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var t=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=o.latLngBounds(this._map.options.maxBounds);this._offsetLimit=o.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,s=(n+e+i)%t-e-i,r=Math.abs(o+i)<Math.abs(s+i)?o:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,a=i.easeLinearity,h=s.multiplyBy(a/r),l=h.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,l),c=h.multiplyBy(u/l),d=u/(i.inertiaDeceleration*a),_=c.multiplyBy(-d/2).round();_.x||_.y?(_=e._limitOffset(_,e.options.maxBounds),o.Util.requestAnimFrame(function(){e.panBy(_,{duration:d,easeLinearity:a,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}}),o.Map.addInitHook("addHandler","dragging",o.Map.Drag),o.Map.mergeOptions({doubleClickZoom:!0}),o.Map.DoubleClickZoom=o.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}}),o.Map.addInitHook("addHandler","doubleClickZoom",o.Map.DoubleClickZoom),o.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),o.Map.ScrollWheelZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){o.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=o.DomEvent.getWheelDelta(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o.bind(this._performZoom,this),n),o.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,s=i?Math.ceil(o/i)*i:o,r=t._limitZoom(e+(this._delta>0?s:-s))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}}),o.Map.addInitHook("addHandler","scrollWheelZoom",o.Map.ScrollWheelZoom),o.extend(o.DomEvent,{_touchstart:o.Browser.msPointer?"MSPointerDown":o.Browser.pointer?"pointerdown":"touchstart",_touchend:o.Browser.msPointer?"MSPointerUp":o.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function n(t){var e;if(o.Browser.pointer){if(!o.Browser.edge||"mouse"===t.pointerType)return;e=o.DomEvent._pointersCount}else e=t.touches.length;if(!(e>1)){var i=Date.now(),n=i-(r||i);a=t.touches?t.touches[0]:t,h=n>0&&n<=l,r=i}}function s(t){if(h&&!a.cancelBubble){if(o.Browser.pointer){if(!o.Browser.edge||"mouse"===t.pointerType)return;var i,n,s={};for(n in a)i=a[n],s[n]=i&&i.bind?i.bind(a):i;a=s}a.type="dblclick",e(a),r=null}}var r,a,h=!1,l=250,u="_leaflet_",c=this._touchstart,d=this._touchend;return t[u+c+i]=n,t[u+d+i]=s,t[u+"dblclick"+i]=e,t.addEventListener(c,n,!1),t.addEventListener(d,s,!1),t.addEventListener("dblclick",e,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",n=t[i+this._touchstart+e],s=t[i+this._touchend+e],r=t[i+"dblclick"+e];return t.removeEventListener(this._touchstart,n,!1),t.removeEventListener(this._touchend,s,!1),o.Browser.edge||t.removeEventListener("dblclick",r,!1),this}}),o.extend(o.DomEvent,{POINTER_DOWN:o.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:o.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:o.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:o.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,i,n){var s=o.bind(function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(t.target.tagName)<0))return;o.DomEvent.preventDefault(t)}this._handlePointer(t,i)},this);if(t["_leaflet_touchstart"+n]=s,t.addEventListener(this.POINTER_DOWN,s,!1),!this._pointerDocListener){var r=o.bind(this._globalPointerUp,this);e.documentElement.addEventListener(this.POINTER_DOWN,o.bind(this._globalPointerDown,this),!0),e.documentElement.addEventListener(this.POINTER_MOVE,o.bind(this._globalPointerMove,this),!0),e.documentElement.addEventListener(this.POINTER_UP,r,!0),e.documentElement.addEventListener(this.POINTER_CANCEL,r,!0),this._pointerDocListener=!0}},_globalPointerDown:function(t){this._pointers[t.pointerId]=t,this._pointersCount++},_globalPointerMove:function(t){this._pointers[t.pointerId]&&(this._pointers[t.pointerId]=t)},_globalPointerUp:function(t){delete this._pointers[t.pointerId],this._pointersCount--},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var n=o.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&this._handlePointer(t,e)},this);t["_leaflet_touchmove"+i]=n,t.addEventListener(this.POINTER_MOVE,n,!1)},_addPointerEnd:function(t,e,i){var n=o.bind(function(t){this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=n,t.addEventListener(this.POINTER_UP,n,!1),t.addEventListener(this.POINTER_CANCEL,n,!1)}}),o.Map.mergeOptions({touchZoom:o.Browser.touch&&!o.Browser.android23,bounceAtZoomLimits:!0}),o.Map.TouchZoom=o.Handler.extend({addHooks:function(){o.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),o.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){o.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),o.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToContainerPoint(t.touches[0]),s=i.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=i.getSize()._divideBy(2),this._startLatLng=i.containerPointToLatLng(this._centerPoint),"center"!==i.options.touchZoom&&(this._pinchStartLatLng=i.containerPointToLatLng(n.add(s)._divideBy(2))),this._startDist=n.distanceTo(s),this._startZoom=i.getZoom(),this._moved=!1,this._zooming=!0,i._stop(),o.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),o.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),s=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(s,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&s<1||this._zoom>e.getMaxZoom()&&s>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var r=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0),this._moved=!0),o.Util.cancelAnimFrame(this._animRequest);var a=o.bind(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=o.Util.requestAnimFrame(a,this,!0),o.DomEvent.preventDefault(t)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,o.Util.cancelAnimFrame(this._animRequest),o.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd),void(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):void(this._zooming=!1)}}),o.Map.addInitHook("addHandler","touchZoom",o.Map.TouchZoom),o.Map.mergeOptions({tap:!0,tapTolerance:15}),o.Map.Tap=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(o.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new o.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(o.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),this._simulateEvent("mousedown",i),o.DomEvent.on(e,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),o.DomEvent.off(e,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.removeClass(n,"leaflet-active"),this._simulateEvent("mouseup",i),
this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new o.Point(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(i,n){var o=e.createEvent("MouseEvents");o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),o.Browser.touch&&!o.Browser.pointer&&o.Map.addInitHook("addHandler","tap",o.Map.Tap),o.Map.mergeOptions({boxZoom:!0}),o.Map.BoxZoom=o.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){o.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){o.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(t){return!(!t.shiftKey||1!==t.which&&1!==t.button)&&(this._resetState(),o.DomUtil.disableTextSelection(),o.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),void o.DomEvent.on(e,{contextmenu:o.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=o.DomUtil.create("div","leaflet-zoom-box",this._container),o.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new o.Bounds(this._point,this._startPoint),i=e.getSize();o.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(o.DomUtil.remove(this._box),o.DomUtil.removeClass(this._container,"leaflet-crosshair")),o.DomUtil.enableTextSelection(),o.DomUtil.enableImageDrag(),o.DomEvent.off(e,{contextmenu:o.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){setTimeout(o.bind(this._resetState,this),0);var e=new o.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),o.Map.addInitHook("addHandler","boxZoom",o.Map.BoxZoom),o.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),o.Map.Keyboard=o.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),o.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),o.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,o=i.scrollTop||n.scrollTop,s=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(s,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){o.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){o.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=o.point(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i)return;n.closePopup()}o.DomEvent.stop(t)}}}),o.Map.addInitHook("addHandler","keyboard",o.Map.Keyboard),o.Handler.MarkerDrag=o.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new o.Draggable(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),o.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&o.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,i=e._shadow,n=o.DomUtil.getPosition(e._icon),s=e._map.layerPointToLatLng(n);i&&o.DomUtil.setPosition(i,n),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),o.Control=o.Class.extend({options:{position:"topright"},initialize:function(t){o.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return o.DomUtil.addClass(e,"leaflet-control"),i.indexOf("bottom")!==-1?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return this._map?(o.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),o.control=function(t){return new o.Control(t)},o.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,s){var r=i+t+" "+i+s;e[t+s]=o.DomUtil.create("div",r,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=o.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){o.DomUtil.remove(this._controlContainer)}}),o.Control.Zoom=o.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=o.DomUtil.create("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,s){var r=o.DomUtil.create("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,r.setAttribute("role","button"),r.setAttribute("aria-label",e),o.DomEvent.on(r,"mousedown dblclick",o.DomEvent.stopPropagation).on(r,"click",o.DomEvent.stop).on(r,"click",s,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";o.DomUtil.removeClass(this._zoomInButton,e),o.DomUtil.removeClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&o.DomUtil.addClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&o.DomUtil.addClass(this._zoomInButton,e)}}),o.Map.mergeOptions({zoomControl:!0}),o.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new o.Control.Zoom,this.addControl(this.zoomControl))}),o.control.zoom=function(t){return new o.Control.Zoom(t)},o.Control.Attribution=o.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){o.setOptions(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=o.DomUtil.create("div","leaflet-control-attribution"),o.DomEvent&&o.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),o.Map.mergeOptions({attributionControl:!0}),o.Map.addInitHook(function(){this.options.attributionControl&&(new o.Control.Attribution).addTo(this)}),o.control.attribution=function(t){return new o.Control.Attribution(t)},o.Control.Scale=o.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=o.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=o.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=o.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),o.control.scale=function(t){return new o.Control.Scale(t)},o.Control.Layers=o.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){o.setOptions(this,i),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(o.stamp(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){o.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(o.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):o.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return o.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=o.DomUtil.create("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),o.DomEvent.disableClickPropagation(e),o.Browser.touch||o.DomEvent.disableScrollPropagation(e);var n=this._form=o.DomUtil.create("form",t+"-list");i&&(this._map.on("click",this.collapse,this),o.Browser.android||o.DomEvent.on(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var s=this._layersLink=o.DomUtil.create("a",t+"-toggle",e);s.href="#",s.title="Layers",o.Browser.touch?o.DomEvent.on(s,"click",o.DomEvent.stop).on(s,"click",this.expand,this):o.DomEvent.on(s,"focus",this.expand,this),o.DomEvent.on(n,"click",function(){setTimeout(o.bind(this._onInputClick,this),0)},this),i||this.expand(),this._baseLayersList=o.DomUtil.create("div",t+"-base",n),this._separator=o.DomUtil.create("div",t+"-separator",n),this._overlaysList=o.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&o.stamp(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(o.bind(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;o.DomUtil.empty(this._baseLayersList),o.DomUtil.empty(this._overlaysList);var t,e,i,n,s=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,s+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(o.stamp(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",o=e.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var i,n=e.createElement("label"),s=this._map.hasLayer(t.layer);t.overlay?(i=e.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=s):i=this._createRadioElement("leaflet-base-layers",s),i.layerId=o.stamp(t.layer),o.DomEvent.on(i,"click",this._onInputClick,this);var r=e.createElement("span");r.innerHTML=" "+t.name;var a=e.createElement("div");n.appendChild(a),a.appendChild(i),a.appendChild(r);var h=t.overlay?this._overlaysList:this._baseLayersList;return h.appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=[],s=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,i=this._map.hasLayer(e),t.checked&&!i?o.push(e):!t.checked&&i&&s.push(e);for(r=0;r<s.length;r++)this._map.removeLayer(s[r]);for(r=0;r<o.length;r++)this._map.addLayer(o[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._form.getElementsByTagName("input"),o=this._map.getZoom(),s=n.length-1;s>=0;s--)t=n[s],e=this._getLayer(t.layerId).layer,t.disabled=e.options.minZoom!==i&&o<e.options.minZoom||e.options.maxZoom!==i&&o>e.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),o.control.layers=function(t,e,i){return new o.Control.Layers(t,e,i)}}(window,document);
(function() {
    // save these original methods before they are overwritten
    var proto_initIcon = L.Marker.prototype._initIcon;
    var proto_setPos = L.Marker.prototype._setPos;
    var proto_onDrag = L.Handler.MarkerDrag.prototype._onDrag;

    var oldIE = (L.DomUtil.TRANSFORM === 'msTransform');

    L.Marker.addInitHook(function () {
        var iconOptions = this.options.icon && this.options.icon.options;
        var iconAnchor = iconOptions && this.options.icon.options.iconAnchor;
        if (iconAnchor) {
            iconAnchor = (iconAnchor[0] + 'px ' + iconAnchor[1] + 'px');
        }
        this.options.rotationOrigin = this.options.rotationOrigin || iconAnchor || 'center bottom' ;
        this.options.rotationAngle = this.options.rotationAngle || 0;
    });

    L.Marker.include({
        _initIcon: function() {
            proto_initIcon.call(this);
        },

        _setPos: function (pos) {
            proto_setPos.call(this, pos);
            this._applyRotation();
        },

        _applyRotation: function () {
            if(this.options.rotationAngle) {
                this._icon.style[L.DomUtil.TRANSFORM+'Origin'] = this.options.rotationOrigin;

                if(oldIE) {
                    // for IE 9, use the 2D rotation
                    this._icon.style[L.DomUtil.TRANSFORM] = 'rotate(' + this.options.rotationAngle + 'deg)';
                } else {
                    // for modern browsers, prefer the 3D accelerated version
                    this._icon.style[L.DomUtil.TRANSFORM] += ' rotateZ(' + this.options.rotationAngle + 'deg)';
                }
            }
        },

        setRotationAngle: function(angle) {
            this.options.rotationAngle = angle;
            this.update();
            return this;
        },

        setRotationOrigin: function(origin) {
            this.options.rotationOrigin = origin;
            this.update();
            return this;
        }
    });

    L.Handler.MarkerDrag.include({
        _onDrag: function (e) {
            proto_onDrag.call(this, e);
            this._marker._applyRotation();
        }
    })
})();

/*! Leaflet.Coordinates 03-07-2013 */
L.Control.Coordinates=L.Control.extend({options:{position:"bottomright",decimals:4,decimalSeperator:".",labelTemplateLat:"Lat: {y}",labelTemplateLng:"Lng: {x}",labelFormatterLat:void 0,labelFormatterLng:void 0,enableUserInput:!0,useDMS:!1,useLatLngOrder:!1},onAdd:function(a){this._map=a;var b="leaflet-control-coordinates",c=this._container=L.DomUtil.create("div",b),d=this.options;this._labelcontainer=L.DomUtil.create("div","uiElement label",c),this._label=L.DomUtil.create("span","labelFirst",this._labelcontainer),this._inputcontainer=L.DomUtil.create("div","uiElement input uiHidden",c);var e,f;return d.useLatLngOrder?(f=L.DomUtil.create("span","",this._inputcontainer),this._inputY=this._createInput("inputY",this._inputcontainer),e=L.DomUtil.create("span","",this._inputcontainer),this._inputX=this._createInput("inputX",this._inputcontainer)):(e=L.DomUtil.create("span","",this._inputcontainer),this._inputX=this._createInput("inputX",this._inputcontainer),f=L.DomUtil.create("span","",this._inputcontainer),this._inputY=this._createInput("inputY",this._inputcontainer)),e.innerHTML=d.labelTemplateLng.replace("{x}",""),f.innerHTML=d.labelTemplateLat.replace("{y}",""),L.DomEvent.on(this._inputX,"keyup",this._handleKeypress,this),L.DomEvent.on(this._inputY,"keyup",this._handleKeypress,this),a.on("mousemove",this._update,this),a.on("dragstart",this.collapse,this),a.whenReady(this._update,this),this._showsCoordinates=!0,d.enableUserInput&&L.DomEvent.addListener(this._container,"click",this._switchUI,this),c},_createInput:function(a,b){var c=L.DomUtil.create("input",a,b);return c.type="text",L.DomEvent.disableClickPropagation(c),c},_clearMarker:function(){this._map.removeLayer(this._marker)},_handleKeypress:function(a){switch(a.keyCode){case 27:this.collapse();break;case 13:this._handleSubmit(),this.collapse();break;default:this._handleSubmit()}},_handleSubmit:function(){var a=L.NumberFormatter.createValidNumber(this._inputX.value,this.options.decimalSeperator),b=L.NumberFormatter.createValidNumber(this._inputY.value,this.options.decimalSeperator);if(void 0!==a&&void 0!==b){var c=this._marker;c||(c=this._marker=L.marker(),c.on("click",this._clearMarker,this)),c.setLatLng(new L.LatLng(b,a)),c.addTo(this._map)}},expand:function(){this._showsCoordinates=!1,this._map.off("mousemove",this._update,this),L.DomEvent.addListener(this._container,"mousemove",L.DomEvent.stop),L.DomEvent.removeListener(this._container,"click",this._switchUI,this),L.DomUtil.addClass(this._labelcontainer,"uiHidden"),L.DomUtil.removeClass(this._inputcontainer,"uiHidden")},_createCoordinateLabel:function(a){var b,c,d=this.options;return b=d.labelFormatterLng?d.labelFormatterLng(a.lng):L.Util.template(d.labelTemplateLng,{x:this._getNumber(a.lng,d)}),c=d.labelFormatterLat?d.labelFormatterLat(a.lat):L.Util.template(d.labelTemplateLat,{y:this._getNumber(a.lat,d)}),d.useLatLngOrder?c+" "+b:b+" "+c},_getNumber:function(a,b){var c;return c=b.useDMS?L.NumberFormatter.toDMS(a):L.NumberFormatter.round(a,b.decimals,b.decimalSeperator)},collapse:function(){if(!this._showsCoordinates&&(this._map.on("mousemove",this._update,this),this._showsCoordinates=!0,this.options,L.DomEvent.addListener(this._container,"click",this._switchUI,this),L.DomEvent.removeListener(this._container,"mousemove",L.DomEvent.stop),L.DomUtil.addClass(this._inputcontainer,"uiHidden"),L.DomUtil.removeClass(this._labelcontainer,"uiHidden"),this._marker)){var a=L.marker(),b=this._marker.getLatLng();a.setLatLng(b);var c=L.DomUtil.create("div",""),d=L.DomUtil.create("div","",c);d.innerHTML=this._createCoordinateLabel(b);var e=L.DomUtil.create("a","",c);e.innerHTML="Remove",e.href="#";var f=L.DomEvent.stopPropagation;L.DomEvent.on(e,"click",f).on(e,"mousedown",f).on(e,"dblclick",f).on(e,"click",L.DomEvent.preventDefault).on(e,"click",function(){this._map.removeLayer(a)},this),a.bindPopup(c),a.addTo(this._map),this._map.removeLayer(this._marker),this._marker=null}},_switchUI:function(a){L.DomEvent.stop(a),L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a),this._showsCoordinates?this.expand():this.collapse()},onRemove:function(a){a.off("mousemove",this._update,this)},_update:function(a){var b=a.latlng,c=this.options;b&&(b=b.wrap(),this._currentPos=b,this._inputY.value=L.NumberFormatter.round(b.lat,c.decimals,c.decimalSeperator),this._inputX.value=L.NumberFormatter.round(b.lng,c.decimals,c.decimalSeperator),this._label.innerHTML=this._createCoordinateLabel(b))}}),L.control.coordinates=function(a){return new L.Control.Coordinates(a)},L.Map.mergeOptions({coordinateControl:!1}),L.Map.addInitHook(function(){this.options.coordinateControl&&(this.coordinateControl=new L.Control.Coordinates,this.addControl(this.coordinateControl))}),L.NumberFormatter={round:function(a,b,c){var d=L.Util.formatNum(a,b)+"",e=d.split(".");if(e[1]){for(var f=b-e[1].length;f>0;f--)e[1]+="0";d=e.join(c||".")}return d},toDMS:function(a){var b=Math.floor(a),c=60*(a-b),d=Math.floor(c),e=60*(c-d),f=Math.round(e);return 60==f&&(d++,f="00"),60==d&&(b++,d="00"),10>f&&(f="0"+f),10>d&&(d="0"+d),""+b+"&deg; "+d+"' "+f+"''"},createValidNumber:function(a,b){if(a&&a.length>0){var c=a.split(b||".");try{var d=Number(c.join("."));return isNaN(d)?void 0:d}catch(e){return void 0}}return void 0}};
/*
	Leaflet.contextmenu, a context menu for Leaflet.
	(c) 2015, Adam Ratcliffe, GeoSmart Maps Limited

	@preserve
*/
(function(t){var e;if(typeof define==="function"&&define.amd){define(["leaflet"],t)}else if(typeof module==="object"&&typeof module.exports==="object"){e=require("leaflet");module.exports=t(e)}else{if(typeof window.L==="undefined"){throw new Error("Leaflet must be loaded first")}t(window.L)}})(function(t){t.Map.mergeOptions({contextmenuItems:[]});t.Map.ContextMenu=t.Handler.extend({_touchstart:t.Browser.msPointer?"MSPointerDown":t.Browser.pointer?"pointerdown":"touchstart",statics:{BASE_CLS:"leaflet-contextmenu"},initialize:function(e){t.Handler.prototype.initialize.call(this,e);this._items=[];this._visible=false;var n=this._container=t.DomUtil.create("div",t.Map.ContextMenu.BASE_CLS,e._container);n.style.zIndex=1e4;n.style.position="absolute";if(e.options.contextmenuWidth){n.style.width=e.options.contextmenuWidth+"px"}this._createItems();t.DomEvent.on(n,"click",t.DomEvent.stop).on(n,"mousedown",t.DomEvent.stop).on(n,"dblclick",t.DomEvent.stop).on(n,"contextmenu",t.DomEvent.stop)},addHooks:function(){var e=this._map.getContainer();t.DomEvent.on(e,"mouseleave",this._hide,this).on(document,"keydown",this._onKeyDown,this);if(t.Browser.touch){t.DomEvent.on(document,this._touchstart,this._hide,this)}this._map.on({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},removeHooks:function(){var e=this._map.getContainer();t.DomEvent.off(e,"mouseleave",this._hide,this).off(document,"keydown",this._onKeyDown,this);if(t.Browser.touch){t.DomEvent.off(document,this._touchstart,this._hide,this)}this._map.off({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},showAt:function(e,n){if(e instanceof t.LatLng){e=this._map.latLngToContainerPoint(e)}this._showAtPoint(e,n)},hide:function(){this._hide()},addItem:function(t){return this.insertItem(t)},insertItem:function(t,e){e=e!==undefined?e:this._items.length;var n=this._createItem(this._container,t,e);this._items.push(n);this._sizeChanged=true;this._map.fire("contextmenu.additem",{contextmenu:this,el:n.el,index:e});return n.el},removeItem:function(e){var n=this._container;if(!isNaN(e)){e=n.children[e]}if(e){this._removeItem(t.Util.stamp(e));this._sizeChanged=true;this._map.fire("contextmenu.removeitem",{contextmenu:this,el:e});return e}return null},removeAllItems:function(){var e=this._container.children,n;while(e.length){n=e[0];this._removeItem(t.Util.stamp(n))}return e},hideAllItems:function(){var t,e,n;for(e=0,n=this._items.length;e<n;e++){t=this._items[e];t.el.style.display="none"}},showAllItems:function(){var t,e,n;for(e=0,n=this._items.length;e<n;e++){t=this._items[e];t.el.style.display=""}},setDisabled:function(e,n){var i=this._container,o=t.Map.ContextMenu.BASE_CLS+"-item";if(!isNaN(e)){e=i.children[e]}if(e&&t.DomUtil.hasClass(e,o)){if(n){t.DomUtil.addClass(e,o+"-disabled");this._map.fire("contextmenu.disableitem",{contextmenu:this,el:e})}else{t.DomUtil.removeClass(e,o+"-disabled");this._map.fire("contextmenu.enableitem",{contextmenu:this,el:e})}}},isVisible:function(){return this._visible},_createItems:function(){var t=this._map.options.contextmenuItems,e,n,i;for(n=0,i=t.length;n<i;n++){this._items.push(this._createItem(this._container,t[n]))}},_createItem:function(e,n,i){if(n.separator||n==="-"){return this._createSeparator(e,i)}var o=t.Map.ContextMenu.BASE_CLS+"-item",s=n.disabled?o+" "+o+"-disabled":o,h=this._insertElementAt("a",s,e,i),r=this._createEventHandler(h,n.callback,n.context,n.hideOnSelect),a=this._getIcon(n),m=this._getIconCls(n),u="";if(a){u='<img class="'+t.Map.ContextMenu.BASE_CLS+'-icon" src="'+a+'"/>'}else if(m){u='<span class="'+t.Map.ContextMenu.BASE_CLS+"-icon "+m+'"></span>'}h.innerHTML=u+n.text;h.href="#";t.DomEvent.on(h,"mouseover",this._onItemMouseOver,this).on(h,"mouseout",this._onItemMouseOut,this).on(h,"mousedown",t.DomEvent.stopPropagation).on(h,"click",r);if(t.Browser.touch){t.DomEvent.on(h,this._touchstart,t.DomEvent.stopPropagation)}if(!t.Browser.pointer){t.DomEvent.on(h,"click",this._onItemMouseOut,this)}return{id:t.Util.stamp(h),el:h,callback:r}},_removeItem:function(e){var n,i,o,s,h;for(o=0,s=this._items.length;o<s;o++){n=this._items[o];if(n.id===e){i=n.el;h=n.callback;if(h){t.DomEvent.off(i,"mouseover",this._onItemMouseOver,this).off(i,"mouseover",this._onItemMouseOut,this).off(i,"mousedown",t.DomEvent.stopPropagation).off(i,"click",h);if(t.Browser.touch){t.DomEvent.off(i,this._touchstart,t.DomEvent.stopPropagation)}if(!t.Browser.pointer){t.DomEvent.on(i,"click",this._onItemMouseOut,this)}}this._container.removeChild(i);this._items.splice(o,1);return n}}return null},_createSeparator:function(e,n){var i=this._insertElementAt("div",t.Map.ContextMenu.BASE_CLS+"-separator",e,n);return{id:t.Util.stamp(i),el:i}},_createEventHandler:function(e,n,i,o){var s=this,h=this._map,r=t.Map.ContextMenu.BASE_CLS+"-item-disabled",o=o!==undefined?o:true;return function(a){if(t.DomUtil.hasClass(e,r)){return}if(o){s._hide()}if(n){n.call(i||h,s._showLocation)}s._map.fire("contextmenu.select",{contextmenu:s,el:e})}},_insertElementAt:function(t,e,n,i){var o,s=document.createElement(t);s.className=e;if(i!==undefined){o=n.children[i]}if(o){n.insertBefore(s,o)}else{n.appendChild(s)}return s},_show:function(t){this._showAtPoint(t.containerPoint,t)},_showAtPoint:function(e,n){if(this._items.length){var i=this._map,o=i.containerPointToLayerPoint(e),s=i.layerPointToLatLng(o),h=t.extend(n||{},{contextmenu:this});this._showLocation={latlng:s,layerPoint:o,containerPoint:e};if(n&&n.relatedTarget){this._showLocation.relatedTarget=n.relatedTarget}this._setPosition(e);if(!this._visible){this._container.style.display="block";this._visible=true}this._map.fire("contextmenu.show",h)}},_hide:function(){if(this._visible){this._visible=false;this._container.style.display="none";this._map.fire("contextmenu.hide",{contextmenu:this})}},_getIcon:function(e){return t.Browser.retina&&e.retinaIcon||e.icon},_getIconCls:function(e){return t.Browser.retina&&e.retinaIconCls||e.iconCls},_setPosition:function(e){var n=this._map.getSize(),i=this._container,o=this._getElementSize(i),s;if(this._map.options.contextmenuAnchor){s=t.point(this._map.options.contextmenuAnchor);e=e.add(s)}i._leaflet_pos=e;if(e.x+o.x>n.x){i.style.left="auto";i.style.right=Math.min(Math.max(n.x-e.x,0),n.x-o.x-1)+"px"}else{i.style.left=Math.max(e.x,0)+"px";i.style.right="auto"}if(e.y+o.y>n.y){i.style.top="auto";i.style.bottom=Math.min(Math.max(n.y-e.y,0),n.y-o.y-1)+"px"}else{i.style.top=Math.max(e.y,0)+"px";i.style.bottom="auto"}},_getElementSize:function(t){var e=this._size,n=t.style.display;if(!e||this._sizeChanged){e={};t.style.left="-999999px";t.style.right="auto";t.style.display="block";e.x=t.offsetWidth;e.y=t.offsetHeight;t.style.left="auto";t.style.display=n;this._sizeChanged=false}return e},_onKeyDown:function(t){var e=t.keyCode;if(e===27){this._hide()}},_onItemMouseOver:function(e){t.DomUtil.addClass(e.target||e.srcElement,"over")},_onItemMouseOut:function(e){t.DomUtil.removeClass(e.target||e.srcElement,"over")}});t.Map.addInitHook("addHandler","contextmenu",t.Map.ContextMenu);t.Mixin.ContextMenu={bindContextMenu:function(e){t.setOptions(this,e);this._initContextMenu();return this},unbindContextMenu:function(){this.off("contextmenu",this._showContextMenu,this);return this},addContextMenuItem:function(t){this.options.contextmenuItems.push(t)},removeContextMenuItemWithIndex:function(t){var e=[];for(var n=0;n<this.options.contextmenuItems.length;n++){if(this.options.contextmenuItems[n].index==t){e.push(n)}}var i=e.pop();while(i!==undefined){this.options.contextmenuItems.splice(i,1);i=e.pop()}},replaceContextMenuItem:function(t){this.removeContextMenuItemWithIndex(t.index);this.addContextMenuItem(t)},_initContextMenu:function(){this._items=[];this.on("contextmenu",this._showContextMenu,this)},_showContextMenu:function(e){var n,i,o,s,h;if(this._map.contextmenu){i=t.extend({relatedTarget:this},e);o=this._map.mouseEventToContainerPoint(e.originalEvent);if(!this.options.contextmenuInheritItems){this._map.contextmenu.hideAllItems()}for(s=0,h=this.options.contextmenuItems.length;s<h;s++){n=this.options.contextmenuItems[s];this._items.push(this._map.contextmenu.insertItem(n,n.index))}this._map.once("contextmenu.hide",this._hideContextMenu,this);this._map.contextmenu.showAt(o,i)}},_hideContextMenu:function(){var t,e;for(t=0,e=this._items.length;t<e;t++){this._map.contextmenu.removeItem(this._items[t])}this._items.length=0;if(!this.options.contextmenuInheritItems){this._map.contextmenu.showAllItems()}}};var e=[t.Marker,t.Path],n={contextmenu:false,contextmenuItems:[],contextmenuInheritItems:true},i,o,s;for(o=0,s=e.length;o<s;o++){i=e[o];if(!i.prototype.options){i.prototype.options=n}else{i.mergeOptions(n)}i.addInitHook(function(){if(this.options.contextmenu){this._initContextMenu()}});i.include(t.Mixin.ContextMenu)}return t.Map.ContextMenu});
$$.module.registerModule('brainjs.map.icon.ais', function() {

	return function(data) {

		var color = data.color || 'green'

		var template =  `
			<svg width="40" height="40" style="border: 1px solid back;">
				<g transform="translate(20, 20)" stroke="${color}" fill="${color}">
					<circle r="3"></circle>
					<rect x="-7" y="-7" width="15" height="15" fill=${color} fill-opacity="0.3"></rect>
					<line y2="-30"></line>
				</g>
			</svg>
		`

		return L.divIcon({
			className: 'aisMarker',
			iconSize: [40, 40],
			iconAnchor: [20, 20],
			html: template
		})		
	}
});

$$.module.registerModule('brainjs.map.shape.circle', function() {

	return {
		
		create: function(data) {
			return L.circle(data.latlng, data.radius, data.style)
		},
		update: function(layer, data) {
		
			if (data.latlng) {
				layer.setLatLng(data.latlng)
			}	
			
			if (data.radius) {
				layer.setRadius(data.radius)
			}
			if (data.style) {
				layer.setStyle(data.style)
			}
			
		},
		getData: function(layer, data) {
			data.radius = layer.getRadius()
			data.latlng = layer.getLatLng()	
		}		

	}
});


(function() {



function getIconMarker(data) {
	if (typeof data.type != 'string') {
		console.error('[brainjs.map] getIconMarker, missing type field')
		return
	}
	const func = $$.module.getModule('brainjs.map.icon.' + data.type)

	if (typeof func == 'function') {
		return func(data)
	}
}

$$.module.registerModule('brainjs.map.shape.marker', function() {

	return {
		
		create: function(data) {

			const options = data.options || {}
			if (data.icon) {
				options.icon = getIconMarker(data.icon)
			}
			if (data.rotationAngle) {
				options.rotationAngle = data.rotationAngle
			}

			const marker = L.marker(data.latlng, options)							
			
			if (data.popupContent) {
				let popup = L.popup({autoClose: false, closeButton: true, autoPan: false})
				popup.setContent(data.popupContent)
				marker.bindPopup(popup)
			}
																
			return marker
		},

		update: function(layer, data) {
		

			if (data.latlng) {
				layer.setLatLng(data.latlng)
			}
			if (data.icon) {
				layer.setIcon(getIconMarker(data.icon))
			}
			if (data.rotationAngle) {
				layer.setRotationAngle(data.rotationAngle)
			}	

			if (data.popupContent) {
				layer.setPopupContent(data.popupContent)
			}	

		},
		getData: function(layer, data) {
			data.latlng = layer.getLatLng()
		}
	}
})

})();
$$.module.registerModule('brainjs.map.shape.polygon', function() {

	return {
		
		create: function(data) {
			return L.polygon(data.latlngs, data.style)
		},
		update: function(layer, data) {
		
			if (data.latlngs) {
				layer.setLatLngs(data.latlngs)
			}
			if (data.style) {
				layer.setStyle(data.style)
			}
			
		},
		getData: function(layer, data) {
			data.latlngs = layer.getLatLngs()[0]
		}		

	}
});


$$.module.registerModule('brainjs.map.shape.polyline', function() {

	return {
		
		create: function(data) {
			return L.polyline(data.latlngs, data.style)
		},
		update: function(layer, data) {
		
			if (data.latlngs) {
				layer.setLatLngs(data.latlngs)
			}
			if (data.style) {
				layer.setStyle(data.style)
			}
			
		},
		getData: function(layer, data) {
			data.latlngs = layer.getLatLngs()
		}	
	}
});


$$.module.registerModule('brainjs.map.shape.rectangle', function() {

	return {
		
		create: function(data) {
		
			const bounds = L.latLngBounds(data.northWest, data.southEast)
			return L.rectangle(bounds, data.style)
		},

		update: function(layer, data) {
			
			if (data.northWest && data.southEast) {
				const bounds = L.latLngBounds(data.northWest, data.southEast)
				layer.setBounds(bounds)
			}
			if (data.style) {
				layer.setStyle(data.style)
			}
		},
		getData: function(layer, data) {
			const bounds = layer.getBounds()
			data.northWest =  bounds.getNorthWest()
			data.southEast =  bounds.getSouthEast()
		}
	}
});


$(function() {
	console.log('[brainjs.map] Leaflet version', L.version)
	$$.util.loadStyle('map/brainjs-map.css')
})



$$.control.registerControl('brainjs.map', {
	props: {
		tileUrl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
		center: {lat: 51.505, lng: -0.09}, // london city
		zoom: 13,
		layers: {},
		scale: false,
		coordinates: false,
		plugins: {},
		contextMenu: {},
		shapes: {}
	},
	init: function(elt) {

		const div = $('<div>').css('height', '100%').appendTo(elt).get(0)

		const {center, zoom, tileUrl, contextMenu} = this.props

		const mapOptions = {
			center, 
			zoom,
			closePopupOnClick: false,
			contextmenu: true,
			contextmenuWidth: 140
		}

		mapOptions.contextmenuItems = Object.keys(contextMenu).map(function(cmd) {
			const text = contextMenu[cmd].name
			if (text === '--') {
				return {separator: true}
			}
			return {
				text,
				callback: function(ev) {
					elt.trigger('mapcontextmenu', {cmd,  latlng: ev.latlng})
				}
			}
			
		})

		const map = L.map(div, mapOptions)
		const shapes = {}
		const layers = {}

		const confLayer = {}

		for(let layerName in this.props.layers) {
			const {label, visible} = this.props.layers[layerName]
			const layer = new L.FeatureGroup()
			layers[layerName] = layer
			if (typeof label == 'string') {
				confLayer[label] = layer
			}
			
			if (visible === true) {
				map.addLayer(layer)
			}
		}

		if (Object.keys(confLayer).length != 0) {
			L.control.layers({}, confLayer).addTo(map)
		}	

		if (this.props.scale) {			
			L.control.scale({imperial: false, position: 'bottomright'}).addTo(map)
		}

		if (this.props.coordinates) {
			L.control.coordinates({
				position: 'bottomleft',
				useLatLngOrder: true,
				enableUserInput: false,
				decimals: 5					
			}).addTo(map)
		}

		const data = {elt, map, layers, shapes}

		for(let pluginName in this.props.plugins) {
			const func = $$.module.getModule('brainjs.map.plugin.' + pluginName)
			const config = this.props.plugins[pluginName]
			if (typeof func == 'function') {
				console.log(`[brainjs.map] instance plugin '${pluginName}' with config`, config)
				func(data, config)
			}
		}

		L.tileLayer(tileUrl, {
			attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
		}).addTo(map)

		setTimeout(function(){
			map.invalidateSize()
		}, 100)

		map.on('click', function(ev) {
			//console.log('[map] onclick', ev)
			elt.trigger('mapclick', {latlng: ev.latlng})
		})

		this.getShapes = function() {
			return Object.keys(shapes)
		}

		this.updateShape = function(id, options) {
			const shape = shapes[id]
			if (shape) {
				const shapeDesc = $$.module.getModule('brainjs.map.shape.' + shape.type)
				if (shapeDesc && typeof shapeDesc.update == 'function') {

					console.log('[brainjs.map] updateShape with id', id)
					shapeDesc.update(shape, options)
					$.extend(shape.info, options)
				}										
			}
			else {
				throw `[brainjs.map] updateShape id '${id}' doesn't exist`
			}
		}

		this.addShape = function(id, options) {
			if (shapes[id]) {
				throw `[brainjs.map] addShape id '${id}' already exist`
			}
			options = options || {}

			if (typeof options.type != 'string') {
				console.error('[brainjs.map] addShape, missing type field')
				return
			}

			const shapeDesc = $$.module.getModule('brainjs.map.shape.' + options.type)

			let layer = map
			if (typeof options.layer == 'string') {
				layer = layers[options.layer]
				if (layer == undefined) {
					throw `layer '${options.layer}' doesn't exist`
				}
			}

			if (shapeDesc && typeof shapeDesc.create == 'function') {

				console.log('[brainjs.map] addShape with id', id)
				shape = shapeDesc.create(options)
				shape.type = options.type
				shape.ownlayer = layer
				shape.info = options
				shape.id = id
				shapes[id] = shape
				shape.on('contextmenu', function(ev) {
					const data = {id, latlng: ev.latlng}
					if (typeof ev.target.getLatLng == 'function') {
						data.pos = map.latLngToContainerPoint(ev.target.getLatLng())
					}
					elt.trigger('mapshapecontextmenu', data)
				})
				shape.addTo(layer)
			}					
		}

		this.removeShape = function(id) {
	
			const shape = shapes[id]
			if (shape) {
				console.log('[brainjs.map] removeShape with id', id)
				shape.removeFrom(shape.ownlayer)
				delete shapes[id]
			}
			else {
				console.warn(`[brainjs.map] removeShape id '${id}' doesn't exist`)
			}
		}


		this.getShapeInfo = function(id) {
	
			const shape = shapes[id]
			if (shape) {
				return shape.info
			}
			else {
				console.warn(`[brainjs.map] removeShape id '${id}' doesn't exist`)
			}
		}	

		this.enableHandlers =function (enabled) {
			map._handlers.forEach(function(handler) {
				if (enabled)
					handler.enable()
				else
					handler.disable()
			})			
		}

		for(let shapeId in this.props.shapes) {
			this.addShape(shapeId, this.props.shapes[shapeId])
		}

	}
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxlYWZsZXQuanMiLCJsZWFmbGV0LnJvdGF0ZWRNYXJrZXIuanMiLCJMZWFmbGV0LkNvb3JkaW5hdGVzLm1pbi5qcyIsImxlYWZsZXQuY29udGV4dG1lbnUubWluLmpzIiwiYWlzLmpzIiwiY2lyY2xlLmpzIiwibWFya2VyLmpzIiwicG9seWdvbi5qcyIsInBvbHlsaW5lLmpzIiwicmVjdGFuZ2xlLmpzIiwibWFwLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzlEQTtBQUNBO0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYnJhaW5qcy1tYXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuIExlYWZsZXQgMS4wLjMrZWQzNmEwNCwgYSBKUyBsaWJyYXJ5IGZvciBpbnRlcmFjdGl2ZSBtYXBzLiBodHRwOi8vbGVhZmxldGpzLmNvbVxuIChjKSAyMDEwLTIwMTYgVmxhZGltaXIgQWdhZm9ua2luLCAoYykgMjAxMC0yMDExIENsb3VkTWFkZVxuKi9cbiFmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbigpe3ZhciBlPXQuTDtvLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdC5MPWUsdGhpc30sdC5MPW99dmFyIG89e3ZlcnNpb246XCIxLjAuMytlZDM2YTA0XCJ9O1wib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1vOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKG8pLFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0JiZuKCksby5VdGlsPXtleHRlbmQ6ZnVuY3Rpb24odCl7dmFyIGUsaSxuLG87Zm9yKGk9MSxuPWFyZ3VtZW50cy5sZW5ndGg7aTxuO2krKyl7bz1hcmd1bWVudHNbaV07Zm9yKGUgaW4gbyl0W2VdPW9bZV19cmV0dXJuIHR9LGNyZWF0ZTpPYmplY3QuY3JlYXRlfHxmdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb3RvdHlwZT1lLG5ldyB0fX0oKSxiaW5kOmZ1bmN0aW9uKHQsZSl7dmFyIGk9QXJyYXkucHJvdG90eXBlLnNsaWNlO2lmKHQuYmluZClyZXR1cm4gdC5iaW5kLmFwcGx5KHQsaS5jYWxsKGFyZ3VtZW50cywxKSk7dmFyIG49aS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseShlLG4ubGVuZ3RoP24uY29uY2F0KGkuY2FsbChhcmd1bWVudHMpKTphcmd1bWVudHMpfX0sc3RhbXA6ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2xlYWZsZXRfaWQ9dC5fbGVhZmxldF9pZHx8KytvLlV0aWwubGFzdElkLHQuX2xlYWZsZXRfaWR9LGxhc3RJZDowLHRocm90dGxlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbixvLHMscjtyZXR1cm4gcj1mdW5jdGlvbigpe249ITEsbyYmKHMuYXBwbHkoaSxvKSxvPSExKX0scz1mdW5jdGlvbigpe24/bz1hcmd1bWVudHM6KHQuYXBwbHkoaSxhcmd1bWVudHMpLHNldFRpbWVvdXQocixlKSxuPSEwKX19LHdyYXBOdW06ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWVbMV0sbz1lWzBdLHM9bi1vO3JldHVybiB0PT09biYmaT90OigodC1vKSVzK3MpJXMrb30sZmFsc2VGbjpmdW5jdGlvbigpe3JldHVybiExfSxmb3JtYXROdW06ZnVuY3Rpb24odCxlKXt2YXIgaT1NYXRoLnBvdygxMCxlfHw1KTtyZXR1cm4gTWF0aC5yb3VuZCh0KmkpL2l9LHRyaW06ZnVuY3Rpb24odCl7cmV0dXJuIHQudHJpbT90LnRyaW0oKTp0LnJlcGxhY2UoL15cXHMrfFxccyskL2csXCJcIil9LHNwbGl0V29yZHM6ZnVuY3Rpb24odCl7cmV0dXJuIG8uVXRpbC50cmltKHQpLnNwbGl0KC9cXHMrLyl9LHNldE9wdGlvbnM6ZnVuY3Rpb24odCxlKXt0Lmhhc093blByb3BlcnR5KFwib3B0aW9uc1wiKXx8KHQub3B0aW9ucz10Lm9wdGlvbnM/by5VdGlsLmNyZWF0ZSh0Lm9wdGlvbnMpOnt9KTtmb3IodmFyIGkgaW4gZSl0Lm9wdGlvbnNbaV09ZVtpXTtyZXR1cm4gdC5vcHRpb25zfSxnZXRQYXJhbVN0cmluZzpmdW5jdGlvbih0LGUsaSl7dmFyIG49W107Zm9yKHZhciBvIGluIHQpbi5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChpP28udG9VcHBlckNhc2UoKTpvKStcIj1cIitlbmNvZGVVUklDb21wb25lbnQodFtvXSkpO3JldHVybihlJiZlLmluZGV4T2YoXCI/XCIpIT09LTE/XCImXCI6XCI/XCIpK24uam9pbihcIiZcIil9LHRlbXBsYXRlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQucmVwbGFjZShvLlV0aWwudGVtcGxhdGVSZSxmdW5jdGlvbih0LG4pe3ZhciBvPWVbbl07aWYobz09PWkpdGhyb3cgbmV3IEVycm9yKFwiTm8gdmFsdWUgcHJvdmlkZWQgZm9yIHZhcmlhYmxlIFwiK3QpO3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIG8mJihvPW8oZSkpLG99KX0sdGVtcGxhdGVSZTovXFx7ICooW1xcd19cXC1dKykgKlxcfS9nLGlzQXJyYXk6QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24odCl7cmV0dXJuXCJbb2JqZWN0IEFycmF5XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpbmRleE9mOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKyspaWYodFtpXT09PWUpcmV0dXJuIGk7cmV0dXJuLTF9LGVtcHR5SW1hZ2VVcmw6XCJkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUFEL0FDd0FBQUFBQVFBQkFBQUNBRHM9XCJ9LGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtyZXR1cm4gdFtcIndlYmtpdFwiK2VdfHx0W1wibW96XCIrZV18fHRbXCJtc1wiK2VdfWZ1bmN0aW9uIGkoZSl7dmFyIGk9K25ldyBEYXRlLG89TWF0aC5tYXgoMCwxNi0oaS1uKSk7cmV0dXJuIG49aStvLHQuc2V0VGltZW91dChlLG8pfXZhciBuPTAscz10LnJlcXVlc3RBbmltYXRpb25GcmFtZXx8ZShcIlJlcXVlc3RBbmltYXRpb25GcmFtZVwiKXx8aSxyPXQuY2FuY2VsQW5pbWF0aW9uRnJhbWV8fGUoXCJDYW5jZWxBbmltYXRpb25GcmFtZVwiKXx8ZShcIkNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZVwiKXx8ZnVuY3Rpb24oZSl7dC5jbGVhclRpbWVvdXQoZSl9O28uVXRpbC5yZXF1ZXN0QW5pbUZyYW1lPWZ1bmN0aW9uKGUsbixyKXtyZXR1cm4gciYmcz09PWk/dm9pZCBlLmNhbGwobik6cy5jYWxsKHQsby5iaW5kKGUsbikpfSxvLlV0aWwuY2FuY2VsQW5pbUZyYW1lPWZ1bmN0aW9uKGUpe2UmJnIuY2FsbCh0LGUpfX0oKSxvLmV4dGVuZD1vLlV0aWwuZXh0ZW5kLG8uYmluZD1vLlV0aWwuYmluZCxvLnN0YW1wPW8uVXRpbC5zdGFtcCxvLnNldE9wdGlvbnM9by5VdGlsLnNldE9wdGlvbnMsby5DbGFzcz1mdW5jdGlvbigpe30sby5DbGFzcy5leHRlbmQ9ZnVuY3Rpb24odCl7dmFyIGU9ZnVuY3Rpb24oKXt0aGlzLmluaXRpYWxpemUmJnRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5jYWxsSW5pdEhvb2tzKCl9LGk9ZS5fX3N1cGVyX189dGhpcy5wcm90b3R5cGUsbj1vLlV0aWwuY3JlYXRlKGkpO24uY29uc3RydWN0b3I9ZSxlLnByb3RvdHlwZT1uO2Zvcih2YXIgcyBpbiB0aGlzKXRoaXMuaGFzT3duUHJvcGVydHkocykmJlwicHJvdG90eXBlXCIhPT1zJiYoZVtzXT10aGlzW3NdKTtyZXR1cm4gdC5zdGF0aWNzJiYoby5leHRlbmQoZSx0LnN0YXRpY3MpLGRlbGV0ZSB0LnN0YXRpY3MpLHQuaW5jbHVkZXMmJihvLlV0aWwuZXh0ZW5kLmFwcGx5KG51bGwsW25dLmNvbmNhdCh0LmluY2x1ZGVzKSksZGVsZXRlIHQuaW5jbHVkZXMpLG4ub3B0aW9ucyYmKHQub3B0aW9ucz1vLlV0aWwuZXh0ZW5kKG8uVXRpbC5jcmVhdGUobi5vcHRpb25zKSx0Lm9wdGlvbnMpKSxvLmV4dGVuZChuLHQpLG4uX2luaXRIb29rcz1bXSxuLmNhbGxJbml0SG9va3M9ZnVuY3Rpb24oKXtpZighdGhpcy5faW5pdEhvb2tzQ2FsbGVkKXtpLmNhbGxJbml0SG9va3MmJmkuY2FsbEluaXRIb29rcy5jYWxsKHRoaXMpLHRoaXMuX2luaXRIb29rc0NhbGxlZD0hMDtmb3IodmFyIHQ9MCxlPW4uX2luaXRIb29rcy5sZW5ndGg7dDxlO3QrKyluLl9pbml0SG9va3NbdF0uY2FsbCh0aGlzKX19LGV9LG8uQ2xhc3MuaW5jbHVkZT1mdW5jdGlvbih0KXtyZXR1cm4gby5leHRlbmQodGhpcy5wcm90b3R5cGUsdCksdGhpc30sby5DbGFzcy5tZXJnZU9wdGlvbnM9ZnVuY3Rpb24odCl7cmV0dXJuIG8uZXh0ZW5kKHRoaXMucHJvdG90eXBlLm9wdGlvbnMsdCksdGhpc30sby5DbGFzcy5hZGRJbml0SG9vaz1mdW5jdGlvbih0KXt2YXIgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksaT1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0P3Q6ZnVuY3Rpb24oKXt0aGlzW3RdLmFwcGx5KHRoaXMsZSl9O3JldHVybiB0aGlzLnByb3RvdHlwZS5faW5pdEhvb2tzPXRoaXMucHJvdG90eXBlLl9pbml0SG9va3N8fFtdLHRoaXMucHJvdG90eXBlLl9pbml0SG9va3MucHVzaChpKSx0aGlzfSxvLkV2ZW50ZWQ9by5DbGFzcy5leHRlbmQoe29uOmZ1bmN0aW9uKHQsZSxpKXtpZihcIm9iamVjdFwiPT10eXBlb2YgdClmb3IodmFyIG4gaW4gdCl0aGlzLl9vbihuLHRbbl0sZSk7ZWxzZXt0PW8uVXRpbC5zcGxpdFdvcmRzKHQpO2Zvcih2YXIgcz0wLHI9dC5sZW5ndGg7czxyO3MrKyl0aGlzLl9vbih0W3NdLGUsaSl9cmV0dXJuIHRoaXN9LG9mZjpmdW5jdGlvbih0LGUsaSl7aWYodClpZihcIm9iamVjdFwiPT10eXBlb2YgdClmb3IodmFyIG4gaW4gdCl0aGlzLl9vZmYobix0W25dLGUpO2Vsc2V7dD1vLlV0aWwuc3BsaXRXb3Jkcyh0KTtmb3IodmFyIHM9MCxyPXQubGVuZ3RoO3M8cjtzKyspdGhpcy5fb2ZmKHRbc10sZSxpKX1lbHNlIGRlbGV0ZSB0aGlzLl9ldmVudHM7cmV0dXJuIHRoaXN9LF9vbjpmdW5jdGlvbih0LGUsbil7dGhpcy5fZXZlbnRzPXRoaXMuX2V2ZW50c3x8e307dmFyIG89dGhpcy5fZXZlbnRzW3RdO298fChvPVtdLHRoaXMuX2V2ZW50c1t0XT1vKSxuPT09dGhpcyYmKG49aSk7Zm9yKHZhciBzPXtmbjplLGN0eDpufSxyPW8sYT0wLGg9ci5sZW5ndGg7YTxoO2ErKylpZihyW2FdLmZuPT09ZSYmclthXS5jdHg9PT1uKXJldHVybjtyLnB1c2gocyl9LF9vZmY6ZnVuY3Rpb24odCxlLG4pe3ZhciBzLHIsYTtpZih0aGlzLl9ldmVudHMmJihzPXRoaXMuX2V2ZW50c1t0XSkpe2lmKCFlKXtmb3Iocj0wLGE9cy5sZW5ndGg7cjxhO3IrKylzW3JdLmZuPW8uVXRpbC5mYWxzZUZuO3JldHVybiB2b2lkIGRlbGV0ZSB0aGlzLl9ldmVudHNbdF19aWYobj09PXRoaXMmJihuPWkpLHMpZm9yKHI9MCxhPXMubGVuZ3RoO3I8YTtyKyspe3ZhciBoPXNbcl07aWYoaC5jdHg9PT1uJiZoLmZuPT09ZSlyZXR1cm4gaC5mbj1vLlV0aWwuZmFsc2VGbix0aGlzLl9maXJpbmdDb3VudCYmKHRoaXMuX2V2ZW50c1t0XT1zPXMuc2xpY2UoKSksdm9pZCBzLnNwbGljZShyLDEpfX19LGZpcmU6ZnVuY3Rpb24odCxlLGkpe2lmKCF0aGlzLmxpc3RlbnModCxpKSlyZXR1cm4gdGhpczt2YXIgbj1vLlV0aWwuZXh0ZW5kKHt9LGUse3R5cGU6dCx0YXJnZXQ6dGhpc30pO2lmKHRoaXMuX2V2ZW50cyl7dmFyIHM9dGhpcy5fZXZlbnRzW3RdO2lmKHMpe3RoaXMuX2ZpcmluZ0NvdW50PXRoaXMuX2ZpcmluZ0NvdW50KzF8fDE7Zm9yKHZhciByPTAsYT1zLmxlbmd0aDtyPGE7cisrKXt2YXIgaD1zW3JdO2guZm4uY2FsbChoLmN0eHx8dGhpcyxuKX10aGlzLl9maXJpbmdDb3VudC0tfX1yZXR1cm4gaSYmdGhpcy5fcHJvcGFnYXRlRXZlbnQobiksdGhpc30sbGlzdGVuczpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2V2ZW50cyYmdGhpcy5fZXZlbnRzW3RdO2lmKGkmJmkubGVuZ3RoKXJldHVybiEwO2lmKGUpZm9yKHZhciBuIGluIHRoaXMuX2V2ZW50UGFyZW50cylpZih0aGlzLl9ldmVudFBhcmVudHNbbl0ubGlzdGVucyh0LGUpKXJldHVybiEwO3JldHVybiExfSxvbmNlOmZ1bmN0aW9uKHQsZSxpKXtpZihcIm9iamVjdFwiPT10eXBlb2YgdCl7Zm9yKHZhciBuIGluIHQpdGhpcy5vbmNlKG4sdFtuXSxlKTtyZXR1cm4gdGhpc312YXIgcz1vLmJpbmQoZnVuY3Rpb24oKXt0aGlzLm9mZih0LGUsaSkub2ZmKHQscyxpKX0sdGhpcyk7cmV0dXJuIHRoaXMub24odCxlLGkpLm9uKHQscyxpKX0sYWRkRXZlbnRQYXJlbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2V2ZW50UGFyZW50cz10aGlzLl9ldmVudFBhcmVudHN8fHt9LHRoaXMuX2V2ZW50UGFyZW50c1tvLnN0YW1wKHQpXT10LHRoaXN9LHJlbW92ZUV2ZW50UGFyZW50OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9ldmVudFBhcmVudHMmJmRlbGV0ZSB0aGlzLl9ldmVudFBhcmVudHNbby5zdGFtcCh0KV0sdGhpc30sX3Byb3BhZ2F0ZUV2ZW50OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0aGlzLl9ldmVudFBhcmVudHMpdGhpcy5fZXZlbnRQYXJlbnRzW2VdLmZpcmUodC50eXBlLG8uZXh0ZW5kKHtsYXllcjp0LnRhcmdldH0sdCksITApfX0pO3ZhciBzPW8uRXZlbnRlZC5wcm90b3R5cGU7cy5hZGRFdmVudExpc3RlbmVyPXMub24scy5yZW1vdmVFdmVudExpc3RlbmVyPXMuY2xlYXJBbGxFdmVudExpc3RlbmVycz1zLm9mZixzLmFkZE9uZVRpbWVFdmVudExpc3RlbmVyPXMub25jZSxzLmZpcmVFdmVudD1zLmZpcmUscy5oYXNFdmVudExpc3RlbmVycz1zLmxpc3RlbnMsby5NaXhpbj17RXZlbnRzOnN9LGZ1bmN0aW9uKCl7dmFyIGk9bmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLG49ZS5kb2N1bWVudEVsZW1lbnQscz1cIkFjdGl2ZVhPYmplY3RcImluIHQscj1pLmluZGV4T2YoXCJ3ZWJraXRcIikhPT0tMSxhPWkuaW5kZXhPZihcInBoYW50b21cIikhPT0tMSxoPWkuc2VhcmNoKFwiYW5kcm9pZCBbMjNdXCIpIT09LTEsbD1pLmluZGV4T2YoXCJjaHJvbWVcIikhPT0tMSx1PWkuaW5kZXhPZihcImdlY2tvXCIpIT09LTEmJiFyJiYhdC5vcGVyYSYmIXMsYz0wPT09bmF2aWdhdG9yLnBsYXRmb3JtLmluZGV4T2YoXCJXaW5cIiksZD1cInVuZGVmaW5lZFwiIT10eXBlb2Ygb3JpZW50YXRpb258fGkuaW5kZXhPZihcIm1vYmlsZVwiKSE9PS0xLF89IXQuUG9pbnRlckV2ZW50JiZ0Lk1TUG9pbnRlckV2ZW50LG09dC5Qb2ludGVyRXZlbnR8fF8scD1zJiZcInRyYW5zaXRpb25cImluIG4uc3R5bGUsZj1cIldlYktpdENTU01hdHJpeFwiaW4gdCYmXCJtMTFcImluIG5ldyB0LldlYktpdENTU01hdHJpeCYmIWgsZz1cIk1velBlcnNwZWN0aXZlXCJpbiBuLnN0eWxlLHY9XCJPVHJhbnNpdGlvblwiaW4gbi5zdHlsZSx5PSF0LkxfTk9fVE9VQ0gmJihtfHxcIm9udG91Y2hzdGFydFwiaW4gdHx8dC5Eb2N1bWVudFRvdWNoJiZlIGluc3RhbmNlb2YgdC5Eb2N1bWVudFRvdWNoKTtvLkJyb3dzZXI9e2llOnMsaWVsdDk6cyYmIWUuYWRkRXZlbnRMaXN0ZW5lcixlZGdlOlwibXNMYXVuY2hVcmlcImluIG5hdmlnYXRvciYmIShcImRvY3VtZW50TW9kZVwiaW4gZSksd2Via2l0OnIsZ2Vja286dSxhbmRyb2lkOmkuaW5kZXhPZihcImFuZHJvaWRcIikhPT0tMSxhbmRyb2lkMjM6aCxjaHJvbWU6bCxzYWZhcmk6IWwmJmkuaW5kZXhPZihcInNhZmFyaVwiKSE9PS0xLHdpbjpjLGllM2Q6cCx3ZWJraXQzZDpmLGdlY2tvM2Q6ZyxvcGVyYTEyOnYsYW55M2Q6IXQuTF9ESVNBQkxFXzNEJiYocHx8Znx8ZykmJiF2JiYhYSxtb2JpbGU6ZCxtb2JpbGVXZWJraXQ6ZCYmcixtb2JpbGVXZWJraXQzZDpkJiZmLG1vYmlsZU9wZXJhOmQmJnQub3BlcmEsbW9iaWxlR2Vja286ZCYmdSx0b3VjaDohIXksbXNQb2ludGVyOiEhXyxwb2ludGVyOiEhbSxyZXRpbmE6KHQuZGV2aWNlUGl4ZWxSYXRpb3x8dC5zY3JlZW4uZGV2aWNlWERQSS90LnNjcmVlbi5sb2dpY2FsWERQSSk+MX19KCksby5Qb2ludD1mdW5jdGlvbih0LGUsaSl7dGhpcy54PWk/TWF0aC5yb3VuZCh0KTp0LHRoaXMueT1pP01hdGgucm91bmQoZSk6ZX0sby5Qb2ludC5wcm90b3R5cGU9e2Nsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBvLlBvaW50KHRoaXMueCx0aGlzLnkpfSxhZGQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY2xvbmUoKS5fYWRkKG8ucG9pbnQodCkpfSxfYWRkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngrPXQueCx0aGlzLnkrPXQueSx0aGlzfSxzdWJ0cmFjdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9zdWJ0cmFjdChvLnBvaW50KHQpKX0sX3N1YnRyYWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzfSxkaXZpZGVCeTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9kaXZpZGVCeSh0KX0sX2RpdmlkZUJ5OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngvPXQsdGhpcy55Lz10LHRoaXN9LG11bHRpcGx5Qnk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY2xvbmUoKS5fbXVsdGlwbHlCeSh0KX0sX211bHRpcGx5Qnk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueCo9dCx0aGlzLnkqPXQsdGhpc30sc2NhbGVCeTpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8uUG9pbnQodGhpcy54KnQueCx0aGlzLnkqdC55KX0sdW5zY2FsZUJ5OmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgby5Qb2ludCh0aGlzLngvdC54LHRoaXMueS90LnkpfSxyb3VuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNsb25lKCkuX3JvdW5kKCl9LF9yb3VuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLng9TWF0aC5yb3VuZCh0aGlzLngpLHRoaXMueT1NYXRoLnJvdW5kKHRoaXMueSksdGhpc30sZmxvb3I6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9mbG9vcigpfSxfZmxvb3I6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54PU1hdGguZmxvb3IodGhpcy54KSx0aGlzLnk9TWF0aC5mbG9vcih0aGlzLnkpLHRoaXN9LGNlaWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9jZWlsKCl9LF9jZWlsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueD1NYXRoLmNlaWwodGhpcy54KSx0aGlzLnk9TWF0aC5jZWlsKHRoaXMueSksdGhpc30sZGlzdGFuY2VUbzpmdW5jdGlvbih0KXt0PW8ucG9pbnQodCk7dmFyIGU9dC54LXRoaXMueCxpPXQueS10aGlzLnk7cmV0dXJuIE1hdGguc3FydChlKmUraSppKX0sZXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0PW8ucG9pbnQodCksdC54PT09dGhpcy54JiZ0Lnk9PT10aGlzLnl9LGNvbnRhaW5zOmZ1bmN0aW9uKHQpe3JldHVybiB0PW8ucG9pbnQodCksTWF0aC5hYnModC54KTw9TWF0aC5hYnModGhpcy54KSYmTWF0aC5hYnModC55KTw9TWF0aC5hYnModGhpcy55KX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIlBvaW50KFwiK28uVXRpbC5mb3JtYXROdW0odGhpcy54KStcIiwgXCIrby5VdGlsLmZvcm1hdE51bSh0aGlzLnkpK1wiKVwifX0sby5wb2ludD1mdW5jdGlvbih0LGUsbil7cmV0dXJuIHQgaW5zdGFuY2VvZiBvLlBvaW50P3Q6by5VdGlsLmlzQXJyYXkodCk/bmV3IG8uUG9pbnQodFswXSx0WzFdKTp0PT09aXx8bnVsbD09PXQ/dDpcIm9iamVjdFwiPT10eXBlb2YgdCYmXCJ4XCJpbiB0JiZcInlcImluIHQ/bmV3IG8uUG9pbnQodC54LHQueSk6bmV3IG8uUG9pbnQodCxlLG4pfSxvLkJvdW5kcz1mdW5jdGlvbih0LGUpe2lmKHQpZm9yKHZhciBpPWU/W3QsZV06dCxuPTAsbz1pLmxlbmd0aDtuPG87bisrKXRoaXMuZXh0ZW5kKGlbbl0pfSxvLkJvdW5kcy5wcm90b3R5cGU9e2V4dGVuZDpmdW5jdGlvbih0KXtyZXR1cm4gdD1vLnBvaW50KHQpLHRoaXMubWlufHx0aGlzLm1heD8odGhpcy5taW4ueD1NYXRoLm1pbih0LngsdGhpcy5taW4ueCksdGhpcy5tYXgueD1NYXRoLm1heCh0LngsdGhpcy5tYXgueCksdGhpcy5taW4ueT1NYXRoLm1pbih0LnksdGhpcy5taW4ueSksdGhpcy5tYXgueT1NYXRoLm1heCh0LnksdGhpcy5tYXgueSkpOih0aGlzLm1pbj10LmNsb25lKCksdGhpcy5tYXg9dC5jbG9uZSgpKSx0aGlzfSxnZXRDZW50ZXI6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvLlBvaW50KCh0aGlzLm1pbi54K3RoaXMubWF4LngpLzIsKHRoaXMubWluLnkrdGhpcy5tYXgueSkvMix0KX0sZ2V0Qm90dG9tTGVmdDpmdW5jdGlvbigpe3JldHVybiBuZXcgby5Qb2ludCh0aGlzLm1pbi54LHRoaXMubWF4LnkpfSxnZXRUb3BSaWdodDpmdW5jdGlvbigpe3JldHVybiBuZXcgby5Qb2ludCh0aGlzLm1heC54LHRoaXMubWluLnkpfSxnZXRTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4LnN1YnRyYWN0KHRoaXMubWluKX0sY29udGFpbnM6ZnVuY3Rpb24odCl7dmFyIGUsaTtyZXR1cm4gdD1cIm51bWJlclwiPT10eXBlb2YgdFswXXx8dCBpbnN0YW5jZW9mIG8uUG9pbnQ/by5wb2ludCh0KTpvLmJvdW5kcyh0KSx0IGluc3RhbmNlb2Ygby5Cb3VuZHM/KGU9dC5taW4saT10Lm1heCk6ZT1pPXQsZS54Pj10aGlzLm1pbi54JiZpLng8PXRoaXMubWF4LngmJmUueT49dGhpcy5taW4ueSYmaS55PD10aGlzLm1heC55fSxpbnRlcnNlY3RzOmZ1bmN0aW9uKHQpe3Q9by5ib3VuZHModCk7dmFyIGU9dGhpcy5taW4saT10aGlzLm1heCxuPXQubWluLHM9dC5tYXgscj1zLng+PWUueCYmbi54PD1pLngsYT1zLnk+PWUueSYmbi55PD1pLnk7cmV0dXJuIHImJmF9LG92ZXJsYXBzOmZ1bmN0aW9uKHQpe3Q9by5ib3VuZHModCk7dmFyIGU9dGhpcy5taW4saT10aGlzLm1heCxuPXQubWluLHM9dC5tYXgscj1zLng+ZS54JiZuLng8aS54LGE9cy55PmUueSYmbi55PGkueTtyZXR1cm4gciYmYX0saXNWYWxpZDpmdW5jdGlvbigpe3JldHVybiEoIXRoaXMubWlufHwhdGhpcy5tYXgpfX0sby5ib3VuZHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4hdHx8dCBpbnN0YW5jZW9mIG8uQm91bmRzP3Q6bmV3IG8uQm91bmRzKHQsZSl9LG8uVHJhbnNmb3JtYXRpb249ZnVuY3Rpb24odCxlLGksbil7dGhpcy5fYT10LHRoaXMuX2I9ZSx0aGlzLl9jPWksdGhpcy5fZD1ufSxvLlRyYW5zZm9ybWF0aW9uLnByb3RvdHlwZT17dHJhbnNmb3JtOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX3RyYW5zZm9ybSh0LmNsb25lKCksZSl9LF90cmFuc2Zvcm06ZnVuY3Rpb24odCxlKXtyZXR1cm4gZT1lfHwxLHQueD1lKih0aGlzLl9hKnQueCt0aGlzLl9iKSx0Lnk9ZSoodGhpcy5fYyp0LnkrdGhpcy5fZCksdH0sdW50cmFuc2Zvcm06ZnVuY3Rpb24odCxlKXtyZXR1cm4gZT1lfHwxLG5ldyBvLlBvaW50KCh0LngvZS10aGlzLl9iKS90aGlzLl9hLCh0LnkvZS10aGlzLl9kKS90aGlzLl9jKX19LG8uRG9tVXRpbD17Z2V0OmZ1bmN0aW9uKHQpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiB0P2UuZ2V0RWxlbWVudEJ5SWQodCk6dH0sZ2V0U3R5bGU6ZnVuY3Rpb24odCxpKXt2YXIgbj10LnN0eWxlW2ldfHx0LmN1cnJlbnRTdHlsZSYmdC5jdXJyZW50U3R5bGVbaV07aWYoKCFufHxcImF1dG9cIj09PW4pJiZlLmRlZmF1bHRWaWV3KXt2YXIgbz1lLmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUodCxudWxsKTtuPW8/b1tpXTpudWxsfXJldHVyblwiYXV0b1wiPT09bj9udWxsOm59LGNyZWF0ZTpmdW5jdGlvbih0LGksbil7dmFyIG89ZS5jcmVhdGVFbGVtZW50KHQpO3JldHVybiBvLmNsYXNzTmFtZT1pfHxcIlwiLG4mJm4uYXBwZW5kQ2hpbGQobyksb30scmVtb3ZlOmZ1bmN0aW9uKHQpe3ZhciBlPXQucGFyZW50Tm9kZTtlJiZlLnJlbW92ZUNoaWxkKHQpfSxlbXB0eTpmdW5jdGlvbih0KXtmb3IoO3QuZmlyc3RDaGlsZDspdC5yZW1vdmVDaGlsZCh0LmZpcnN0Q2hpbGQpfSx0b0Zyb250OmZ1bmN0aW9uKHQpe3QucGFyZW50Tm9kZS5hcHBlbmRDaGlsZCh0KX0sdG9CYWNrOmZ1bmN0aW9uKHQpe3ZhciBlPXQucGFyZW50Tm9kZTtlLmluc2VydEJlZm9yZSh0LGUuZmlyc3RDaGlsZCl9LGhhc0NsYXNzOmZ1bmN0aW9uKHQsZSl7aWYodC5jbGFzc0xpc3QhPT1pKXJldHVybiB0LmNsYXNzTGlzdC5jb250YWlucyhlKTt2YXIgbj1vLkRvbVV0aWwuZ2V0Q2xhc3ModCk7cmV0dXJuIG4ubGVuZ3RoPjAmJm5ldyBSZWdFeHAoXCIoXnxcXFxccylcIitlK1wiKFxcXFxzfCQpXCIpLnRlc3Qobil9LGFkZENsYXNzOmZ1bmN0aW9uKHQsZSl7aWYodC5jbGFzc0xpc3QhPT1pKWZvcih2YXIgbj1vLlV0aWwuc3BsaXRXb3JkcyhlKSxzPTAscj1uLmxlbmd0aDtzPHI7cysrKXQuY2xhc3NMaXN0LmFkZChuW3NdKTtlbHNlIGlmKCFvLkRvbVV0aWwuaGFzQ2xhc3ModCxlKSl7dmFyIGE9by5Eb21VdGlsLmdldENsYXNzKHQpO28uRG9tVXRpbC5zZXRDbGFzcyh0LChhP2ErXCIgXCI6XCJcIikrZSl9fSxyZW1vdmVDbGFzczpmdW5jdGlvbih0LGUpe3QuY2xhc3NMaXN0IT09aT90LmNsYXNzTGlzdC5yZW1vdmUoZSk6by5Eb21VdGlsLnNldENsYXNzKHQsby5VdGlsLnRyaW0oKFwiIFwiK28uRG9tVXRpbC5nZXRDbGFzcyh0KStcIiBcIikucmVwbGFjZShcIiBcIitlK1wiIFwiLFwiIFwiKSkpfSxzZXRDbGFzczpmdW5jdGlvbih0LGUpe3QuY2xhc3NOYW1lLmJhc2VWYWw9PT1pP3QuY2xhc3NOYW1lPWU6dC5jbGFzc05hbWUuYmFzZVZhbD1lfSxnZXRDbGFzczpmdW5jdGlvbih0KXtyZXR1cm4gdC5jbGFzc05hbWUuYmFzZVZhbD09PWk/dC5jbGFzc05hbWU6dC5jbGFzc05hbWUuYmFzZVZhbH0sc2V0T3BhY2l0eTpmdW5jdGlvbih0LGUpe1wib3BhY2l0eVwiaW4gdC5zdHlsZT90LnN0eWxlLm9wYWNpdHk9ZTpcImZpbHRlclwiaW4gdC5zdHlsZSYmby5Eb21VdGlsLl9zZXRPcGFjaXR5SUUodCxlKX0sX3NldE9wYWNpdHlJRTpmdW5jdGlvbih0LGUpe3ZhciBpPSExLG49XCJEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYVwiO3RyeXtpPXQuZmlsdGVycy5pdGVtKG4pfWNhdGNoKHQpe2lmKDE9PT1lKXJldHVybn1lPU1hdGgucm91bmQoMTAwKmUpLGk/KGkuRW5hYmxlZD0xMDAhPT1lLGkuT3BhY2l0eT1lKTp0LnN0eWxlLmZpbHRlcis9XCIgcHJvZ2lkOlwiK24rXCIob3BhY2l0eT1cIitlK1wiKVwifSx0ZXN0UHJvcDpmdW5jdGlvbih0KXtmb3IodmFyIGk9ZS5kb2N1bWVudEVsZW1lbnQuc3R5bGUsbj0wO248dC5sZW5ndGg7bisrKWlmKHRbbl1pbiBpKXJldHVybiB0W25dO3JldHVybiExfSxzZXRUcmFuc2Zvcm06ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWV8fG5ldyBvLlBvaW50KDAsMCk7dC5zdHlsZVtvLkRvbVV0aWwuVFJBTlNGT1JNXT0oby5Ccm93c2VyLmllM2Q/XCJ0cmFuc2xhdGUoXCIrbi54K1wicHgsXCIrbi55K1wicHgpXCI6XCJ0cmFuc2xhdGUzZChcIituLngrXCJweCxcIituLnkrXCJweCwwKVwiKSsoaT9cIiBzY2FsZShcIitpK1wiKVwiOlwiXCIpfSxzZXRQb3NpdGlvbjpmdW5jdGlvbih0LGUpe3QuX2xlYWZsZXRfcG9zPWUsby5Ccm93c2VyLmFueTNkP28uRG9tVXRpbC5zZXRUcmFuc2Zvcm0odCxlKToodC5zdHlsZS5sZWZ0PWUueCtcInB4XCIsdC5zdHlsZS50b3A9ZS55K1wicHhcIil9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKHQpe3JldHVybiB0Ll9sZWFmbGV0X3Bvc3x8bmV3IG8uUG9pbnQoMCwwKX19LGZ1bmN0aW9uKCl7by5Eb21VdGlsLlRSQU5TRk9STT1vLkRvbVV0aWwudGVzdFByb3AoW1widHJhbnNmb3JtXCIsXCJXZWJraXRUcmFuc2Zvcm1cIixcIk9UcmFuc2Zvcm1cIixcIk1velRyYW5zZm9ybVwiLFwibXNUcmFuc2Zvcm1cIl0pO3ZhciBpPW8uRG9tVXRpbC5UUkFOU0lUSU9OPW8uRG9tVXRpbC50ZXN0UHJvcChbXCJ3ZWJraXRUcmFuc2l0aW9uXCIsXCJ0cmFuc2l0aW9uXCIsXCJPVHJhbnNpdGlvblwiLFwiTW96VHJhbnNpdGlvblwiLFwibXNUcmFuc2l0aW9uXCJdKTtpZihvLkRvbVV0aWwuVFJBTlNJVElPTl9FTkQ9XCJ3ZWJraXRUcmFuc2l0aW9uXCI9PT1pfHxcIk9UcmFuc2l0aW9uXCI9PT1pP2krXCJFbmRcIjpcInRyYW5zaXRpb25lbmRcIixcIm9uc2VsZWN0c3RhcnRcImluIGUpby5Eb21VdGlsLmRpc2FibGVUZXh0U2VsZWN0aW9uPWZ1bmN0aW9uKCl7by5Eb21FdmVudC5vbih0LFwic2VsZWN0c3RhcnRcIixvLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KX0sby5Eb21VdGlsLmVuYWJsZVRleHRTZWxlY3Rpb249ZnVuY3Rpb24oKXtvLkRvbUV2ZW50Lm9mZih0LFwic2VsZWN0c3RhcnRcIixvLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KX07ZWxzZXt2YXIgbj1vLkRvbVV0aWwudGVzdFByb3AoW1widXNlclNlbGVjdFwiLFwiV2Via2l0VXNlclNlbGVjdFwiLFwiT1VzZXJTZWxlY3RcIixcIk1velVzZXJTZWxlY3RcIixcIm1zVXNlclNlbGVjdFwiXSk7by5Eb21VdGlsLmRpc2FibGVUZXh0U2VsZWN0aW9uPWZ1bmN0aW9uKCl7aWYobil7dmFyIHQ9ZS5kb2N1bWVudEVsZW1lbnQuc3R5bGU7dGhpcy5fdXNlclNlbGVjdD10W25dLHRbbl09XCJub25lXCJ9fSxvLkRvbVV0aWwuZW5hYmxlVGV4dFNlbGVjdGlvbj1mdW5jdGlvbigpe24mJihlLmRvY3VtZW50RWxlbWVudC5zdHlsZVtuXT10aGlzLl91c2VyU2VsZWN0LGRlbGV0ZSB0aGlzLl91c2VyU2VsZWN0KX19by5Eb21VdGlsLmRpc2FibGVJbWFnZURyYWc9ZnVuY3Rpb24oKXtvLkRvbUV2ZW50Lm9uKHQsXCJkcmFnc3RhcnRcIixvLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KX0sby5Eb21VdGlsLmVuYWJsZUltYWdlRHJhZz1mdW5jdGlvbigpe28uRG9tRXZlbnQub2ZmKHQsXCJkcmFnc3RhcnRcIixvLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KX0sby5Eb21VdGlsLnByZXZlbnRPdXRsaW5lPWZ1bmN0aW9uKGUpe2Zvcig7ZS50YWJJbmRleD09PS0xOyllPWUucGFyZW50Tm9kZTtlJiZlLnN0eWxlJiYoby5Eb21VdGlsLnJlc3RvcmVPdXRsaW5lKCksdGhpcy5fb3V0bGluZUVsZW1lbnQ9ZSx0aGlzLl9vdXRsaW5lU3R5bGU9ZS5zdHlsZS5vdXRsaW5lLGUuc3R5bGUub3V0bGluZT1cIm5vbmVcIixvLkRvbUV2ZW50Lm9uKHQsXCJrZXlkb3duXCIsby5Eb21VdGlsLnJlc3RvcmVPdXRsaW5lLHRoaXMpKX0sby5Eb21VdGlsLnJlc3RvcmVPdXRsaW5lPWZ1bmN0aW9uKCl7dGhpcy5fb3V0bGluZUVsZW1lbnQmJih0aGlzLl9vdXRsaW5lRWxlbWVudC5zdHlsZS5vdXRsaW5lPXRoaXMuX291dGxpbmVTdHlsZSxkZWxldGUgdGhpcy5fb3V0bGluZUVsZW1lbnQsZGVsZXRlIHRoaXMuX291dGxpbmVTdHlsZSxvLkRvbUV2ZW50Lm9mZih0LFwia2V5ZG93blwiLG8uRG9tVXRpbC5yZXN0b3JlT3V0bGluZSx0aGlzKSl9fSgpLG8uTGF0TG5nPWZ1bmN0aW9uKHQsZSxuKXtpZihpc05hTih0KXx8aXNOYU4oZSkpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBMYXRMbmcgb2JqZWN0OiAoXCIrdCtcIiwgXCIrZStcIilcIik7dGhpcy5sYXQ9K3QsdGhpcy5sbmc9K2UsbiE9PWkmJih0aGlzLmFsdD0rbil9LG8uTGF0TG5nLnByb3RvdHlwZT17ZXF1YWxzOmZ1bmN0aW9uKHQsZSl7aWYoIXQpcmV0dXJuITE7dD1vLmxhdExuZyh0KTt2YXIgbj1NYXRoLm1heChNYXRoLmFicyh0aGlzLmxhdC10LmxhdCksTWF0aC5hYnModGhpcy5sbmctdC5sbmcpKTtyZXR1cm4gbjw9KGU9PT1pPzFlLTk6ZSl9LHRvU3RyaW5nOmZ1bmN0aW9uKHQpe3JldHVyblwiTGF0TG5nKFwiK28uVXRpbC5mb3JtYXROdW0odGhpcy5sYXQsdCkrXCIsIFwiK28uVXRpbC5mb3JtYXROdW0odGhpcy5sbmcsdCkrXCIpXCJ9LGRpc3RhbmNlVG86ZnVuY3Rpb24odCl7cmV0dXJuIG8uQ1JTLkVhcnRoLmRpc3RhbmNlKHRoaXMsby5sYXRMbmcodCkpfSx3cmFwOmZ1bmN0aW9uKCl7cmV0dXJuIG8uQ1JTLkVhcnRoLndyYXBMYXRMbmcodGhpcyl9LHRvQm91bmRzOmZ1bmN0aW9uKHQpe3ZhciBlPTE4MCp0LzQwMDc1MDE3LGk9ZS9NYXRoLmNvcyhNYXRoLlBJLzE4MCp0aGlzLmxhdCk7cmV0dXJuIG8ubGF0TG5nQm91bmRzKFt0aGlzLmxhdC1lLHRoaXMubG5nLWldLFt0aGlzLmxhdCtlLHRoaXMubG5nK2ldKX0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG8uTGF0TG5nKHRoaXMubGF0LHRoaXMubG5nLHRoaXMuYWx0KX19LG8ubGF0TG5nPWZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4gdCBpbnN0YW5jZW9mIG8uTGF0TG5nP3Q6by5VdGlsLmlzQXJyYXkodCkmJlwib2JqZWN0XCIhPXR5cGVvZiB0WzBdPzM9PT10Lmxlbmd0aD9uZXcgby5MYXRMbmcodFswXSx0WzFdLHRbMl0pOjI9PT10Lmxlbmd0aD9uZXcgby5MYXRMbmcodFswXSx0WzFdKTpudWxsOnQ9PT1pfHxudWxsPT09dD90Olwib2JqZWN0XCI9PXR5cGVvZiB0JiZcImxhdFwiaW4gdD9uZXcgby5MYXRMbmcodC5sYXQsXCJsbmdcImluIHQ/dC5sbmc6dC5sb24sdC5hbHQpOmU9PT1pP251bGw6bmV3IG8uTGF0TG5nKHQsZSxuKX0sby5MYXRMbmdCb3VuZHM9ZnVuY3Rpb24odCxlKXtpZih0KWZvcih2YXIgaT1lP1t0LGVdOnQsbj0wLG89aS5sZW5ndGg7bjxvO24rKyl0aGlzLmV4dGVuZChpW25dKX0sby5MYXRMbmdCb3VuZHMucHJvdG90eXBlPXtleHRlbmQ6ZnVuY3Rpb24odCl7dmFyIGUsaSxuPXRoaXMuX3NvdXRoV2VzdCxzPXRoaXMuX25vcnRoRWFzdDtpZih0IGluc3RhbmNlb2Ygby5MYXRMbmcpZT10LGk9dDtlbHNle2lmKCEodCBpbnN0YW5jZW9mIG8uTGF0TG5nQm91bmRzKSlyZXR1cm4gdD90aGlzLmV4dGVuZChvLmxhdExuZyh0KXx8by5sYXRMbmdCb3VuZHModCkpOnRoaXM7aWYoZT10Ll9zb3V0aFdlc3QsaT10Ll9ub3J0aEVhc3QsIWV8fCFpKXJldHVybiB0aGlzfXJldHVybiBufHxzPyhuLmxhdD1NYXRoLm1pbihlLmxhdCxuLmxhdCksbi5sbmc9TWF0aC5taW4oZS5sbmcsbi5sbmcpLHMubGF0PU1hdGgubWF4KGkubGF0LHMubGF0KSxzLmxuZz1NYXRoLm1heChpLmxuZyxzLmxuZykpOih0aGlzLl9zb3V0aFdlc3Q9bmV3IG8uTGF0TG5nKGUubGF0LGUubG5nKSx0aGlzLl9ub3J0aEVhc3Q9bmV3IG8uTGF0TG5nKGkubGF0LGkubG5nKSksdGhpc30scGFkOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX3NvdXRoV2VzdCxpPXRoaXMuX25vcnRoRWFzdCxuPU1hdGguYWJzKGUubGF0LWkubGF0KSp0LHM9TWF0aC5hYnMoZS5sbmctaS5sbmcpKnQ7cmV0dXJuIG5ldyBvLkxhdExuZ0JvdW5kcyhuZXcgby5MYXRMbmcoZS5sYXQtbixlLmxuZy1zKSxuZXcgby5MYXRMbmcoaS5sYXQrbixpLmxuZytzKSl9LGdldENlbnRlcjpmdW5jdGlvbigpe3JldHVybiBuZXcgby5MYXRMbmcoKHRoaXMuX3NvdXRoV2VzdC5sYXQrdGhpcy5fbm9ydGhFYXN0LmxhdCkvMiwodGhpcy5fc291dGhXZXN0LmxuZyt0aGlzLl9ub3J0aEVhc3QubG5nKS8yKX0sZ2V0U291dGhXZXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXRoV2VzdH0sZ2V0Tm9ydGhFYXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX25vcnRoRWFzdH0sZ2V0Tm9ydGhXZXN0OmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBvLkxhdExuZyh0aGlzLmdldE5vcnRoKCksdGhpcy5nZXRXZXN0KCkpfSxnZXRTb3V0aEVhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG8uTGF0TG5nKHRoaXMuZ2V0U291dGgoKSx0aGlzLmdldEVhc3QoKSl9LGdldFdlc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291dGhXZXN0LmxuZ30sZ2V0U291dGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291dGhXZXN0LmxhdH0sZ2V0RWFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ub3J0aEVhc3QubG5nfSxnZXROb3J0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ub3J0aEVhc3QubGF0fSxjb250YWluczpmdW5jdGlvbih0KXt0PVwibnVtYmVyXCI9PXR5cGVvZiB0WzBdfHx0IGluc3RhbmNlb2Ygby5MYXRMbmd8fFwibGF0XCJpbiB0P28ubGF0TG5nKHQpOm8ubGF0TG5nQm91bmRzKHQpO3ZhciBlLGksbj10aGlzLl9zb3V0aFdlc3Qscz10aGlzLl9ub3J0aEVhc3Q7cmV0dXJuIHQgaW5zdGFuY2VvZiBvLkxhdExuZ0JvdW5kcz8oZT10LmdldFNvdXRoV2VzdCgpLGk9dC5nZXROb3J0aEVhc3QoKSk6ZT1pPXQsZS5sYXQ+PW4ubGF0JiZpLmxhdDw9cy5sYXQmJmUubG5nPj1uLmxuZyYmaS5sbmc8PXMubG5nfSxpbnRlcnNlY3RzOmZ1bmN0aW9uKHQpe3Q9by5sYXRMbmdCb3VuZHModCk7dmFyIGU9dGhpcy5fc291dGhXZXN0LGk9dGhpcy5fbm9ydGhFYXN0LG49dC5nZXRTb3V0aFdlc3QoKSxzPXQuZ2V0Tm9ydGhFYXN0KCkscj1zLmxhdD49ZS5sYXQmJm4ubGF0PD1pLmxhdCxhPXMubG5nPj1lLmxuZyYmbi5sbmc8PWkubG5nO3JldHVybiByJiZhfSxvdmVybGFwczpmdW5jdGlvbih0KXt0PW8ubGF0TG5nQm91bmRzKHQpO3ZhciBlPXRoaXMuX3NvdXRoV2VzdCxpPXRoaXMuX25vcnRoRWFzdCxuPXQuZ2V0U291dGhXZXN0KCkscz10LmdldE5vcnRoRWFzdCgpLHI9cy5sYXQ+ZS5sYXQmJm4ubGF0PGkubGF0LGE9cy5sbmc+ZS5sbmcmJm4ubG5nPGkubG5nO3JldHVybiByJiZhfSx0b0JCb3hTdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5bdGhpcy5nZXRXZXN0KCksdGhpcy5nZXRTb3V0aCgpLHRoaXMuZ2V0RWFzdCgpLHRoaXMuZ2V0Tm9ydGgoKV0uam9pbihcIixcIil9LGVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4hIXQmJih0PW8ubGF0TG5nQm91bmRzKHQpLHRoaXMuX3NvdXRoV2VzdC5lcXVhbHModC5nZXRTb3V0aFdlc3QoKSkmJnRoaXMuX25vcnRoRWFzdC5lcXVhbHModC5nZXROb3J0aEVhc3QoKSkpfSxpc1ZhbGlkOmZ1bmN0aW9uKCl7cmV0dXJuISghdGhpcy5fc291dGhXZXN0fHwhdGhpcy5fbm9ydGhFYXN0KX19LG8ubGF0TG5nQm91bmRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQgaW5zdGFuY2VvZiBvLkxhdExuZ0JvdW5kcz90Om5ldyBvLkxhdExuZ0JvdW5kcyh0LGUpfSxvLlByb2plY3Rpb249e30sby5Qcm9qZWN0aW9uLkxvbkxhdD17cHJvamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8uUG9pbnQodC5sbmcsdC5sYXQpfSx1bnByb2plY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvLkxhdExuZyh0LnksdC54KX0sYm91bmRzOm8uYm91bmRzKFstMTgwLC05MF0sWzE4MCw5MF0pfSxvLlByb2plY3Rpb24uU3BoZXJpY2FsTWVyY2F0b3I9e1I6NjM3ODEzNyxNQVhfTEFUSVRVREU6ODUuMDUxMTI4Nzc5OCxwcm9qZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPU1hdGguUEkvMTgwLGk9dGhpcy5NQVhfTEFUSVRVREUsbj1NYXRoLm1heChNYXRoLm1pbihpLHQubGF0KSwtaSkscz1NYXRoLnNpbihuKmUpO3JldHVybiBuZXcgby5Qb2ludCh0aGlzLlIqdC5sbmcqZSx0aGlzLlIqTWF0aC5sb2coKDErcykvKDEtcykpLzIpfSx1bnByb2plY3Q6ZnVuY3Rpb24odCl7dmFyIGU9MTgwL01hdGguUEk7cmV0dXJuIG5ldyBvLkxhdExuZygoMipNYXRoLmF0YW4oTWF0aC5leHAodC55L3RoaXMuUikpLU1hdGguUEkvMikqZSx0LngqZS90aGlzLlIpfSxib3VuZHM6ZnVuY3Rpb24oKXt2YXIgdD02Mzc4MTM3Kk1hdGguUEk7cmV0dXJuIG8uYm91bmRzKFstdCwtdF0sW3QsdF0pfSgpfSxvLkNSUz17bGF0TG5nVG9Qb2ludDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMucHJvamVjdGlvbi5wcm9qZWN0KHQpLG49dGhpcy5zY2FsZShlKTtyZXR1cm4gdGhpcy50cmFuc2Zvcm1hdGlvbi5fdHJhbnNmb3JtKGksbil9LHBvaW50VG9MYXRMbmc6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLnNjYWxlKGUpLG49dGhpcy50cmFuc2Zvcm1hdGlvbi51bnRyYW5zZm9ybSh0LGkpO3JldHVybiB0aGlzLnByb2plY3Rpb24udW5wcm9qZWN0KG4pfSxwcm9qZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnByb2plY3Rpb24ucHJvamVjdCh0KX0sdW5wcm9qZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnByb2plY3Rpb24udW5wcm9qZWN0KHQpfSxzY2FsZTpmdW5jdGlvbih0KXtyZXR1cm4gMjU2Kk1hdGgucG93KDIsdCl9LHpvb206ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGgubG9nKHQvMjU2KS9NYXRoLkxOMn0sZ2V0UHJvamVjdGVkQm91bmRzOmZ1bmN0aW9uKHQpe2lmKHRoaXMuaW5maW5pdGUpcmV0dXJuIG51bGw7dmFyIGU9dGhpcy5wcm9qZWN0aW9uLmJvdW5kcyxpPXRoaXMuc2NhbGUodCksbj10aGlzLnRyYW5zZm9ybWF0aW9uLnRyYW5zZm9ybShlLm1pbixpKSxzPXRoaXMudHJhbnNmb3JtYXRpb24udHJhbnNmb3JtKGUubWF4LGkpO3JldHVybiBvLmJvdW5kcyhuLHMpfSxpbmZpbml0ZTohMSx3cmFwTGF0TG5nOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMud3JhcExuZz9vLlV0aWwud3JhcE51bSh0LmxuZyx0aGlzLndyYXBMbmcsITApOnQubG5nLGk9dGhpcy53cmFwTGF0P28uVXRpbC53cmFwTnVtKHQubGF0LHRoaXMud3JhcExhdCwhMCk6dC5sYXQsbj10LmFsdDtyZXR1cm4gby5sYXRMbmcoaSxlLG4pfSx3cmFwTGF0TG5nQm91bmRzOmZ1bmN0aW9uKHQpe3ZhciBlPXQuZ2V0Q2VudGVyKCksaT10aGlzLndyYXBMYXRMbmcoZSksbj1lLmxhdC1pLmxhdCxzPWUubG5nLWkubG5nO2lmKDA9PT1uJiYwPT09cylyZXR1cm4gdDt2YXIgcj10LmdldFNvdXRoV2VzdCgpLGE9dC5nZXROb3J0aEVhc3QoKSxoPW8ubGF0TG5nKHtsYXQ6ci5sYXQtbixsbmc6ci5sbmctc30pLGw9by5sYXRMbmcoe2xhdDphLmxhdC1uLGxuZzphLmxuZy1zfSk7cmV0dXJuIG5ldyBvLkxhdExuZ0JvdW5kcyhoLGwpfX0sby5DUlMuU2ltcGxlPW8uZXh0ZW5kKHt9LG8uQ1JTLHtwcm9qZWN0aW9uOm8uUHJvamVjdGlvbi5Mb25MYXQsdHJhbnNmb3JtYXRpb246bmV3IG8uVHJhbnNmb3JtYXRpb24oMSwwLC0xLDApLHNjYWxlOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnBvdygyLHQpfSx6b29tOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLmxvZyh0KS9NYXRoLkxOMn0sZGlzdGFuY2U6ZnVuY3Rpb24odCxlKXt2YXIgaT1lLmxuZy10LmxuZyxuPWUubGF0LXQubGF0O3JldHVybiBNYXRoLnNxcnQoaSppK24qbil9LGluZmluaXRlOiEwfSksby5DUlMuRWFydGg9by5leHRlbmQoe30sby5DUlMse3dyYXBMbmc6Wy0xODAsMTgwXSxSOjYzNzFlMyxkaXN0YW5jZTpmdW5jdGlvbih0LGUpe3ZhciBpPU1hdGguUEkvMTgwLG49dC5sYXQqaSxvPWUubGF0Kmkscz1NYXRoLnNpbihuKSpNYXRoLnNpbihvKStNYXRoLmNvcyhuKSpNYXRoLmNvcyhvKSpNYXRoLmNvcygoZS5sbmctdC5sbmcpKmkpO3JldHVybiB0aGlzLlIqTWF0aC5hY29zKE1hdGgubWluKHMsMSkpfX0pLG8uQ1JTLkVQU0czODU3PW8uZXh0ZW5kKHt9LG8uQ1JTLkVhcnRoLHtjb2RlOlwiRVBTRzozODU3XCIscHJvamVjdGlvbjpvLlByb2plY3Rpb24uU3BoZXJpY2FsTWVyY2F0b3IsdHJhbnNmb3JtYXRpb246ZnVuY3Rpb24oKXt2YXIgdD0uNS8oTWF0aC5QSSpvLlByb2plY3Rpb24uU3BoZXJpY2FsTWVyY2F0b3IuUik7cmV0dXJuIG5ldyBvLlRyYW5zZm9ybWF0aW9uKHQsLjUsLXQsLjUpfSgpfSksby5DUlMuRVBTRzkwMDkxMz1vLmV4dGVuZCh7fSxvLkNSUy5FUFNHMzg1Nyx7Y29kZTpcIkVQU0c6OTAwOTEzXCJ9KSxvLkNSUy5FUFNHNDMyNj1vLmV4dGVuZCh7fSxvLkNSUy5FYXJ0aCx7Y29kZTpcIkVQU0c6NDMyNlwiLHByb2plY3Rpb246by5Qcm9qZWN0aW9uLkxvbkxhdCx0cmFuc2Zvcm1hdGlvbjpuZXcgby5UcmFuc2Zvcm1hdGlvbigxLzE4MCwxLC0xLzE4MCwuNSl9KSxvLk1hcD1vLkV2ZW50ZWQuZXh0ZW5kKHtvcHRpb25zOntjcnM6by5DUlMuRVBTRzM4NTcsY2VudGVyOmksem9vbTppLG1pblpvb206aSxtYXhab29tOmksbGF5ZXJzOltdLG1heEJvdW5kczppLHJlbmRlcmVyOmksem9vbUFuaW1hdGlvbjohMCx6b29tQW5pbWF0aW9uVGhyZXNob2xkOjQsZmFkZUFuaW1hdGlvbjohMCxtYXJrZXJab29tQW5pbWF0aW9uOiEwLHRyYW5zZm9ybTNETGltaXQ6ODM4ODYwOCx6b29tU25hcDoxLHpvb21EZWx0YToxLHRyYWNrUmVzaXplOiEwfSxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1vLnNldE9wdGlvbnModGhpcyxlKSx0aGlzLl9pbml0Q29udGFpbmVyKHQpLHRoaXMuX2luaXRMYXlvdXQoKSx0aGlzLl9vblJlc2l6ZT1vLmJpbmQodGhpcy5fb25SZXNpemUsdGhpcyksdGhpcy5faW5pdEV2ZW50cygpLGUubWF4Qm91bmRzJiZ0aGlzLnNldE1heEJvdW5kcyhlLm1heEJvdW5kcyksZS56b29tIT09aSYmKHRoaXMuX3pvb209dGhpcy5fbGltaXRab29tKGUuem9vbSkpLGUuY2VudGVyJiZlLnpvb20hPT1pJiZ0aGlzLnNldFZpZXcoby5sYXRMbmcoZS5jZW50ZXIpLGUuem9vbSx7cmVzZXQ6ITB9KSx0aGlzLl9oYW5kbGVycz1bXSx0aGlzLl9sYXllcnM9e30sdGhpcy5fem9vbUJvdW5kTGF5ZXJzPXt9LHRoaXMuX3NpemVDaGFuZ2VkPSEwLHRoaXMuY2FsbEluaXRIb29rcygpLHRoaXMuX3pvb21BbmltYXRlZD1vLkRvbVV0aWwuVFJBTlNJVElPTiYmby5Ccm93c2VyLmFueTNkJiYhby5Ccm93c2VyLm1vYmlsZU9wZXJhJiZ0aGlzLm9wdGlvbnMuem9vbUFuaW1hdGlvbix0aGlzLl96b29tQW5pbWF0ZWQmJih0aGlzLl9jcmVhdGVBbmltUHJveHkoKSxvLkRvbUV2ZW50Lm9uKHRoaXMuX3Byb3h5LG8uRG9tVXRpbC5UUkFOU0lUSU9OX0VORCx0aGlzLl9jYXRjaFRyYW5zaXRpb25FbmQsdGhpcykpLHRoaXMuX2FkZExheWVycyh0aGlzLm9wdGlvbnMubGF5ZXJzKX0sc2V0VmlldzpmdW5jdGlvbih0LGUsbil7aWYoZT1lPT09aT90aGlzLl96b29tOnRoaXMuX2xpbWl0Wm9vbShlKSx0PXRoaXMuX2xpbWl0Q2VudGVyKG8ubGF0TG5nKHQpLGUsdGhpcy5vcHRpb25zLm1heEJvdW5kcyksbj1ufHx7fSx0aGlzLl9zdG9wKCksdGhpcy5fbG9hZGVkJiYhbi5yZXNldCYmbiE9PSEwKXtuLmFuaW1hdGUhPT1pJiYobi56b29tPW8uZXh0ZW5kKHthbmltYXRlOm4uYW5pbWF0ZX0sbi56b29tKSxuLnBhbj1vLmV4dGVuZCh7YW5pbWF0ZTpuLmFuaW1hdGUsZHVyYXRpb246bi5kdXJhdGlvbn0sbi5wYW4pKTt2YXIgcz10aGlzLl96b29tIT09ZT90aGlzLl90cnlBbmltYXRlZFpvb20mJnRoaXMuX3RyeUFuaW1hdGVkWm9vbSh0LGUsbi56b29tKTp0aGlzLl90cnlBbmltYXRlZFBhbih0LG4ucGFuKTtpZihzKXJldHVybiBjbGVhclRpbWVvdXQodGhpcy5fc2l6ZVRpbWVyKSx0aGlzfXJldHVybiB0aGlzLl9yZXNldFZpZXcodCxlKSx0aGlzfSxzZXRab29tOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX2xvYWRlZD90aGlzLnNldFZpZXcodGhpcy5nZXRDZW50ZXIoKSx0LHt6b29tOmV9KToodGhpcy5fem9vbT10LHRoaXMpfSx6b29tSW46ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD10fHwoby5Ccm93c2VyLmFueTNkP3RoaXMub3B0aW9ucy56b29tRGVsdGE6MSksdGhpcy5zZXRab29tKHRoaXMuX3pvb20rdCxlKX0sem9vbU91dDpmdW5jdGlvbih0LGUpe3JldHVybiB0PXR8fChvLkJyb3dzZXIuYW55M2Q/dGhpcy5vcHRpb25zLnpvb21EZWx0YToxKSx0aGlzLnNldFpvb20odGhpcy5fem9vbS10LGUpfSxzZXRab29tQXJvdW5kOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLmdldFpvb21TY2FsZShlKSxzPXRoaXMuZ2V0U2l6ZSgpLmRpdmlkZUJ5KDIpLHI9dCBpbnN0YW5jZW9mIG8uUG9pbnQ/dDp0aGlzLmxhdExuZ1RvQ29udGFpbmVyUG9pbnQodCksYT1yLnN1YnRyYWN0KHMpLm11bHRpcGx5QnkoMS0xL24pLGg9dGhpcy5jb250YWluZXJQb2ludFRvTGF0TG5nKHMuYWRkKGEpKTtyZXR1cm4gdGhpcy5zZXRWaWV3KGgsZSx7em9vbTppfSl9LF9nZXRCb3VuZHNDZW50ZXJab29tOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0PXQuZ2V0Qm91bmRzP3QuZ2V0Qm91bmRzKCk6by5sYXRMbmdCb3VuZHModCk7dmFyIGk9by5wb2ludChlLnBhZGRpbmdUb3BMZWZ0fHxlLnBhZGRpbmd8fFswLDBdKSxuPW8ucG9pbnQoZS5wYWRkaW5nQm90dG9tUmlnaHR8fGUucGFkZGluZ3x8WzAsMF0pLHM9dGhpcy5nZXRCb3VuZHNab29tKHQsITEsaS5hZGQobikpO3M9XCJudW1iZXJcIj09dHlwZW9mIGUubWF4Wm9vbT9NYXRoLm1pbihlLm1heFpvb20scyk6czt2YXIgcj1uLnN1YnRyYWN0KGkpLmRpdmlkZUJ5KDIpLGE9dGhpcy5wcm9qZWN0KHQuZ2V0U291dGhXZXN0KCkscyksaD10aGlzLnByb2plY3QodC5nZXROb3J0aEVhc3QoKSxzKSxsPXRoaXMudW5wcm9qZWN0KGEuYWRkKGgpLmRpdmlkZUJ5KDIpLmFkZChyKSxzKTtyZXR1cm57Y2VudGVyOmwsem9vbTpzfX0sZml0Qm91bmRzOmZ1bmN0aW9uKHQsZSl7aWYodD1vLmxhdExuZ0JvdW5kcyh0KSwhdC5pc1ZhbGlkKCkpdGhyb3cgbmV3IEVycm9yKFwiQm91bmRzIGFyZSBub3QgdmFsaWQuXCIpO3ZhciBpPXRoaXMuX2dldEJvdW5kc0NlbnRlclpvb20odCxlKTtyZXR1cm4gdGhpcy5zZXRWaWV3KGkuY2VudGVyLGkuem9vbSxlKX0sZml0V29ybGQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZml0Qm91bmRzKFtbLTkwLC0xODBdLFs5MCwxODBdXSx0KX0scGFuVG86ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zZXRWaWV3KHQsdGhpcy5fem9vbSx7cGFuOmV9KX0scGFuQnk6ZnVuY3Rpb24odCxlKXtpZih0PW8ucG9pbnQodCkucm91bmQoKSxlPWV8fHt9LCF0LngmJiF0LnkpcmV0dXJuIHRoaXMuZmlyZShcIm1vdmVlbmRcIik7aWYoZS5hbmltYXRlIT09ITAmJiF0aGlzLmdldFNpemUoKS5jb250YWlucyh0KSlyZXR1cm4gdGhpcy5fcmVzZXRWaWV3KHRoaXMudW5wcm9qZWN0KHRoaXMucHJvamVjdCh0aGlzLmdldENlbnRlcigpKS5hZGQodCkpLHRoaXMuZ2V0Wm9vbSgpKSx0aGlzO2lmKHRoaXMuX3BhbkFuaW18fCh0aGlzLl9wYW5BbmltPW5ldyBvLlBvc0FuaW1hdGlvbix0aGlzLl9wYW5BbmltLm9uKHtzdGVwOnRoaXMuX29uUGFuVHJhbnNpdGlvblN0ZXAsZW5kOnRoaXMuX29uUGFuVHJhbnNpdGlvbkVuZH0sdGhpcykpLGUubm9Nb3ZlU3RhcnR8fHRoaXMuZmlyZShcIm1vdmVzdGFydFwiKSxlLmFuaW1hdGUhPT0hMSl7by5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX21hcFBhbmUsXCJsZWFmbGV0LXBhbi1hbmltXCIpO3ZhciBpPXRoaXMuX2dldE1hcFBhbmVQb3MoKS5zdWJ0cmFjdCh0KS5yb3VuZCgpO3RoaXMuX3BhbkFuaW0ucnVuKHRoaXMuX21hcFBhbmUsaSxlLmR1cmF0aW9ufHwuMjUsZS5lYXNlTGluZWFyaXR5KX1lbHNlIHRoaXMuX3Jhd1BhbkJ5KHQpLHRoaXMuZmlyZShcIm1vdmVcIikuZmlyZShcIm1vdmVlbmRcIik7cmV0dXJuIHRoaXN9LGZseVRvOmZ1bmN0aW9uKHQsZSxuKXtmdW5jdGlvbiBzKHQpe3ZhciBlPXQ/LTE6MSxpPXQ/djpnLG49dip2LWcqZytlKkwqTCp5Knksbz0yKmkqTCp5LHM9bi9vLHI9TWF0aC5zcXJ0KHMqcysxKS1zLGE9cjwxZS05Py0xODpNYXRoLmxvZyhyKTtyZXR1cm4gYX1mdW5jdGlvbiByKHQpe3JldHVybihNYXRoLmV4cCh0KS1NYXRoLmV4cCgtdCkpLzJ9ZnVuY3Rpb24gYSh0KXtyZXR1cm4oTWF0aC5leHAodCkrTWF0aC5leHAoLXQpKS8yfWZ1bmN0aW9uIGgodCl7cmV0dXJuIHIodCkvYSh0KX1mdW5jdGlvbiBsKHQpe3JldHVybiBnKihhKHgpL2EoeCtQKnQpKX1mdW5jdGlvbiB1KHQpe3JldHVybiBnKihhKHgpKmgoeCtQKnQpLXIoeCkpL0x9ZnVuY3Rpb24gYyh0KXtyZXR1cm4gMS1NYXRoLnBvdygxLXQsMS41KX1mdW5jdGlvbiBkKCl7dmFyIGk9KERhdGUubm93KCktdykvVCxuPWMoaSkqYjtpPD0xPyh0aGlzLl9mbHlUb0ZyYW1lPW8uVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKGQsdGhpcyksdGhpcy5fbW92ZSh0aGlzLnVucHJvamVjdChfLmFkZChtLnN1YnRyYWN0KF8pLm11bHRpcGx5QnkodShuKS95KSksZiksdGhpcy5nZXRTY2FsZVpvb20oZy9sKG4pLGYpLHtmbHlUbzohMH0pKTp0aGlzLl9tb3ZlKHQsZSkuX21vdmVFbmQoITApfWlmKG49bnx8e30sbi5hbmltYXRlPT09ITF8fCFvLkJyb3dzZXIuYW55M2QpcmV0dXJuIHRoaXMuc2V0Vmlldyh0LGUsbik7dGhpcy5fc3RvcCgpO3ZhciBfPXRoaXMucHJvamVjdCh0aGlzLmdldENlbnRlcigpKSxtPXRoaXMucHJvamVjdCh0KSxwPXRoaXMuZ2V0U2l6ZSgpLGY9dGhpcy5fem9vbTt0PW8ubGF0TG5nKHQpLGU9ZT09PWk/ZjplO3ZhciBnPU1hdGgubWF4KHAueCxwLnkpLHY9Zyp0aGlzLmdldFpvb21TY2FsZShmLGUpLHk9bS5kaXN0YW5jZVRvKF8pfHwxLFA9MS40MixMPVAqUCx4PXMoMCksdz1EYXRlLm5vdygpLGI9KHMoMSkteCkvUCxUPW4uZHVyYXRpb24/MWUzKm4uZHVyYXRpb246MWUzKmIqLjg7cmV0dXJuIHRoaXMuX21vdmVTdGFydCghMCksZC5jYWxsKHRoaXMpLHRoaXN9LGZseVRvQm91bmRzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fZ2V0Qm91bmRzQ2VudGVyWm9vbSh0LGUpO3JldHVybiB0aGlzLmZseVRvKGkuY2VudGVyLGkuem9vbSxlKX0sc2V0TWF4Qm91bmRzOmZ1bmN0aW9uKHQpe3JldHVybiB0PW8ubGF0TG5nQm91bmRzKHQpLHQuaXNWYWxpZCgpPyh0aGlzLm9wdGlvbnMubWF4Qm91bmRzJiZ0aGlzLm9mZihcIm1vdmVlbmRcIix0aGlzLl9wYW5JbnNpZGVNYXhCb3VuZHMpLHRoaXMub3B0aW9ucy5tYXhCb3VuZHM9dCx0aGlzLl9sb2FkZWQmJnRoaXMuX3Bhbkluc2lkZU1heEJvdW5kcygpLHRoaXMub24oXCJtb3ZlZW5kXCIsdGhpcy5fcGFuSW5zaWRlTWF4Qm91bmRzKSk6KHRoaXMub3B0aW9ucy5tYXhCb3VuZHM9bnVsbCx0aGlzLm9mZihcIm1vdmVlbmRcIix0aGlzLl9wYW5JbnNpZGVNYXhCb3VuZHMpKX0sc2V0TWluWm9vbTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5vcHRpb25zLm1pblpvb209dCx0aGlzLl9sb2FkZWQmJnRoaXMuZ2V0Wm9vbSgpPHRoaXMub3B0aW9ucy5taW5ab29tP3RoaXMuc2V0Wm9vbSh0KTp0aGlzfSxzZXRNYXhab29tOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMubWF4Wm9vbT10LHRoaXMuX2xvYWRlZCYmdGhpcy5nZXRab29tKCk+dGhpcy5vcHRpb25zLm1heFpvb20/dGhpcy5zZXRab29tKHQpOnRoaXN9LHBhbkluc2lkZUJvdW5kczpmdW5jdGlvbih0LGUpe3RoaXMuX2VuZm9yY2luZ0JvdW5kcz0hMDt2YXIgaT10aGlzLmdldENlbnRlcigpLG49dGhpcy5fbGltaXRDZW50ZXIoaSx0aGlzLl96b29tLG8ubGF0TG5nQm91bmRzKHQpKTtyZXR1cm4gaS5lcXVhbHMobil8fHRoaXMucGFuVG8obixlKSx0aGlzLl9lbmZvcmNpbmdCb3VuZHM9ITEsdGhpc30saW52YWxpZGF0ZVNpemU6ZnVuY3Rpb24odCl7aWYoIXRoaXMuX2xvYWRlZClyZXR1cm4gdGhpczt0PW8uZXh0ZW5kKHthbmltYXRlOiExLHBhbjohMH0sdD09PSEwP3thbmltYXRlOiEwfTp0KTt2YXIgZT10aGlzLmdldFNpemUoKTt0aGlzLl9zaXplQ2hhbmdlZD0hMCx0aGlzLl9sYXN0Q2VudGVyPW51bGw7dmFyIGk9dGhpcy5nZXRTaXplKCksbj1lLmRpdmlkZUJ5KDIpLnJvdW5kKCkscz1pLmRpdmlkZUJ5KDIpLnJvdW5kKCkscj1uLnN1YnRyYWN0KHMpO3JldHVybiByLnh8fHIueT8odC5hbmltYXRlJiZ0LnBhbj90aGlzLnBhbkJ5KHIpOih0LnBhbiYmdGhpcy5fcmF3UGFuQnkociksdGhpcy5maXJlKFwibW92ZVwiKSx0LmRlYm91bmNlTW92ZWVuZD8oY2xlYXJUaW1lb3V0KHRoaXMuX3NpemVUaW1lciksdGhpcy5fc2l6ZVRpbWVyPXNldFRpbWVvdXQoby5iaW5kKHRoaXMuZmlyZSx0aGlzLFwibW92ZWVuZFwiKSwyMDApKTp0aGlzLmZpcmUoXCJtb3ZlZW5kXCIpKSx0aGlzLmZpcmUoXCJyZXNpemVcIix7b2xkU2l6ZTplLG5ld1NpemU6aX0pKTp0aGlzfSxzdG9wOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0Wm9vbSh0aGlzLl9saW1pdFpvb20odGhpcy5fem9vbSkpLHRoaXMub3B0aW9ucy56b29tU25hcHx8dGhpcy5maXJlKFwidmlld3Jlc2V0XCIpLHRoaXMuX3N0b3AoKX0sbG9jYXRlOmZ1bmN0aW9uKHQpe2lmKHQ9dGhpcy5fbG9jYXRlT3B0aW9ucz1vLmV4dGVuZCh7dGltZW91dDoxZTQsd2F0Y2g6ITF9LHQpLCEoXCJnZW9sb2NhdGlvblwiaW4gbmF2aWdhdG9yKSlyZXR1cm4gdGhpcy5faGFuZGxlR2VvbG9jYXRpb25FcnJvcih7Y29kZTowLG1lc3NhZ2U6XCJHZW9sb2NhdGlvbiBub3Qgc3VwcG9ydGVkLlwifSksdGhpczt2YXIgZT1vLmJpbmQodGhpcy5faGFuZGxlR2VvbG9jYXRpb25SZXNwb25zZSx0aGlzKSxpPW8uYmluZCh0aGlzLl9oYW5kbGVHZW9sb2NhdGlvbkVycm9yLHRoaXMpO3JldHVybiB0LndhdGNoP3RoaXMuX2xvY2F0aW9uV2F0Y2hJZD1uYXZpZ2F0b3IuZ2VvbG9jYXRpb24ud2F0Y2hQb3NpdGlvbihlLGksdCk6bmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihlLGksdCksdGhpc30sc3RvcExvY2F0ZTpmdW5jdGlvbigpe3JldHVybiBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24mJm5hdmlnYXRvci5nZW9sb2NhdGlvbi5jbGVhcldhdGNoJiZuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uY2xlYXJXYXRjaCh0aGlzLl9sb2NhdGlvbldhdGNoSWQpLHRoaXMuX2xvY2F0ZU9wdGlvbnMmJih0aGlzLl9sb2NhdGVPcHRpb25zLnNldFZpZXc9ITEpLHRoaXN9LF9oYW5kbGVHZW9sb2NhdGlvbkVycm9yOmZ1bmN0aW9uKHQpe3ZhciBlPXQuY29kZSxpPXQubWVzc2FnZXx8KDE9PT1lP1wicGVybWlzc2lvbiBkZW5pZWRcIjoyPT09ZT9cInBvc2l0aW9uIHVuYXZhaWxhYmxlXCI6XCJ0aW1lb3V0XCIpO3RoaXMuX2xvY2F0ZU9wdGlvbnMuc2V0VmlldyYmIXRoaXMuX2xvYWRlZCYmdGhpcy5maXRXb3JsZCgpLHRoaXMuZmlyZShcImxvY2F0aW9uZXJyb3JcIix7Y29kZTplLG1lc3NhZ2U6XCJHZW9sb2NhdGlvbiBlcnJvcjogXCIraStcIi5cIn0pfSxfaGFuZGxlR2VvbG9jYXRpb25SZXNwb25zZTpmdW5jdGlvbih0KXt2YXIgZT10LmNvb3Jkcy5sYXRpdHVkZSxpPXQuY29vcmRzLmxvbmdpdHVkZSxuPW5ldyBvLkxhdExuZyhlLGkpLHM9bi50b0JvdW5kcyh0LmNvb3Jkcy5hY2N1cmFjeSkscj10aGlzLl9sb2NhdGVPcHRpb25zO2lmKHIuc2V0Vmlldyl7dmFyIGE9dGhpcy5nZXRCb3VuZHNab29tKHMpO3RoaXMuc2V0VmlldyhuLHIubWF4Wm9vbT9NYXRoLm1pbihhLHIubWF4Wm9vbSk6YSl9dmFyIGg9e2xhdGxuZzpuLGJvdW5kczpzLHRpbWVzdGFtcDp0LnRpbWVzdGFtcH07Zm9yKHZhciBsIGluIHQuY29vcmRzKVwibnVtYmVyXCI9PXR5cGVvZiB0LmNvb3Jkc1tsXSYmKGhbbF09dC5jb29yZHNbbF0pO3RoaXMuZmlyZShcImxvY2F0aW9uZm91bmRcIixoKX0sYWRkSGFuZGxlcjpmdW5jdGlvbih0LGUpe2lmKCFlKXJldHVybiB0aGlzO3ZhciBpPXRoaXNbdF09bmV3IGUodGhpcyk7cmV0dXJuIHRoaXMuX2hhbmRsZXJzLnB1c2goaSksdGhpcy5vcHRpb25zW3RdJiZpLmVuYWJsZSgpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe2lmKHRoaXMuX2luaXRFdmVudHMoITApLHRoaXMuX2NvbnRhaW5lcklkIT09dGhpcy5fY29udGFpbmVyLl9sZWFmbGV0X2lkKXRocm93IG5ldyBFcnJvcihcIk1hcCBjb250YWluZXIgaXMgYmVpbmcgcmV1c2VkIGJ5IGFub3RoZXIgaW5zdGFuY2VcIik7dHJ5e2RlbGV0ZSB0aGlzLl9jb250YWluZXIuX2xlYWZsZXRfaWQsZGVsZXRlIHRoaXMuX2NvbnRhaW5lcklkfWNhdGNoKHQpe3RoaXMuX2NvbnRhaW5lci5fbGVhZmxldF9pZD1pLHRoaXMuX2NvbnRhaW5lcklkPWl9by5Eb21VdGlsLnJlbW92ZSh0aGlzLl9tYXBQYW5lKSx0aGlzLl9jbGVhckNvbnRyb2xQb3MmJnRoaXMuX2NsZWFyQ29udHJvbFBvcygpLHRoaXMuX2NsZWFySGFuZGxlcnMoKSx0aGlzLl9sb2FkZWQmJnRoaXMuZmlyZShcInVubG9hZFwiKTtmb3IodmFyIHQgaW4gdGhpcy5fbGF5ZXJzKXRoaXMuX2xheWVyc1t0XS5yZW1vdmUoKTtyZXR1cm4gdGhpc30sY3JlYXRlUGFuZTpmdW5jdGlvbih0LGUpe3ZhciBpPVwibGVhZmxldC1wYW5lXCIrKHQ/XCIgbGVhZmxldC1cIit0LnJlcGxhY2UoXCJQYW5lXCIsXCJcIikrXCItcGFuZVwiOlwiXCIpLG49by5Eb21VdGlsLmNyZWF0ZShcImRpdlwiLGksZXx8dGhpcy5fbWFwUGFuZSk7cmV0dXJuIHQmJih0aGlzLl9wYW5lc1t0XT1uKSxufSxnZXRDZW50ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2hlY2tJZkxvYWRlZCgpLHRoaXMuX2xhc3RDZW50ZXImJiF0aGlzLl9tb3ZlZCgpP3RoaXMuX2xhc3RDZW50ZXI6dGhpcy5sYXllclBvaW50VG9MYXRMbmcodGhpcy5fZ2V0Q2VudGVyTGF5ZXJQb2ludCgpKX0sZ2V0Wm9vbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl96b29tfSxnZXRCb3VuZHM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFBpeGVsQm91bmRzKCksZT10aGlzLnVucHJvamVjdCh0LmdldEJvdHRvbUxlZnQoKSksaT10aGlzLnVucHJvamVjdCh0LmdldFRvcFJpZ2h0KCkpO3JldHVybiBuZXcgby5MYXRMbmdCb3VuZHMoZSxpKX0sZ2V0TWluWm9vbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMubWluWm9vbT09PWk/dGhpcy5fbGF5ZXJzTWluWm9vbXx8MDp0aGlzLm9wdGlvbnMubWluWm9vbX0sZ2V0TWF4Wm9vbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMubWF4Wm9vbT09PWk/dGhpcy5fbGF5ZXJzTWF4Wm9vbT09PWk/MS8wOnRoaXMuX2xheWVyc01heFpvb206dGhpcy5vcHRpb25zLm1heFpvb219LGdldEJvdW5kc1pvb206ZnVuY3Rpb24odCxlLGkpe3Q9by5sYXRMbmdCb3VuZHModCksaT1vLnBvaW50KGl8fFswLDBdKTt2YXIgbj10aGlzLmdldFpvb20oKXx8MCxzPXRoaXMuZ2V0TWluWm9vbSgpLHI9dGhpcy5nZXRNYXhab29tKCksYT10LmdldE5vcnRoV2VzdCgpLGg9dC5nZXRTb3V0aEVhc3QoKSxsPXRoaXMuZ2V0U2l6ZSgpLnN1YnRyYWN0KGkpLHU9by5ib3VuZHModGhpcy5wcm9qZWN0KGgsbiksdGhpcy5wcm9qZWN0KGEsbikpLmdldFNpemUoKSxjPW8uQnJvd3Nlci5hbnkzZD90aGlzLm9wdGlvbnMuem9vbVNuYXA6MSxkPU1hdGgubWluKGwueC91LngsbC55L3UueSk7cmV0dXJuIG49dGhpcy5nZXRTY2FsZVpvb20oZCxuKSxjJiYobj1NYXRoLnJvdW5kKG4vKGMvMTAwKSkqKGMvMTAwKSxuPWU/TWF0aC5jZWlsKG4vYykqYzpNYXRoLmZsb29yKG4vYykqYyksTWF0aC5tYXgocyxNYXRoLm1pbihyLG4pKX0sZ2V0U2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaXplJiYhdGhpcy5fc2l6ZUNoYW5nZWR8fCh0aGlzLl9zaXplPW5ldyBvLlBvaW50KHRoaXMuX2NvbnRhaW5lci5jbGllbnRXaWR0aHx8MCx0aGlzLl9jb250YWluZXIuY2xpZW50SGVpZ2h0fHwwKSx0aGlzLl9zaXplQ2hhbmdlZD0hMSksdGhpcy5fc2l6ZS5jbG9uZSgpfSxnZXRQaXhlbEJvdW5kczpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2dldFRvcExlZnRQb2ludCh0LGUpO3JldHVybiBuZXcgby5Cb3VuZHMoaSxpLmFkZCh0aGlzLmdldFNpemUoKSkpfSxnZXRQaXhlbE9yaWdpbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jaGVja0lmTG9hZGVkKCksdGhpcy5fcGl4ZWxPcmlnaW59LGdldFBpeGVsV29ybGRCb3VuZHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3B0aW9ucy5jcnMuZ2V0UHJvamVjdGVkQm91bmRzKHQ9PT1pP3RoaXMuZ2V0Wm9vbSgpOnQpfSxnZXRQYW5lOmZ1bmN0aW9uKHQpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiB0P3RoaXMuX3BhbmVzW3RdOnR9LGdldFBhbmVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BhbmVzfSxnZXRDb250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29udGFpbmVyfSxnZXRab29tU2NhbGU6ZnVuY3Rpb24odCxlKXt2YXIgbj10aGlzLm9wdGlvbnMuY3JzO3JldHVybiBlPWU9PT1pP3RoaXMuX3pvb206ZSxuLnNjYWxlKHQpL24uc2NhbGUoZSl9LGdldFNjYWxlWm9vbTpmdW5jdGlvbih0LGUpe3ZhciBuPXRoaXMub3B0aW9ucy5jcnM7ZT1lPT09aT90aGlzLl96b29tOmU7dmFyIG89bi56b29tKHQqbi5zY2FsZShlKSk7cmV0dXJuIGlzTmFOKG8pPzEvMDpvfSxwcm9qZWN0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGU9ZT09PWk/dGhpcy5fem9vbTplLHRoaXMub3B0aW9ucy5jcnMubGF0TG5nVG9Qb2ludChvLmxhdExuZyh0KSxlKX0sdW5wcm9qZWN0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGU9ZT09PWk/dGhpcy5fem9vbTplLHRoaXMub3B0aW9ucy5jcnMucG9pbnRUb0xhdExuZyhvLnBvaW50KHQpLGUpfSxsYXllclBvaW50VG9MYXRMbmc6ZnVuY3Rpb24odCl7dmFyIGU9by5wb2ludCh0KS5hZGQodGhpcy5nZXRQaXhlbE9yaWdpbigpKTtyZXR1cm4gdGhpcy51bnByb2plY3QoZSl9LGxhdExuZ1RvTGF5ZXJQb2ludDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnByb2plY3Qoby5sYXRMbmcodCkpLl9yb3VuZCgpO3JldHVybiBlLl9zdWJ0cmFjdCh0aGlzLmdldFBpeGVsT3JpZ2luKCkpfSx3cmFwTGF0TG5nOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMuY3JzLndyYXBMYXRMbmcoby5sYXRMbmcodCkpfSx3cmFwTGF0TG5nQm91bmRzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMuY3JzLndyYXBMYXRMbmdCb3VuZHMoby5sYXRMbmdCb3VuZHModCkpfSxkaXN0YW5jZTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLm9wdGlvbnMuY3JzLmRpc3RhbmNlKG8ubGF0TG5nKHQpLG8ubGF0TG5nKGUpKX0sY29udGFpbmVyUG9pbnRUb0xheWVyUG9pbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIG8ucG9pbnQodCkuc3VidHJhY3QodGhpcy5fZ2V0TWFwUGFuZVBvcygpKX0sbGF5ZXJQb2ludFRvQ29udGFpbmVyUG9pbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIG8ucG9pbnQodCkuYWRkKHRoaXMuX2dldE1hcFBhbmVQb3MoKSl9LGNvbnRhaW5lclBvaW50VG9MYXRMbmc6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5jb250YWluZXJQb2ludFRvTGF5ZXJQb2ludChvLnBvaW50KHQpKTtyZXR1cm4gdGhpcy5sYXllclBvaW50VG9MYXRMbmcoZSl9LGxhdExuZ1RvQ29udGFpbmVyUG9pbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubGF5ZXJQb2ludFRvQ29udGFpbmVyUG9pbnQodGhpcy5sYXRMbmdUb0xheWVyUG9pbnQoby5sYXRMbmcodCkpKX0sbW91c2VFdmVudFRvQ29udGFpbmVyUG9pbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIG8uRG9tRXZlbnQuZ2V0TW91c2VQb3NpdGlvbih0LHRoaXMuX2NvbnRhaW5lcil9LG1vdXNlRXZlbnRUb0xheWVyUG9pbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29udGFpbmVyUG9pbnRUb0xheWVyUG9pbnQodGhpcy5tb3VzZUV2ZW50VG9Db250YWluZXJQb2ludCh0KSl9LG1vdXNlRXZlbnRUb0xhdExuZzpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5sYXllclBvaW50VG9MYXRMbmcodGhpcy5tb3VzZUV2ZW50VG9MYXllclBvaW50KHQpKX0sX2luaXRDb250YWluZXI6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY29udGFpbmVyPW8uRG9tVXRpbC5nZXQodCk7aWYoIWUpdGhyb3cgbmV3IEVycm9yKFwiTWFwIGNvbnRhaW5lciBub3QgZm91bmQuXCIpO2lmKGUuX2xlYWZsZXRfaWQpdGhyb3cgbmV3IEVycm9yKFwiTWFwIGNvbnRhaW5lciBpcyBhbHJlYWR5IGluaXRpYWxpemVkLlwiKTtvLkRvbUV2ZW50LmFkZExpc3RlbmVyKGUsXCJzY3JvbGxcIix0aGlzLl9vblNjcm9sbCx0aGlzKSx0aGlzLl9jb250YWluZXJJZD1vLlV0aWwuc3RhbXAoZSl9LF9pbml0TGF5b3V0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fY29udGFpbmVyO3RoaXMuX2ZhZGVBbmltYXRlZD10aGlzLm9wdGlvbnMuZmFkZUFuaW1hdGlvbiYmby5Ccm93c2VyLmFueTNkLFxuby5Eb21VdGlsLmFkZENsYXNzKHQsXCJsZWFmbGV0LWNvbnRhaW5lclwiKyhvLkJyb3dzZXIudG91Y2g/XCIgbGVhZmxldC10b3VjaFwiOlwiXCIpKyhvLkJyb3dzZXIucmV0aW5hP1wiIGxlYWZsZXQtcmV0aW5hXCI6XCJcIikrKG8uQnJvd3Nlci5pZWx0OT9cIiBsZWFmbGV0LW9sZGllXCI6XCJcIikrKG8uQnJvd3Nlci5zYWZhcmk/XCIgbGVhZmxldC1zYWZhcmlcIjpcIlwiKSsodGhpcy5fZmFkZUFuaW1hdGVkP1wiIGxlYWZsZXQtZmFkZS1hbmltXCI6XCJcIikpO3ZhciBlPW8uRG9tVXRpbC5nZXRTdHlsZSh0LFwicG9zaXRpb25cIik7XCJhYnNvbHV0ZVwiIT09ZSYmXCJyZWxhdGl2ZVwiIT09ZSYmXCJmaXhlZFwiIT09ZSYmKHQuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiKSx0aGlzLl9pbml0UGFuZXMoKSx0aGlzLl9pbml0Q29udHJvbFBvcyYmdGhpcy5faW5pdENvbnRyb2xQb3MoKX0sX2luaXRQYW5lczpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3BhbmVzPXt9O3RoaXMuX3BhbmVSZW5kZXJlcnM9e30sdGhpcy5fbWFwUGFuZT10aGlzLmNyZWF0ZVBhbmUoXCJtYXBQYW5lXCIsdGhpcy5fY29udGFpbmVyKSxvLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fbWFwUGFuZSxuZXcgby5Qb2ludCgwLDApKSx0aGlzLmNyZWF0ZVBhbmUoXCJ0aWxlUGFuZVwiKSx0aGlzLmNyZWF0ZVBhbmUoXCJzaGFkb3dQYW5lXCIpLHRoaXMuY3JlYXRlUGFuZShcIm92ZXJsYXlQYW5lXCIpLHRoaXMuY3JlYXRlUGFuZShcIm1hcmtlclBhbmVcIiksdGhpcy5jcmVhdGVQYW5lKFwidG9vbHRpcFBhbmVcIiksdGhpcy5jcmVhdGVQYW5lKFwicG9wdXBQYW5lXCIpLHRoaXMub3B0aW9ucy5tYXJrZXJab29tQW5pbWF0aW9ufHwoby5Eb21VdGlsLmFkZENsYXNzKHQubWFya2VyUGFuZSxcImxlYWZsZXQtem9vbS1oaWRlXCIpLG8uRG9tVXRpbC5hZGRDbGFzcyh0LnNoYWRvd1BhbmUsXCJsZWFmbGV0LXpvb20taGlkZVwiKSl9LF9yZXNldFZpZXc6ZnVuY3Rpb24odCxlKXtvLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fbWFwUGFuZSxuZXcgby5Qb2ludCgwLDApKTt2YXIgaT0hdGhpcy5fbG9hZGVkO3RoaXMuX2xvYWRlZD0hMCxlPXRoaXMuX2xpbWl0Wm9vbShlKSx0aGlzLmZpcmUoXCJ2aWV3cHJlcmVzZXRcIik7dmFyIG49dGhpcy5fem9vbSE9PWU7dGhpcy5fbW92ZVN0YXJ0KG4pLl9tb3ZlKHQsZSkuX21vdmVFbmQobiksdGhpcy5maXJlKFwidmlld3Jlc2V0XCIpLGkmJnRoaXMuZmlyZShcImxvYWRcIil9LF9tb3ZlU3RhcnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnRoaXMuZmlyZShcInpvb21zdGFydFwiKSx0aGlzLmZpcmUoXCJtb3Zlc3RhcnRcIil9LF9tb3ZlOmZ1bmN0aW9uKHQsZSxuKXtlPT09aSYmKGU9dGhpcy5fem9vbSk7dmFyIG89dGhpcy5fem9vbSE9PWU7cmV0dXJuIHRoaXMuX3pvb209ZSx0aGlzLl9sYXN0Q2VudGVyPXQsdGhpcy5fcGl4ZWxPcmlnaW49dGhpcy5fZ2V0TmV3UGl4ZWxPcmlnaW4odCksKG98fG4mJm4ucGluY2gpJiZ0aGlzLmZpcmUoXCJ6b29tXCIsbiksdGhpcy5maXJlKFwibW92ZVwiLG4pfSxfbW92ZUVuZDpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcy5maXJlKFwiem9vbWVuZFwiKSx0aGlzLmZpcmUoXCJtb3ZlZW5kXCIpfSxfc3RvcDpmdW5jdGlvbigpe3JldHVybiBvLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2ZseVRvRnJhbWUpLHRoaXMuX3BhbkFuaW0mJnRoaXMuX3BhbkFuaW0uc3RvcCgpLHRoaXN9LF9yYXdQYW5CeTpmdW5jdGlvbih0KXtvLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fbWFwUGFuZSx0aGlzLl9nZXRNYXBQYW5lUG9zKCkuc3VidHJhY3QodCkpfSxfZ2V0Wm9vbVNwYW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRNYXhab29tKCktdGhpcy5nZXRNaW5ab29tKCl9LF9wYW5JbnNpZGVNYXhCb3VuZHM6ZnVuY3Rpb24oKXt0aGlzLl9lbmZvcmNpbmdCb3VuZHN8fHRoaXMucGFuSW5zaWRlQm91bmRzKHRoaXMub3B0aW9ucy5tYXhCb3VuZHMpfSxfY2hlY2tJZkxvYWRlZDpmdW5jdGlvbigpe2lmKCF0aGlzLl9sb2FkZWQpdGhyb3cgbmV3IEVycm9yKFwiU2V0IG1hcCBjZW50ZXIgYW5kIHpvb20gZmlyc3QuXCIpfSxfaW5pdEV2ZW50czpmdW5jdGlvbihlKXtpZihvLkRvbUV2ZW50KXt0aGlzLl90YXJnZXRzPXt9LHRoaXMuX3RhcmdldHNbby5zdGFtcCh0aGlzLl9jb250YWluZXIpXT10aGlzO3ZhciBpPWU/XCJvZmZcIjpcIm9uXCI7by5Eb21FdmVudFtpXSh0aGlzLl9jb250YWluZXIsXCJjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2Vtb3ZlIGNvbnRleHRtZW51IGtleXByZXNzXCIsdGhpcy5faGFuZGxlRE9NRXZlbnQsdGhpcyksdGhpcy5vcHRpb25zLnRyYWNrUmVzaXplJiZvLkRvbUV2ZW50W2ldKHQsXCJyZXNpemVcIix0aGlzLl9vblJlc2l6ZSx0aGlzKSxvLkJyb3dzZXIuYW55M2QmJnRoaXMub3B0aW9ucy50cmFuc2Zvcm0zRExpbWl0JiZ0aGlzW2ldKFwibW92ZWVuZFwiLHRoaXMuX29uTW92ZUVuZCl9fSxfb25SZXNpemU6ZnVuY3Rpb24oKXtvLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX3Jlc2l6ZVJlcXVlc3QpLHRoaXMuX3Jlc2l6ZVJlcXVlc3Q9by5VdGlsLnJlcXVlc3RBbmltRnJhbWUoZnVuY3Rpb24oKXt0aGlzLmludmFsaWRhdGVTaXplKHtkZWJvdW5jZU1vdmVlbmQ6ITB9KX0sdGhpcyl9LF9vblNjcm9sbDpmdW5jdGlvbigpe3RoaXMuX2NvbnRhaW5lci5zY3JvbGxUb3A9MCx0aGlzLl9jb250YWluZXIuc2Nyb2xsTGVmdD0wfSxfb25Nb3ZlRW5kOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZ2V0TWFwUGFuZVBvcygpO01hdGgubWF4KE1hdGguYWJzKHQueCksTWF0aC5hYnModC55KSk+PXRoaXMub3B0aW9ucy50cmFuc2Zvcm0zRExpbWl0JiZ0aGlzLl9yZXNldFZpZXcodGhpcy5nZXRDZW50ZXIoKSx0aGlzLmdldFpvb20oKSl9LF9maW5kRXZlbnRUYXJnZXRzOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpLG49W10scz1cIm1vdXNlb3V0XCI9PT1lfHxcIm1vdXNlb3ZlclwiPT09ZSxyPXQudGFyZ2V0fHx0LnNyY0VsZW1lbnQsYT0hMTtyOyl7aWYoaT10aGlzLl90YXJnZXRzW28uc3RhbXAocildLGkmJihcImNsaWNrXCI9PT1lfHxcInByZWNsaWNrXCI9PT1lKSYmIXQuX3NpbXVsYXRlZCYmdGhpcy5fZHJhZ2dhYmxlTW92ZWQoaSkpe2E9ITA7YnJlYWt9aWYoaSYmaS5saXN0ZW5zKGUsITApKXtpZihzJiYhby5Eb21FdmVudC5faXNFeHRlcm5hbFRhcmdldChyLHQpKWJyZWFrO2lmKG4ucHVzaChpKSxzKWJyZWFrfWlmKHI9PT10aGlzLl9jb250YWluZXIpYnJlYWs7cj1yLnBhcmVudE5vZGV9cmV0dXJuIG4ubGVuZ3RofHxhfHxzfHwhby5Eb21FdmVudC5faXNFeHRlcm5hbFRhcmdldChyLHQpfHwobj1bdGhpc10pLG59LF9oYW5kbGVET01FdmVudDpmdW5jdGlvbih0KXtpZih0aGlzLl9sb2FkZWQmJiFvLkRvbUV2ZW50Ll9za2lwcGVkKHQpKXt2YXIgZT1cImtleXByZXNzXCI9PT10LnR5cGUmJjEzPT09dC5rZXlDb2RlP1wiY2xpY2tcIjp0LnR5cGU7XCJtb3VzZWRvd25cIj09PWUmJm8uRG9tVXRpbC5wcmV2ZW50T3V0bGluZSh0LnRhcmdldHx8dC5zcmNFbGVtZW50KSx0aGlzLl9maXJlRE9NRXZlbnQodCxlKX19LF9maXJlRE9NRXZlbnQ6ZnVuY3Rpb24odCxlLGkpe2lmKFwiY2xpY2tcIj09PXQudHlwZSl7dmFyIG49by5VdGlsLmV4dGVuZCh7fSx0KTtuLnR5cGU9XCJwcmVjbGlja1wiLHRoaXMuX2ZpcmVET01FdmVudChuLG4udHlwZSxpKX1pZighdC5fc3RvcHBlZCYmKGk9KGl8fFtdKS5jb25jYXQodGhpcy5fZmluZEV2ZW50VGFyZ2V0cyh0LGUpKSxpLmxlbmd0aCkpe3ZhciBzPWlbMF07XCJjb250ZXh0bWVudVwiPT09ZSYmcy5saXN0ZW5zKGUsITApJiZvLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KHQpO3ZhciByPXtvcmlnaW5hbEV2ZW50OnR9O2lmKFwia2V5cHJlc3NcIiE9PXQudHlwZSl7dmFyIGE9cyBpbnN0YW5jZW9mIG8uTWFya2VyO3IuY29udGFpbmVyUG9pbnQ9YT90aGlzLmxhdExuZ1RvQ29udGFpbmVyUG9pbnQocy5nZXRMYXRMbmcoKSk6dGhpcy5tb3VzZUV2ZW50VG9Db250YWluZXJQb2ludCh0KSxyLmxheWVyUG9pbnQ9dGhpcy5jb250YWluZXJQb2ludFRvTGF5ZXJQb2ludChyLmNvbnRhaW5lclBvaW50KSxyLmxhdGxuZz1hP3MuZ2V0TGF0TG5nKCk6dGhpcy5sYXllclBvaW50VG9MYXRMbmcoci5sYXllclBvaW50KX1mb3IodmFyIGg9MDtoPGkubGVuZ3RoO2grKylpZihpW2hdLmZpcmUoZSxyLCEwKSxyLm9yaWdpbmFsRXZlbnQuX3N0b3BwZWR8fGlbaF0ub3B0aW9ucy5ub25CdWJibGluZ0V2ZW50cyYmby5VdGlsLmluZGV4T2YoaVtoXS5vcHRpb25zLm5vbkJ1YmJsaW5nRXZlbnRzLGUpIT09LTEpcmV0dXJufX0sX2RyYWdnYWJsZU1vdmVkOmZ1bmN0aW9uKHQpe3JldHVybiB0PXQuZHJhZ2dpbmcmJnQuZHJhZ2dpbmcuZW5hYmxlZCgpP3Q6dGhpcyx0LmRyYWdnaW5nJiZ0LmRyYWdnaW5nLm1vdmVkKCl8fHRoaXMuYm94Wm9vbSYmdGhpcy5ib3hab29tLm1vdmVkKCl9LF9jbGVhckhhbmRsZXJzOmZ1bmN0aW9uKCl7Zm9yKHZhciB0PTAsZT10aGlzLl9oYW5kbGVycy5sZW5ndGg7dDxlO3QrKyl0aGlzLl9oYW5kbGVyc1t0XS5kaXNhYmxlKCl9LHdoZW5SZWFkeTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9sb2FkZWQ/dC5jYWxsKGV8fHRoaXMse3RhcmdldDp0aGlzfSk6dGhpcy5vbihcImxvYWRcIix0LGUpLHRoaXN9LF9nZXRNYXBQYW5lUG9zOmZ1bmN0aW9uKCl7cmV0dXJuIG8uRG9tVXRpbC5nZXRQb3NpdGlvbih0aGlzLl9tYXBQYW5lKXx8bmV3IG8uUG9pbnQoMCwwKX0sX21vdmVkOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZ2V0TWFwUGFuZVBvcygpO3JldHVybiB0JiYhdC5lcXVhbHMoWzAsMF0pfSxfZ2V0VG9wTGVmdFBvaW50OmZ1bmN0aW9uKHQsZSl7dmFyIG49dCYmZSE9PWk/dGhpcy5fZ2V0TmV3UGl4ZWxPcmlnaW4odCxlKTp0aGlzLmdldFBpeGVsT3JpZ2luKCk7cmV0dXJuIG4uc3VidHJhY3QodGhpcy5fZ2V0TWFwUGFuZVBvcygpKX0sX2dldE5ld1BpeGVsT3JpZ2luOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRTaXplKCkuX2RpdmlkZUJ5KDIpO3JldHVybiB0aGlzLnByb2plY3QodCxlKS5fc3VidHJhY3QoaSkuX2FkZCh0aGlzLl9nZXRNYXBQYW5lUG9zKCkpLl9yb3VuZCgpfSxfbGF0TG5nVG9OZXdMYXllclBvaW50OmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLl9nZXROZXdQaXhlbE9yaWdpbihpLGUpO3JldHVybiB0aGlzLnByb2plY3QodCxlKS5fc3VidHJhY3Qobil9LF9sYXRMbmdCb3VuZHNUb05ld0xheWVyQm91bmRzOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLl9nZXROZXdQaXhlbE9yaWdpbihpLGUpO3JldHVybiBvLmJvdW5kcyhbdGhpcy5wcm9qZWN0KHQuZ2V0U291dGhXZXN0KCksZSkuX3N1YnRyYWN0KG4pLHRoaXMucHJvamVjdCh0LmdldE5vcnRoV2VzdCgpLGUpLl9zdWJ0cmFjdChuKSx0aGlzLnByb2plY3QodC5nZXRTb3V0aEVhc3QoKSxlKS5fc3VidHJhY3QobiksdGhpcy5wcm9qZWN0KHQuZ2V0Tm9ydGhFYXN0KCksZSkuX3N1YnRyYWN0KG4pXSl9LF9nZXRDZW50ZXJMYXllclBvaW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGFpbmVyUG9pbnRUb0xheWVyUG9pbnQodGhpcy5nZXRTaXplKCkuX2RpdmlkZUJ5KDIpKX0sX2dldENlbnRlck9mZnNldDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5sYXRMbmdUb0xheWVyUG9pbnQodCkuc3VidHJhY3QodGhpcy5fZ2V0Q2VudGVyTGF5ZXJQb2ludCgpKX0sX2xpbWl0Q2VudGVyOmZ1bmN0aW9uKHQsZSxpKXtpZighaSlyZXR1cm4gdDt2YXIgbj10aGlzLnByb2plY3QodCxlKSxzPXRoaXMuZ2V0U2l6ZSgpLmRpdmlkZUJ5KDIpLHI9bmV3IG8uQm91bmRzKG4uc3VidHJhY3Qocyksbi5hZGQocykpLGE9dGhpcy5fZ2V0Qm91bmRzT2Zmc2V0KHIsaSxlKTtyZXR1cm4gYS5yb3VuZCgpLmVxdWFscyhbMCwwXSk/dDp0aGlzLnVucHJvamVjdChuLmFkZChhKSxlKX0sX2xpbWl0T2Zmc2V0OmZ1bmN0aW9uKHQsZSl7aWYoIWUpcmV0dXJuIHQ7dmFyIGk9dGhpcy5nZXRQaXhlbEJvdW5kcygpLG49bmV3IG8uQm91bmRzKGkubWluLmFkZCh0KSxpLm1heC5hZGQodCkpO3JldHVybiB0LmFkZCh0aGlzLl9nZXRCb3VuZHNPZmZzZXQobixlKSl9LF9nZXRCb3VuZHNPZmZzZXQ6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPW8uYm91bmRzKHRoaXMucHJvamVjdChlLmdldE5vcnRoRWFzdCgpLGkpLHRoaXMucHJvamVjdChlLmdldFNvdXRoV2VzdCgpLGkpKSxzPW4ubWluLnN1YnRyYWN0KHQubWluKSxyPW4ubWF4LnN1YnRyYWN0KHQubWF4KSxhPXRoaXMuX3JlYm91bmQocy54LC1yLngpLGg9dGhpcy5fcmVib3VuZChzLnksLXIueSk7cmV0dXJuIG5ldyBvLlBvaW50KGEsaCl9LF9yZWJvdW5kOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrZT4wP01hdGgucm91bmQodC1lKS8yOk1hdGgubWF4KDAsTWF0aC5jZWlsKHQpKS1NYXRoLm1heCgwLE1hdGguZmxvb3IoZSkpfSxfbGltaXRab29tOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0TWluWm9vbSgpLGk9dGhpcy5nZXRNYXhab29tKCksbj1vLkJyb3dzZXIuYW55M2Q/dGhpcy5vcHRpb25zLnpvb21TbmFwOjE7cmV0dXJuIG4mJih0PU1hdGgucm91bmQodC9uKSpuKSxNYXRoLm1heChlLE1hdGgubWluKGksdCkpfSxfb25QYW5UcmFuc2l0aW9uU3RlcDpmdW5jdGlvbigpe3RoaXMuZmlyZShcIm1vdmVcIil9LF9vblBhblRyYW5zaXRpb25FbmQ6ZnVuY3Rpb24oKXtvLkRvbVV0aWwucmVtb3ZlQ2xhc3ModGhpcy5fbWFwUGFuZSxcImxlYWZsZXQtcGFuLWFuaW1cIiksdGhpcy5maXJlKFwibW92ZWVuZFwiKX0sX3RyeUFuaW1hdGVkUGFuOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fZ2V0Q2VudGVyT2Zmc2V0KHQpLl9mbG9vcigpO3JldHVybiEoKGUmJmUuYW5pbWF0ZSkhPT0hMCYmIXRoaXMuZ2V0U2l6ZSgpLmNvbnRhaW5zKGkpKSYmKHRoaXMucGFuQnkoaSxlKSwhMCl9LF9jcmVhdGVBbmltUHJveHk6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9wcm94eT1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsXCJsZWFmbGV0LXByb3h5IGxlYWZsZXQtem9vbS1hbmltYXRlZFwiKTt0aGlzLl9wYW5lcy5tYXBQYW5lLmFwcGVuZENoaWxkKHQpLHRoaXMub24oXCJ6b29tYW5pbVwiLGZ1bmN0aW9uKGUpe3ZhciBpPW8uRG9tVXRpbC5UUkFOU0ZPUk0sbj10LnN0eWxlW2ldO28uRG9tVXRpbC5zZXRUcmFuc2Zvcm0odCx0aGlzLnByb2plY3QoZS5jZW50ZXIsZS56b29tKSx0aGlzLmdldFpvb21TY2FsZShlLnpvb20sMSkpLG49PT10LnN0eWxlW2ldJiZ0aGlzLl9hbmltYXRpbmdab29tJiZ0aGlzLl9vblpvb21UcmFuc2l0aW9uRW5kKCl9LHRoaXMpLHRoaXMub24oXCJsb2FkIG1vdmVlbmRcIixmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0Q2VudGVyKCksaT10aGlzLmdldFpvb20oKTtvLkRvbVV0aWwuc2V0VHJhbnNmb3JtKHQsdGhpcy5wcm9qZWN0KGUsaSksdGhpcy5nZXRab29tU2NhbGUoaSwxKSl9LHRoaXMpfSxfY2F0Y2hUcmFuc2l0aW9uRW5kOmZ1bmN0aW9uKHQpe3RoaXMuX2FuaW1hdGluZ1pvb20mJnQucHJvcGVydHlOYW1lLmluZGV4T2YoXCJ0cmFuc2Zvcm1cIik+PTAmJnRoaXMuX29uWm9vbVRyYW5zaXRpb25FbmQoKX0sX25vdGhpbmdUb0FuaW1hdGU6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5fY29udGFpbmVyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJsZWFmbGV0LXpvb20tYW5pbWF0ZWRcIikubGVuZ3RofSxfdHJ5QW5pbWF0ZWRab29tOmZ1bmN0aW9uKHQsZSxpKXtpZih0aGlzLl9hbmltYXRpbmdab29tKXJldHVybiEwO2lmKGk9aXx8e30sIXRoaXMuX3pvb21BbmltYXRlZHx8aS5hbmltYXRlPT09ITF8fHRoaXMuX25vdGhpbmdUb0FuaW1hdGUoKXx8TWF0aC5hYnMoZS10aGlzLl96b29tKT50aGlzLm9wdGlvbnMuem9vbUFuaW1hdGlvblRocmVzaG9sZClyZXR1cm4hMTt2YXIgbj10aGlzLmdldFpvb21TY2FsZShlKSxzPXRoaXMuX2dldENlbnRlck9mZnNldCh0KS5fZGl2aWRlQnkoMS0xL24pO3JldHVybiEoaS5hbmltYXRlIT09ITAmJiF0aGlzLmdldFNpemUoKS5jb250YWlucyhzKSkmJihvLlV0aWwucmVxdWVzdEFuaW1GcmFtZShmdW5jdGlvbigpe3RoaXMuX21vdmVTdGFydCghMCkuX2FuaW1hdGVab29tKHQsZSwhMCl9LHRoaXMpLCEwKX0sX2FuaW1hdGVab29tOmZ1bmN0aW9uKHQsZSxpLG4pe2kmJih0aGlzLl9hbmltYXRpbmdab29tPSEwLHRoaXMuX2FuaW1hdGVUb0NlbnRlcj10LHRoaXMuX2FuaW1hdGVUb1pvb209ZSxvLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5fbWFwUGFuZSxcImxlYWZsZXQtem9vbS1hbmltXCIpKSx0aGlzLmZpcmUoXCJ6b29tYW5pbVwiLHtjZW50ZXI6dCx6b29tOmUsbm9VcGRhdGU6bn0pLHNldFRpbWVvdXQoby5iaW5kKHRoaXMuX29uWm9vbVRyYW5zaXRpb25FbmQsdGhpcyksMjUwKX0sX29uWm9vbVRyYW5zaXRpb25FbmQ6ZnVuY3Rpb24oKXt0aGlzLl9hbmltYXRpbmdab29tJiYoby5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX21hcFBhbmUsXCJsZWFmbGV0LXpvb20tYW5pbVwiKSx0aGlzLl9hbmltYXRpbmdab29tPSExLHRoaXMuX21vdmUodGhpcy5fYW5pbWF0ZVRvQ2VudGVyLHRoaXMuX2FuaW1hdGVUb1pvb20pLG8uVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKGZ1bmN0aW9uKCl7dGhpcy5fbW92ZUVuZCghMCl9LHRoaXMpKX19KSxvLm1hcD1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgby5NYXAodCxlKX0sby5MYXllcj1vLkV2ZW50ZWQuZXh0ZW5kKHtvcHRpb25zOntwYW5lOlwib3ZlcmxheVBhbmVcIixub25CdWJibGluZ0V2ZW50czpbXSxhdHRyaWJ1dGlvbjpudWxsfSxhZGRUbzpmdW5jdGlvbih0KXtyZXR1cm4gdC5hZGRMYXllcih0aGlzKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW1vdmVGcm9tKHRoaXMuX21hcHx8dGhpcy5fbWFwVG9BZGQpfSxyZW1vdmVGcm9tOmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0LnJlbW92ZUxheWVyKHRoaXMpLHRoaXN9LGdldFBhbmU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX21hcC5nZXRQYW5lKHQ/dGhpcy5vcHRpb25zW3RdfHx0OnRoaXMub3B0aW9ucy5wYW5lKX0sYWRkSW50ZXJhY3RpdmVUYXJnZXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX21hcC5fdGFyZ2V0c1tvLnN0YW1wKHQpXT10aGlzLHRoaXN9LHJlbW92ZUludGVyYWN0aXZlVGFyZ2V0OmZ1bmN0aW9uKHQpe3JldHVybiBkZWxldGUgdGhpcy5fbWFwLl90YXJnZXRzW28uc3RhbXAodCldLHRoaXN9LGdldEF0dHJpYnV0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5hdHRyaWJ1dGlvbn0sX2xheWVyQWRkOmZ1bmN0aW9uKHQpe3ZhciBlPXQudGFyZ2V0O2lmKGUuaGFzTGF5ZXIodGhpcykpe2lmKHRoaXMuX21hcD1lLHRoaXMuX3pvb21BbmltYXRlZD1lLl96b29tQW5pbWF0ZWQsdGhpcy5nZXRFdmVudHMpe3ZhciBpPXRoaXMuZ2V0RXZlbnRzKCk7ZS5vbihpLHRoaXMpLHRoaXMub25jZShcInJlbW92ZVwiLGZ1bmN0aW9uKCl7ZS5vZmYoaSx0aGlzKX0sdGhpcyl9dGhpcy5vbkFkZChlKSx0aGlzLmdldEF0dHJpYnV0aW9uJiZlLmF0dHJpYnV0aW9uQ29udHJvbCYmZS5hdHRyaWJ1dGlvbkNvbnRyb2wuYWRkQXR0cmlidXRpb24odGhpcy5nZXRBdHRyaWJ1dGlvbigpKSx0aGlzLmZpcmUoXCJhZGRcIiksZS5maXJlKFwibGF5ZXJhZGRcIix7bGF5ZXI6dGhpc30pfX19KSxvLk1hcC5pbmNsdWRlKHthZGRMYXllcjpmdW5jdGlvbih0KXt2YXIgZT1vLnN0YW1wKHQpO3JldHVybiB0aGlzLl9sYXllcnNbZV0/dGhpczoodGhpcy5fbGF5ZXJzW2VdPXQsdC5fbWFwVG9BZGQ9dGhpcyx0LmJlZm9yZUFkZCYmdC5iZWZvcmVBZGQodGhpcyksdGhpcy53aGVuUmVhZHkodC5fbGF5ZXJBZGQsdCksdGhpcyl9LHJlbW92ZUxheWVyOmZ1bmN0aW9uKHQpe3ZhciBlPW8uc3RhbXAodCk7cmV0dXJuIHRoaXMuX2xheWVyc1tlXT8odGhpcy5fbG9hZGVkJiZ0Lm9uUmVtb3ZlKHRoaXMpLHQuZ2V0QXR0cmlidXRpb24mJnRoaXMuYXR0cmlidXRpb25Db250cm9sJiZ0aGlzLmF0dHJpYnV0aW9uQ29udHJvbC5yZW1vdmVBdHRyaWJ1dGlvbih0LmdldEF0dHJpYnV0aW9uKCkpLGRlbGV0ZSB0aGlzLl9sYXllcnNbZV0sdGhpcy5fbG9hZGVkJiYodGhpcy5maXJlKFwibGF5ZXJyZW1vdmVcIix7bGF5ZXI6dH0pLHQuZmlyZShcInJlbW92ZVwiKSksdC5fbWFwPXQuX21hcFRvQWRkPW51bGwsdGhpcyk6dGhpc30saGFzTGF5ZXI6ZnVuY3Rpb24odCl7cmV0dXJuISF0JiZvLnN0YW1wKHQpaW4gdGhpcy5fbGF5ZXJzfSxlYWNoTGF5ZXI6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGkgaW4gdGhpcy5fbGF5ZXJzKXQuY2FsbChlLHRoaXMuX2xheWVyc1tpXSk7cmV0dXJuIHRoaXN9LF9hZGRMYXllcnM6ZnVuY3Rpb24odCl7dD10P28uVXRpbC5pc0FycmF5KHQpP3Q6W3RdOltdO2Zvcih2YXIgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl0aGlzLmFkZExheWVyKHRbZV0pfSxfYWRkWm9vbUxpbWl0OmZ1bmN0aW9uKHQpeyFpc05hTih0Lm9wdGlvbnMubWF4Wm9vbSkmJmlzTmFOKHQub3B0aW9ucy5taW5ab29tKXx8KHRoaXMuX3pvb21Cb3VuZExheWVyc1tvLnN0YW1wKHQpXT10LHRoaXMuX3VwZGF0ZVpvb21MZXZlbHMoKSl9LF9yZW1vdmVab29tTGltaXQ6ZnVuY3Rpb24odCl7dmFyIGU9by5zdGFtcCh0KTt0aGlzLl96b29tQm91bmRMYXllcnNbZV0mJihkZWxldGUgdGhpcy5fem9vbUJvdW5kTGF5ZXJzW2VdLHRoaXMuX3VwZGF0ZVpvb21MZXZlbHMoKSl9LF91cGRhdGVab29tTGV2ZWxzOmZ1bmN0aW9uKCl7dmFyIHQ9MS8wLGU9LSgxLzApLG49dGhpcy5fZ2V0Wm9vbVNwYW4oKTtmb3IodmFyIG8gaW4gdGhpcy5fem9vbUJvdW5kTGF5ZXJzKXt2YXIgcz10aGlzLl96b29tQm91bmRMYXllcnNbb10ub3B0aW9uczt0PXMubWluWm9vbT09PWk/dDpNYXRoLm1pbih0LHMubWluWm9vbSksZT1zLm1heFpvb209PT1pP2U6TWF0aC5tYXgoZSxzLm1heFpvb20pfXRoaXMuX2xheWVyc01heFpvb209ZT09PS0oMS8wKT9pOmUsdGhpcy5fbGF5ZXJzTWluWm9vbT10PT09MS8wP2k6dCxuIT09dGhpcy5fZ2V0Wm9vbVNwYW4oKSYmdGhpcy5maXJlKFwiem9vbWxldmVsc2NoYW5nZVwiKSx0aGlzLm9wdGlvbnMubWF4Wm9vbT09PWkmJnRoaXMuX2xheWVyc01heFpvb20mJnRoaXMuZ2V0Wm9vbSgpPnRoaXMuX2xheWVyc01heFpvb20mJnRoaXMuc2V0Wm9vbSh0aGlzLl9sYXllcnNNYXhab29tKSx0aGlzLm9wdGlvbnMubWluWm9vbT09PWkmJnRoaXMuX2xheWVyc01pblpvb20mJnRoaXMuZ2V0Wm9vbSgpPHRoaXMuX2xheWVyc01pblpvb20mJnRoaXMuc2V0Wm9vbSh0aGlzLl9sYXllcnNNaW5ab29tKX19KTt2YXIgcj1cIl9sZWFmbGV0X2V2ZW50c1wiO28uRG9tRXZlbnQ9e29uOmZ1bmN0aW9uKHQsZSxpLG4pe2lmKFwib2JqZWN0XCI9PXR5cGVvZiBlKWZvcih2YXIgcyBpbiBlKXRoaXMuX29uKHQscyxlW3NdLGkpO2Vsc2V7ZT1vLlV0aWwuc3BsaXRXb3JkcyhlKTtmb3IodmFyIHI9MCxhPWUubGVuZ3RoO3I8YTtyKyspdGhpcy5fb24odCxlW3JdLGksbil9cmV0dXJuIHRoaXN9LG9mZjpmdW5jdGlvbih0LGUsaSxuKXtpZihcIm9iamVjdFwiPT10eXBlb2YgZSlmb3IodmFyIHMgaW4gZSl0aGlzLl9vZmYodCxzLGVbc10saSk7ZWxzZXtlPW8uVXRpbC5zcGxpdFdvcmRzKGUpO2Zvcih2YXIgcj0wLGE9ZS5sZW5ndGg7cjxhO3IrKyl0aGlzLl9vZmYodCxlW3JdLGksbil9cmV0dXJuIHRoaXN9LF9vbjpmdW5jdGlvbihlLGksbixzKXt2YXIgYT1pK28uc3RhbXAobikrKHM/XCJfXCIrby5zdGFtcChzKTpcIlwiKTtpZihlW3JdJiZlW3JdW2FdKXJldHVybiB0aGlzO3ZhciBoPWZ1bmN0aW9uKGkpe3JldHVybiBuLmNhbGwoc3x8ZSxpfHx0LmV2ZW50KX0sbD1oO3JldHVybiBvLkJyb3dzZXIucG9pbnRlciYmMD09PWkuaW5kZXhPZihcInRvdWNoXCIpP3RoaXMuYWRkUG9pbnRlckxpc3RlbmVyKGUsaSxoLGEpOiFvLkJyb3dzZXIudG91Y2h8fFwiZGJsY2xpY2tcIiE9PWl8fCF0aGlzLmFkZERvdWJsZVRhcExpc3RlbmVyfHxvLkJyb3dzZXIucG9pbnRlciYmby5Ccm93c2VyLmNocm9tZT9cImFkZEV2ZW50TGlzdGVuZXJcImluIGU/XCJtb3VzZXdoZWVsXCI9PT1pP2UuYWRkRXZlbnRMaXN0ZW5lcihcIm9ud2hlZWxcImluIGU/XCJ3aGVlbFwiOlwibW91c2V3aGVlbFwiLGgsITEpOlwibW91c2VlbnRlclwiPT09aXx8XCJtb3VzZWxlYXZlXCI9PT1pPyhoPWZ1bmN0aW9uKGkpe2k9aXx8dC5ldmVudCxvLkRvbUV2ZW50Ll9pc0V4dGVybmFsVGFyZ2V0KGUsaSkmJmwoaSl9LGUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIj09PWk/XCJtb3VzZW92ZXJcIjpcIm1vdXNlb3V0XCIsaCwhMSkpOihcImNsaWNrXCI9PT1pJiZvLkJyb3dzZXIuYW5kcm9pZCYmKGg9ZnVuY3Rpb24odCl7cmV0dXJuIG8uRG9tRXZlbnQuX2ZpbHRlckNsaWNrKHQsbCl9KSxlLmFkZEV2ZW50TGlzdGVuZXIoaSxoLCExKSk6XCJhdHRhY2hFdmVudFwiaW4gZSYmZS5hdHRhY2hFdmVudChcIm9uXCIraSxoKTp0aGlzLmFkZERvdWJsZVRhcExpc3RlbmVyKGUsaCxhKSxlW3JdPWVbcl18fHt9LGVbcl1bYV09aCx0aGlzfSxfb2ZmOmZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBzPWUrby5zdGFtcChpKSsobj9cIl9cIitvLnN0YW1wKG4pOlwiXCIpLGE9dFtyXSYmdFtyXVtzXTtyZXR1cm4gYT8oby5Ccm93c2VyLnBvaW50ZXImJjA9PT1lLmluZGV4T2YoXCJ0b3VjaFwiKT90aGlzLnJlbW92ZVBvaW50ZXJMaXN0ZW5lcih0LGUscyk6by5Ccm93c2VyLnRvdWNoJiZcImRibGNsaWNrXCI9PT1lJiZ0aGlzLnJlbW92ZURvdWJsZVRhcExpc3RlbmVyP3RoaXMucmVtb3ZlRG91YmxlVGFwTGlzdGVuZXIodCxzKTpcInJlbW92ZUV2ZW50TGlzdGVuZXJcImluIHQ/XCJtb3VzZXdoZWVsXCI9PT1lP3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm9ud2hlZWxcImluIHQ/XCJ3aGVlbFwiOlwibW91c2V3aGVlbFwiLGEsITEpOnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIj09PWU/XCJtb3VzZW92ZXJcIjpcIm1vdXNlbGVhdmVcIj09PWU/XCJtb3VzZW91dFwiOmUsYSwhMSk6XCJkZXRhY2hFdmVudFwiaW4gdCYmdC5kZXRhY2hFdmVudChcIm9uXCIrZSxhKSx0W3JdW3NdPW51bGwsdGhpcyk6dGhpc30sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKHQpe3JldHVybiB0LnN0b3BQcm9wYWdhdGlvbj90LnN0b3BQcm9wYWdhdGlvbigpOnQub3JpZ2luYWxFdmVudD90Lm9yaWdpbmFsRXZlbnQuX3N0b3BwZWQ9ITA6dC5jYW5jZWxCdWJibGU9ITAsby5Eb21FdmVudC5fc2tpcHBlZCh0KSx0aGlzfSxkaXNhYmxlU2Nyb2xsUHJvcGFnYXRpb246ZnVuY3Rpb24odCl7cmV0dXJuIG8uRG9tRXZlbnQub24odCxcIm1vdXNld2hlZWxcIixvLkRvbUV2ZW50LnN0b3BQcm9wYWdhdGlvbil9LGRpc2FibGVDbGlja1Byb3BhZ2F0aW9uOmZ1bmN0aW9uKHQpe3ZhciBlPW8uRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uO3JldHVybiBvLkRvbUV2ZW50Lm9uKHQsby5EcmFnZ2FibGUuU1RBUlQuam9pbihcIiBcIiksZSksby5Eb21FdmVudC5vbih0LHtjbGljazpvLkRvbUV2ZW50Ll9mYWtlU3RvcCxkYmxjbGljazplfSl9LHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKHQpe3JldHVybiB0LnByZXZlbnREZWZhdWx0P3QucHJldmVudERlZmF1bHQoKTp0LnJldHVyblZhbHVlPSExLHRoaXN9LHN0b3A6ZnVuY3Rpb24odCl7cmV0dXJuIG8uRG9tRXZlbnQucHJldmVudERlZmF1bHQodCkuc3RvcFByb3BhZ2F0aW9uKHQpfSxnZXRNb3VzZVBvc2l0aW9uOmZ1bmN0aW9uKHQsZSl7aWYoIWUpcmV0dXJuIG5ldyBvLlBvaW50KHQuY2xpZW50WCx0LmNsaWVudFkpO3ZhciBpPWUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJuIG5ldyBvLlBvaW50KHQuY2xpZW50WC1pLmxlZnQtZS5jbGllbnRMZWZ0LHQuY2xpZW50WS1pLnRvcC1lLmNsaWVudFRvcCl9LF93aGVlbFB4RmFjdG9yOm8uQnJvd3Nlci53aW4mJm8uQnJvd3Nlci5jaHJvbWU/MjpvLkJyb3dzZXIuZ2Vja28/dC5kZXZpY2VQaXhlbFJhdGlvOjEsZ2V0V2hlZWxEZWx0YTpmdW5jdGlvbih0KXtyZXR1cm4gby5Ccm93c2VyLmVkZ2U/dC53aGVlbERlbHRhWS8yOnQuZGVsdGFZJiYwPT09dC5kZWx0YU1vZGU/LXQuZGVsdGFZL28uRG9tRXZlbnQuX3doZWVsUHhGYWN0b3I6dC5kZWx0YVkmJjE9PT10LmRlbHRhTW9kZT8yMCotdC5kZWx0YVk6dC5kZWx0YVkmJjI9PT10LmRlbHRhTW9kZT82MCotdC5kZWx0YVk6dC5kZWx0YVh8fHQuZGVsdGFaPzA6dC53aGVlbERlbHRhPyh0LndoZWVsRGVsdGFZfHx0LndoZWVsRGVsdGEpLzI6dC5kZXRhaWwmJk1hdGguYWJzKHQuZGV0YWlsKTwzMjc2NT8yMCotdC5kZXRhaWw6dC5kZXRhaWw/dC5kZXRhaWwvLTMyNzY1KjYwOjB9LF9za2lwRXZlbnRzOnt9LF9mYWtlU3RvcDpmdW5jdGlvbih0KXtvLkRvbUV2ZW50Ll9za2lwRXZlbnRzW3QudHlwZV09ITB9LF9za2lwcGVkOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX3NraXBFdmVudHNbdC50eXBlXTtyZXR1cm4gdGhpcy5fc2tpcEV2ZW50c1t0LnR5cGVdPSExLGV9LF9pc0V4dGVybmFsVGFyZ2V0OmZ1bmN0aW9uKHQsZSl7dmFyIGk9ZS5yZWxhdGVkVGFyZ2V0O2lmKCFpKXJldHVybiEwO3RyeXtmb3IoO2kmJmkhPT10OylpPWkucGFyZW50Tm9kZX1jYXRjaCh0KXtyZXR1cm4hMX1yZXR1cm4gaSE9PXR9LF9maWx0ZXJDbGljazpmdW5jdGlvbih0LGUpe3ZhciBpPXQudGltZVN0YW1wfHx0Lm9yaWdpbmFsRXZlbnQmJnQub3JpZ2luYWxFdmVudC50aW1lU3RhbXAsbj1vLkRvbUV2ZW50Ll9sYXN0Q2xpY2smJmktby5Eb21FdmVudC5fbGFzdENsaWNrO3JldHVybiBuJiZuPjEwMCYmbjw1MDB8fHQudGFyZ2V0Ll9zaW11bGF0ZWRDbGljayYmIXQuX3NpbXVsYXRlZD92b2lkIG8uRG9tRXZlbnQuc3RvcCh0KTooby5Eb21FdmVudC5fbGFzdENsaWNrPWksdm9pZCBlKHQpKX19LG8uRG9tRXZlbnQuYWRkTGlzdGVuZXI9by5Eb21FdmVudC5vbixvLkRvbUV2ZW50LnJlbW92ZUxpc3RlbmVyPW8uRG9tRXZlbnQub2ZmLG8uUG9zQW5pbWF0aW9uPW8uRXZlbnRlZC5leHRlbmQoe3J1bjpmdW5jdGlvbih0LGUsaSxuKXt0aGlzLnN0b3AoKSx0aGlzLl9lbD10LHRoaXMuX2luUHJvZ3Jlc3M9ITAsdGhpcy5fZHVyYXRpb249aXx8LjI1LHRoaXMuX2Vhc2VPdXRQb3dlcj0xL01hdGgubWF4KG58fC41LC4yKSx0aGlzLl9zdGFydFBvcz1vLkRvbVV0aWwuZ2V0UG9zaXRpb24odCksdGhpcy5fb2Zmc2V0PWUuc3VidHJhY3QodGhpcy5fc3RhcnRQb3MpLHRoaXMuX3N0YXJ0VGltZT0rbmV3IERhdGUsdGhpcy5maXJlKFwic3RhcnRcIiksdGhpcy5fYW5pbWF0ZSgpfSxzdG9wOmZ1bmN0aW9uKCl7dGhpcy5faW5Qcm9ncmVzcyYmKHRoaXMuX3N0ZXAoITApLHRoaXMuX2NvbXBsZXRlKCkpfSxfYW5pbWF0ZTpmdW5jdGlvbigpe3RoaXMuX2FuaW1JZD1vLlV0aWwucmVxdWVzdEFuaW1GcmFtZSh0aGlzLl9hbmltYXRlLHRoaXMpLHRoaXMuX3N0ZXAoKX0sX3N0ZXA6ZnVuY3Rpb24odCl7dmFyIGU9K25ldyBEYXRlLXRoaXMuX3N0YXJ0VGltZSxpPTFlMyp0aGlzLl9kdXJhdGlvbjtlPGk/dGhpcy5fcnVuRnJhbWUodGhpcy5fZWFzZU91dChlL2kpLHQpOih0aGlzLl9ydW5GcmFtZSgxKSx0aGlzLl9jb21wbGV0ZSgpKX0sX3J1bkZyYW1lOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fc3RhcnRQb3MuYWRkKHRoaXMuX29mZnNldC5tdWx0aXBseUJ5KHQpKTtlJiZpLl9yb3VuZCgpLG8uRG9tVXRpbC5zZXRQb3NpdGlvbih0aGlzLl9lbCxpKSx0aGlzLmZpcmUoXCJzdGVwXCIpfSxfY29tcGxldGU6ZnVuY3Rpb24oKXtvLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2FuaW1JZCksdGhpcy5faW5Qcm9ncmVzcz0hMSx0aGlzLmZpcmUoXCJlbmRcIil9LF9lYXNlT3V0OmZ1bmN0aW9uKHQpe3JldHVybiAxLU1hdGgucG93KDEtdCx0aGlzLl9lYXNlT3V0UG93ZXIpfX0pLG8uUHJvamVjdGlvbi5NZXJjYXRvcj17Ujo2Mzc4MTM3LFJfTUlOT1I6NjM1Njc1Mi4zMTQyNDUxNzksYm91bmRzOm8uYm91bmRzKFstMjAwMzc1MDguMzQyNzksLTE1NDk2NTcwLjczOTcyXSxbMjAwMzc1MDguMzQyNzksMTg3NjQ2NTYuMjMxMzhdKSxwcm9qZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPU1hdGguUEkvMTgwLGk9dGhpcy5SLG49dC5sYXQqZSxzPXRoaXMuUl9NSU5PUi9pLHI9TWF0aC5zcXJ0KDEtcypzKSxhPXIqTWF0aC5zaW4obiksaD1NYXRoLnRhbihNYXRoLlBJLzQtbi8yKS9NYXRoLnBvdygoMS1hKS8oMSthKSxyLzIpO3JldHVybiBuPS1pKk1hdGgubG9nKE1hdGgubWF4KGgsMWUtMTApKSxuZXcgby5Qb2ludCh0LmxuZyplKmksbil9LHVucHJvamVjdDpmdW5jdGlvbih0KXtmb3IodmFyIGUsaT0xODAvTWF0aC5QSSxuPXRoaXMuUixzPXRoaXMuUl9NSU5PUi9uLHI9TWF0aC5zcXJ0KDEtcypzKSxhPU1hdGguZXhwKC10LnkvbiksaD1NYXRoLlBJLzItMipNYXRoLmF0YW4oYSksbD0wLHU9LjE7bDwxNSYmTWF0aC5hYnModSk+MWUtNztsKyspZT1yKk1hdGguc2luKGgpLGU9TWF0aC5wb3coKDEtZSkvKDErZSksci8yKSx1PU1hdGguUEkvMi0yKk1hdGguYXRhbihhKmUpLWgsaCs9dTtyZXR1cm4gbmV3IG8uTGF0TG5nKGgqaSx0LngqaS9uKX19LG8uQ1JTLkVQU0czMzk1PW8uZXh0ZW5kKHt9LG8uQ1JTLkVhcnRoLHtjb2RlOlwiRVBTRzozMzk1XCIscHJvamVjdGlvbjpvLlByb2plY3Rpb24uTWVyY2F0b3IsdHJhbnNmb3JtYXRpb246ZnVuY3Rpb24oKXt2YXIgdD0uNS8oTWF0aC5QSSpvLlByb2plY3Rpb24uTWVyY2F0b3IuUik7cmV0dXJuIG5ldyBvLlRyYW5zZm9ybWF0aW9uKHQsLjUsLXQsLjUpfSgpfSksby5HcmlkTGF5ZXI9by5MYXllci5leHRlbmQoe29wdGlvbnM6e3RpbGVTaXplOjI1NixvcGFjaXR5OjEsdXBkYXRlV2hlbklkbGU6by5Ccm93c2VyLm1vYmlsZSx1cGRhdGVXaGVuWm9vbWluZzohMCx1cGRhdGVJbnRlcnZhbDoyMDAsekluZGV4OjEsYm91bmRzOm51bGwsbWluWm9vbTowLG1heFpvb206aSxub1dyYXA6ITEscGFuZTpcInRpbGVQYW5lXCIsY2xhc3NOYW1lOlwiXCIsa2VlcEJ1ZmZlcjoyfSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe28uc2V0T3B0aW9ucyh0aGlzLHQpfSxvbkFkZDpmdW5jdGlvbigpe3RoaXMuX2luaXRDb250YWluZXIoKSx0aGlzLl9sZXZlbHM9e30sdGhpcy5fdGlsZXM9e30sdGhpcy5fcmVzZXRWaWV3KCksdGhpcy5fdXBkYXRlKCl9LGJlZm9yZUFkZDpmdW5jdGlvbih0KXt0Ll9hZGRab29tTGltaXQodGhpcyl9LG9uUmVtb3ZlOmZ1bmN0aW9uKHQpe3RoaXMuX3JlbW92ZUFsbFRpbGVzKCksby5Eb21VdGlsLnJlbW92ZSh0aGlzLl9jb250YWluZXIpLHQuX3JlbW92ZVpvb21MaW1pdCh0aGlzKSx0aGlzLl9jb250YWluZXI9bnVsbCx0aGlzLl90aWxlWm9vbT1udWxsfSxicmluZ1RvRnJvbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWFwJiYoby5Eb21VdGlsLnRvRnJvbnQodGhpcy5fY29udGFpbmVyKSx0aGlzLl9zZXRBdXRvWkluZGV4KE1hdGgubWF4KSksdGhpc30sYnJpbmdUb0JhY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWFwJiYoby5Eb21VdGlsLnRvQmFjayh0aGlzLl9jb250YWluZXIpLHRoaXMuX3NldEF1dG9aSW5kZXgoTWF0aC5taW4pKSx0aGlzfSxnZXRDb250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29udGFpbmVyfSxzZXRPcGFjaXR5OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMub3BhY2l0eT10LHRoaXMuX3VwZGF0ZU9wYWNpdHkoKSx0aGlzfSxzZXRaSW5kZXg6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3B0aW9ucy56SW5kZXg9dCx0aGlzLl91cGRhdGVaSW5kZXgoKSx0aGlzfSxpc0xvYWRpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbG9hZGluZ30scmVkcmF3OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21hcCYmKHRoaXMuX3JlbW92ZUFsbFRpbGVzKCksdGhpcy5fdXBkYXRlKCkpLHRoaXN9LGdldEV2ZW50czpmdW5jdGlvbigpe3ZhciB0PXt2aWV3cHJlcmVzZXQ6dGhpcy5faW52YWxpZGF0ZUFsbCx2aWV3cmVzZXQ6dGhpcy5fcmVzZXRWaWV3LHpvb206dGhpcy5fcmVzZXRWaWV3LG1vdmVlbmQ6dGhpcy5fb25Nb3ZlRW5kfTtyZXR1cm4gdGhpcy5vcHRpb25zLnVwZGF0ZVdoZW5JZGxlfHwodGhpcy5fb25Nb3ZlfHwodGhpcy5fb25Nb3ZlPW8uVXRpbC50aHJvdHRsZSh0aGlzLl9vbk1vdmVFbmQsdGhpcy5vcHRpb25zLnVwZGF0ZUludGVydmFsLHRoaXMpKSx0Lm1vdmU9dGhpcy5fb25Nb3ZlKSx0aGlzLl96b29tQW5pbWF0ZWQmJih0Lnpvb21hbmltPXRoaXMuX2FuaW1hdGVab29tKSx0fSxjcmVhdGVUaWxlOmZ1bmN0aW9uKCl7cmV0dXJuIGUuY3JlYXRlRWxlbWVudChcImRpdlwiKX0sZ2V0VGlsZVNpemU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMudGlsZVNpemU7cmV0dXJuIHQgaW5zdGFuY2VvZiBvLlBvaW50P3Q6bmV3IG8uUG9pbnQodCx0KX0sX3VwZGF0ZVpJbmRleDpmdW5jdGlvbigpe3RoaXMuX2NvbnRhaW5lciYmdGhpcy5vcHRpb25zLnpJbmRleCE9PWkmJm51bGwhPT10aGlzLm9wdGlvbnMuekluZGV4JiYodGhpcy5fY29udGFpbmVyLnN0eWxlLnpJbmRleD10aGlzLm9wdGlvbnMuekluZGV4KX0sX3NldEF1dG9aSW5kZXg6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9dGhpcy5nZXRQYW5lKCkuY2hpbGRyZW4sbj0tdCgtKDEvMCksMS8wKSxvPTAscz1pLmxlbmd0aDtvPHM7bysrKWU9aVtvXS5zdHlsZS56SW5kZXgsaVtvXSE9PXRoaXMuX2NvbnRhaW5lciYmZSYmKG49dChuLCtlKSk7aXNGaW5pdGUobikmJih0aGlzLm9wdGlvbnMuekluZGV4PW4rdCgtMSwxKSx0aGlzLl91cGRhdGVaSW5kZXgoKSl9LF91cGRhdGVPcGFjaXR5OmZ1bmN0aW9uKCl7aWYodGhpcy5fbWFwJiYhby5Ccm93c2VyLmllbHQ5KXtvLkRvbVV0aWwuc2V0T3BhY2l0eSh0aGlzLl9jb250YWluZXIsdGhpcy5vcHRpb25zLm9wYWNpdHkpO3ZhciB0PStuZXcgRGF0ZSxlPSExLGk9ITE7Zm9yKHZhciBuIGluIHRoaXMuX3RpbGVzKXt2YXIgcz10aGlzLl90aWxlc1tuXTtpZihzLmN1cnJlbnQmJnMubG9hZGVkKXt2YXIgcj1NYXRoLm1pbigxLCh0LXMubG9hZGVkKS8yMDApO28uRG9tVXRpbC5zZXRPcGFjaXR5KHMuZWwscikscjwxP2U9ITA6KHMuYWN0aXZlJiYoaT0hMCkscy5hY3RpdmU9ITApfX1pJiYhdGhpcy5fbm9QcnVuZSYmdGhpcy5fcHJ1bmVUaWxlcygpLGUmJihvLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2ZhZGVGcmFtZSksdGhpcy5fZmFkZUZyYW1lPW8uVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKHRoaXMuX3VwZGF0ZU9wYWNpdHksdGhpcykpfX0sX2luaXRDb250YWluZXI6ZnVuY3Rpb24oKXt0aGlzLl9jb250YWluZXJ8fCh0aGlzLl9jb250YWluZXI9by5Eb21VdGlsLmNyZWF0ZShcImRpdlwiLFwibGVhZmxldC1sYXllciBcIisodGhpcy5vcHRpb25zLmNsYXNzTmFtZXx8XCJcIikpLHRoaXMuX3VwZGF0ZVpJbmRleCgpLHRoaXMub3B0aW9ucy5vcGFjaXR5PDEmJnRoaXMuX3VwZGF0ZU9wYWNpdHkoKSx0aGlzLmdldFBhbmUoKS5hcHBlbmRDaGlsZCh0aGlzLl9jb250YWluZXIpKX0sX3VwZGF0ZUxldmVsczpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3RpbGVab29tLGU9dGhpcy5vcHRpb25zLm1heFpvb207aWYodD09PWkpcmV0dXJuIGk7Zm9yKHZhciBuIGluIHRoaXMuX2xldmVscyl0aGlzLl9sZXZlbHNbbl0uZWwuY2hpbGRyZW4ubGVuZ3RofHxuPT09dD90aGlzLl9sZXZlbHNbbl0uZWwuc3R5bGUuekluZGV4PWUtTWF0aC5hYnModC1uKTooby5Eb21VdGlsLnJlbW92ZSh0aGlzLl9sZXZlbHNbbl0uZWwpLHRoaXMuX3JlbW92ZVRpbGVzQXRab29tKG4pLGRlbGV0ZSB0aGlzLl9sZXZlbHNbbl0pO3ZhciBzPXRoaXMuX2xldmVsc1t0XSxyPXRoaXMuX21hcDtyZXR1cm4gc3x8KHM9dGhpcy5fbGV2ZWxzW3RdPXt9LHMuZWw9by5Eb21VdGlsLmNyZWF0ZShcImRpdlwiLFwibGVhZmxldC10aWxlLWNvbnRhaW5lciBsZWFmbGV0LXpvb20tYW5pbWF0ZWRcIix0aGlzLl9jb250YWluZXIpLHMuZWwuc3R5bGUuekluZGV4PWUscy5vcmlnaW49ci5wcm9qZWN0KHIudW5wcm9qZWN0KHIuZ2V0UGl4ZWxPcmlnaW4oKSksdCkucm91bmQoKSxzLnpvb209dCx0aGlzLl9zZXRab29tVHJhbnNmb3JtKHMsci5nZXRDZW50ZXIoKSxyLmdldFpvb20oKSksby5VdGlsLmZhbHNlRm4ocy5lbC5vZmZzZXRXaWR0aCkpLHRoaXMuX2xldmVsPXMsc30sX3BydW5lVGlsZXM6ZnVuY3Rpb24oKXtpZih0aGlzLl9tYXApe3ZhciB0LGUsaT10aGlzLl9tYXAuZ2V0Wm9vbSgpO2lmKGk+dGhpcy5vcHRpb25zLm1heFpvb218fGk8dGhpcy5vcHRpb25zLm1pblpvb20pcmV0dXJuIHZvaWQgdGhpcy5fcmVtb3ZlQWxsVGlsZXMoKTtmb3IodCBpbiB0aGlzLl90aWxlcyllPXRoaXMuX3RpbGVzW3RdLGUucmV0YWluPWUuY3VycmVudDtmb3IodCBpbiB0aGlzLl90aWxlcylpZihlPXRoaXMuX3RpbGVzW3RdLGUuY3VycmVudCYmIWUuYWN0aXZlKXt2YXIgbj1lLmNvb3Jkczt0aGlzLl9yZXRhaW5QYXJlbnQobi54LG4ueSxuLnosbi56LTUpfHx0aGlzLl9yZXRhaW5DaGlsZHJlbihuLngsbi55LG4ueixuLnorMil9Zm9yKHQgaW4gdGhpcy5fdGlsZXMpdGhpcy5fdGlsZXNbdF0ucmV0YWlufHx0aGlzLl9yZW1vdmVUaWxlKHQpfX0sX3JlbW92ZVRpbGVzQXRab29tOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0aGlzLl90aWxlcyl0aGlzLl90aWxlc1tlXS5jb29yZHMuej09PXQmJnRoaXMuX3JlbW92ZVRpbGUoZSl9LF9yZW1vdmVBbGxUaWxlczpmdW5jdGlvbigpe2Zvcih2YXIgdCBpbiB0aGlzLl90aWxlcyl0aGlzLl9yZW1vdmVUaWxlKHQpfSxfaW52YWxpZGF0ZUFsbDpmdW5jdGlvbigpe2Zvcih2YXIgdCBpbiB0aGlzLl9sZXZlbHMpby5Eb21VdGlsLnJlbW92ZSh0aGlzLl9sZXZlbHNbdF0uZWwpLGRlbGV0ZSB0aGlzLl9sZXZlbHNbdF07dGhpcy5fcmVtb3ZlQWxsVGlsZXMoKSx0aGlzLl90aWxlWm9vbT1udWxsfSxfcmV0YWluUGFyZW50OmZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBzPU1hdGguZmxvb3IodC8yKSxyPU1hdGguZmxvb3IoZS8yKSxhPWktMSxoPW5ldyBvLlBvaW50KCtzLCtyKTtoLno9K2E7dmFyIGw9dGhpcy5fdGlsZUNvb3Jkc1RvS2V5KGgpLHU9dGhpcy5fdGlsZXNbbF07cmV0dXJuIHUmJnUuYWN0aXZlPyh1LnJldGFpbj0hMCwhMCk6KHUmJnUubG9hZGVkJiYodS5yZXRhaW49ITApLGE+biYmdGhpcy5fcmV0YWluUGFyZW50KHMscixhLG4pKX0sX3JldGFpbkNoaWxkcmVuOmZ1bmN0aW9uKHQsZSxpLG4pe2Zvcih2YXIgcz0yKnQ7czwyKnQrMjtzKyspZm9yKHZhciByPTIqZTtyPDIqZSsyO3IrKyl7dmFyIGE9bmV3IG8uUG9pbnQocyxyKTthLno9aSsxO3ZhciBoPXRoaXMuX3RpbGVDb29yZHNUb0tleShhKSxsPXRoaXMuX3RpbGVzW2hdO2wmJmwuYWN0aXZlP2wucmV0YWluPSEwOihsJiZsLmxvYWRlZCYmKGwucmV0YWluPSEwKSxpKzE8biYmdGhpcy5fcmV0YWluQ2hpbGRyZW4ocyxyLGkrMSxuKSl9fSxfcmVzZXRWaWV3OmZ1bmN0aW9uKHQpe3ZhciBlPXQmJih0LnBpbmNofHx0LmZseVRvKTt0aGlzLl9zZXRWaWV3KHRoaXMuX21hcC5nZXRDZW50ZXIoKSx0aGlzLl9tYXAuZ2V0Wm9vbSgpLGUsZSl9LF9hbmltYXRlWm9vbTpmdW5jdGlvbih0KXt0aGlzLl9zZXRWaWV3KHQuY2VudGVyLHQuem9vbSwhMCx0Lm5vVXBkYXRlKX0sX3NldFZpZXc6ZnVuY3Rpb24odCxlLG4sbyl7dmFyIHM9TWF0aC5yb3VuZChlKTsodGhpcy5vcHRpb25zLm1heFpvb20hPT1pJiZzPnRoaXMub3B0aW9ucy5tYXhab29tfHx0aGlzLm9wdGlvbnMubWluWm9vbSE9PWkmJnM8dGhpcy5vcHRpb25zLm1pblpvb20pJiYocz1pKTt2YXIgcj10aGlzLm9wdGlvbnMudXBkYXRlV2hlblpvb21pbmcmJnMhPT10aGlzLl90aWxlWm9vbTtvJiYhcnx8KHRoaXMuX3RpbGVab29tPXMsdGhpcy5fYWJvcnRMb2FkaW5nJiZ0aGlzLl9hYm9ydExvYWRpbmcoKSx0aGlzLl91cGRhdGVMZXZlbHMoKSx0aGlzLl9yZXNldEdyaWQoKSxzIT09aSYmdGhpcy5fdXBkYXRlKHQpLG58fHRoaXMuX3BydW5lVGlsZXMoKSx0aGlzLl9ub1BydW5lPSEhbiksdGhpcy5fc2V0Wm9vbVRyYW5zZm9ybXModCxlKX0sX3NldFpvb21UcmFuc2Zvcm1zOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpIGluIHRoaXMuX2xldmVscyl0aGlzLl9zZXRab29tVHJhbnNmb3JtKHRoaXMuX2xldmVsc1tpXSx0LGUpfSxfc2V0Wm9vbVRyYW5zZm9ybTpmdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy5fbWFwLmdldFpvb21TY2FsZShpLHQuem9vbSkscz10Lm9yaWdpbi5tdWx0aXBseUJ5KG4pLnN1YnRyYWN0KHRoaXMuX21hcC5fZ2V0TmV3UGl4ZWxPcmlnaW4oZSxpKSkucm91bmQoKTtvLkJyb3dzZXIuYW55M2Q/by5Eb21VdGlsLnNldFRyYW5zZm9ybSh0LmVsLHMsbik6by5Eb21VdGlsLnNldFBvc2l0aW9uKHQuZWwscyl9LF9yZXNldEdyaWQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9tYXAsZT10Lm9wdGlvbnMuY3JzLGk9dGhpcy5fdGlsZVNpemU9dGhpcy5nZXRUaWxlU2l6ZSgpLG49dGhpcy5fdGlsZVpvb20sbz10aGlzLl9tYXAuZ2V0UGl4ZWxXb3JsZEJvdW5kcyh0aGlzLl90aWxlWm9vbSk7byYmKHRoaXMuX2dsb2JhbFRpbGVSYW5nZT10aGlzLl9weEJvdW5kc1RvVGlsZVJhbmdlKG8pKSx0aGlzLl93cmFwWD1lLndyYXBMbmcmJiF0aGlzLm9wdGlvbnMubm9XcmFwJiZbTWF0aC5mbG9vcih0LnByb2plY3QoWzAsZS53cmFwTG5nWzBdXSxuKS54L2kueCksTWF0aC5jZWlsKHQucHJvamVjdChbMCxlLndyYXBMbmdbMV1dLG4pLngvaS55KV0sdGhpcy5fd3JhcFk9ZS53cmFwTGF0JiYhdGhpcy5vcHRpb25zLm5vV3JhcCYmW01hdGguZmxvb3IodC5wcm9qZWN0KFtlLndyYXBMYXRbMF0sMF0sbikueS9pLngpLE1hdGguY2VpbCh0LnByb2plY3QoW2Uud3JhcExhdFsxXSwwXSxuKS55L2kueSldfSxfb25Nb3ZlRW5kOmZ1bmN0aW9uKCl7dGhpcy5fbWFwJiYhdGhpcy5fbWFwLl9hbmltYXRpbmdab29tJiZ0aGlzLl91cGRhdGUoKX0sX2dldFRpbGVkUGl4ZWxCb3VuZHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fbWFwLGk9ZS5fYW5pbWF0aW5nWm9vbT9NYXRoLm1heChlLl9hbmltYXRlVG9ab29tLGUuZ2V0Wm9vbSgpKTplLmdldFpvb20oKSxuPWUuZ2V0Wm9vbVNjYWxlKGksdGhpcy5fdGlsZVpvb20pLHM9ZS5wcm9qZWN0KHQsdGhpcy5fdGlsZVpvb20pLmZsb29yKCkscj1lLmdldFNpemUoKS5kaXZpZGVCeSgyKm4pO3JldHVybiBuZXcgby5Cb3VuZHMocy5zdWJ0cmFjdChyKSxzLmFkZChyKSl9LF91cGRhdGU6ZnVuY3Rpb24odCl7dmFyIG49dGhpcy5fbWFwO2lmKG4pe3ZhciBzPW4uZ2V0Wm9vbSgpO2lmKHQ9PT1pJiYodD1uLmdldENlbnRlcigpKSx0aGlzLl90aWxlWm9vbSE9PWkpe3ZhciByPXRoaXMuX2dldFRpbGVkUGl4ZWxCb3VuZHModCksYT10aGlzLl9weEJvdW5kc1RvVGlsZVJhbmdlKHIpLGg9YS5nZXRDZW50ZXIoKSxsPVtdLHU9dGhpcy5vcHRpb25zLmtlZXBCdWZmZXIsYz1uZXcgby5Cb3VuZHMoYS5nZXRCb3R0b21MZWZ0KCkuc3VidHJhY3QoW3UsLXVdKSxhLmdldFRvcFJpZ2h0KCkuYWRkKFt1LC11XSkpO2Zvcih2YXIgZCBpbiB0aGlzLl90aWxlcyl7dmFyIF89dGhpcy5fdGlsZXNbZF0uY29vcmRzO18uej09PXRoaXMuX3RpbGVab29tJiZjLmNvbnRhaW5zKG8ucG9pbnQoXy54LF8ueSkpfHwodGhpcy5fdGlsZXNbZF0uY3VycmVudD0hMSl9aWYoTWF0aC5hYnMocy10aGlzLl90aWxlWm9vbSk+MSlyZXR1cm4gdm9pZCB0aGlzLl9zZXRWaWV3KHQscyk7Zm9yKHZhciBtPWEubWluLnk7bTw9YS5tYXgueTttKyspZm9yKHZhciBwPWEubWluLng7cDw9YS5tYXgueDtwKyspe3ZhciBmPW5ldyBvLlBvaW50KHAsbSk7aWYoZi56PXRoaXMuX3RpbGVab29tLHRoaXMuX2lzVmFsaWRUaWxlKGYpKXt2YXIgZz10aGlzLl90aWxlc1t0aGlzLl90aWxlQ29vcmRzVG9LZXkoZildO2c/Zy5jdXJyZW50PSEwOmwucHVzaChmKX19aWYobC5zb3J0KGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuZGlzdGFuY2VUbyhoKS1lLmRpc3RhbmNlVG8oaCl9KSwwIT09bC5sZW5ndGgpe3RoaXMuX2xvYWRpbmd8fCh0aGlzLl9sb2FkaW5nPSEwLHRoaXMuZmlyZShcImxvYWRpbmdcIikpO3ZhciB2PWUuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO2ZvcihwPTA7cDxsLmxlbmd0aDtwKyspdGhpcy5fYWRkVGlsZShsW3BdLHYpO3RoaXMuX2xldmVsLmVsLmFwcGVuZENoaWxkKHYpfX19fSxfaXNWYWxpZFRpbGU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fbWFwLm9wdGlvbnMuY3JzO2lmKCFlLmluZmluaXRlKXt2YXIgaT10aGlzLl9nbG9iYWxUaWxlUmFuZ2U7aWYoIWUud3JhcExuZyYmKHQueDxpLm1pbi54fHx0Lng+aS5tYXgueCl8fCFlLndyYXBMYXQmJih0Lnk8aS5taW4ueXx8dC55PmkubWF4LnkpKXJldHVybiExfWlmKCF0aGlzLm9wdGlvbnMuYm91bmRzKXJldHVybiEwO3ZhciBuPXRoaXMuX3RpbGVDb29yZHNUb0JvdW5kcyh0KTtyZXR1cm4gby5sYXRMbmdCb3VuZHModGhpcy5vcHRpb25zLmJvdW5kcykub3ZlcmxhcHMobil9LF9rZXlUb0JvdW5kczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fdGlsZUNvb3Jkc1RvQm91bmRzKHRoaXMuX2tleVRvVGlsZUNvb3Jkcyh0KSl9LF90aWxlQ29vcmRzVG9Cb3VuZHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fbWFwLGk9dGhpcy5nZXRUaWxlU2l6ZSgpLG49dC5zY2FsZUJ5KGkpLHM9bi5hZGQoaSkscj1lLnVucHJvamVjdChuLHQueiksYT1lLnVucHJvamVjdChzLHQueiksaD1uZXcgby5MYXRMbmdCb3VuZHMocixhKTtyZXR1cm4gdGhpcy5vcHRpb25zLm5vV3JhcHx8ZS53cmFwTGF0TG5nQm91bmRzKGgpLGh9LF90aWxlQ29vcmRzVG9LZXk6ZnVuY3Rpb24odCl7cmV0dXJuIHQueCtcIjpcIit0LnkrXCI6XCIrdC56fSxfa2V5VG9UaWxlQ29vcmRzOmZ1bmN0aW9uKHQpe3ZhciBlPXQuc3BsaXQoXCI6XCIpLGk9bmV3IG8uUG9pbnQoK2VbMF0sK2VbMV0pO3JldHVybiBpLno9K2VbMl0saX0sX3JlbW92ZVRpbGU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fdGlsZXNbdF07ZSYmKG8uRG9tVXRpbC5yZW1vdmUoZS5lbCksZGVsZXRlIHRoaXMuX3RpbGVzW3RdLHRoaXMuZmlyZShcInRpbGV1bmxvYWRcIix7dGlsZTplLmVsLGNvb3Jkczp0aGlzLl9rZXlUb1RpbGVDb29yZHModCl9KSl9LF9pbml0VGlsZTpmdW5jdGlvbih0KXtvLkRvbVV0aWwuYWRkQ2xhc3ModCxcImxlYWZsZXQtdGlsZVwiKTt2YXIgZT10aGlzLmdldFRpbGVTaXplKCk7dC5zdHlsZS53aWR0aD1lLngrXCJweFwiLHQuc3R5bGUuaGVpZ2h0PWUueStcInB4XCIsdC5vbnNlbGVjdHN0YXJ0PW8uVXRpbC5mYWxzZUZuLHQub25tb3VzZW1vdmU9by5VdGlsLmZhbHNlRm4sby5Ccm93c2VyLmllbHQ5JiZ0aGlzLm9wdGlvbnMub3BhY2l0eTwxJiZvLkRvbVV0aWwuc2V0T3BhY2l0eSh0LHRoaXMub3B0aW9ucy5vcGFjaXR5KSxvLkJyb3dzZXIuYW5kcm9pZCYmIW8uQnJvd3Nlci5hbmRyb2lkMjMmJih0LnN0eWxlLldlYmtpdEJhY2tmYWNlVmlzaWJpbGl0eT1cImhpZGRlblwiKX0sX2FkZFRpbGU6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLl9nZXRUaWxlUG9zKHQpLG49dGhpcy5fdGlsZUNvb3Jkc1RvS2V5KHQpLHM9dGhpcy5jcmVhdGVUaWxlKHRoaXMuX3dyYXBDb29yZHModCksby5iaW5kKHRoaXMuX3RpbGVSZWFkeSx0aGlzLHQpKTt0aGlzLl9pbml0VGlsZShzKSx0aGlzLmNyZWF0ZVRpbGUubGVuZ3RoPDImJm8uVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKG8uYmluZCh0aGlzLl90aWxlUmVhZHksdGhpcyx0LG51bGwscykpLG8uRG9tVXRpbC5zZXRQb3NpdGlvbihzLGkpLHRoaXMuX3RpbGVzW25dPXtlbDpzLGNvb3Jkczp0LGN1cnJlbnQ6ITB9LGUuYXBwZW5kQ2hpbGQocyksdGhpcy5maXJlKFwidGlsZWxvYWRzdGFydFwiLHt0aWxlOnMsY29vcmRzOnR9KX0sX3RpbGVSZWFkeTpmdW5jdGlvbih0LGUsaSl7aWYodGhpcy5fbWFwKXtlJiZ0aGlzLmZpcmUoXCJ0aWxlZXJyb3JcIix7ZXJyb3I6ZSx0aWxlOmksY29vcmRzOnR9KTt2YXIgbj10aGlzLl90aWxlQ29vcmRzVG9LZXkodCk7aT10aGlzLl90aWxlc1tuXSxpJiYoaS5sb2FkZWQ9K25ldyBEYXRlLHRoaXMuX21hcC5fZmFkZUFuaW1hdGVkPyhvLkRvbVV0aWwuc2V0T3BhY2l0eShpLmVsLDApLG8uVXRpbC5jYW5jZWxBbmltRnJhbWUodGhpcy5fZmFkZUZyYW1lKSx0aGlzLl9mYWRlRnJhbWU9by5VdGlsLnJlcXVlc3RBbmltRnJhbWUodGhpcy5fdXBkYXRlT3BhY2l0eSx0aGlzKSk6KGkuYWN0aXZlPSEwLHRoaXMuX3BydW5lVGlsZXMoKSksZXx8KG8uRG9tVXRpbC5hZGRDbGFzcyhpLmVsLFwibGVhZmxldC10aWxlLWxvYWRlZFwiKSx0aGlzLmZpcmUoXCJ0aWxlbG9hZFwiLHt0aWxlOmkuZWwsY29vcmRzOnR9KSksdGhpcy5fbm9UaWxlc1RvTG9hZCgpJiYodGhpcy5fbG9hZGluZz0hMSx0aGlzLmZpcmUoXCJsb2FkXCIpLG8uQnJvd3Nlci5pZWx0OXx8IXRoaXMuX21hcC5fZmFkZUFuaW1hdGVkP28uVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKHRoaXMuX3BydW5lVGlsZXMsdGhpcyk6c2V0VGltZW91dChvLmJpbmQodGhpcy5fcHJ1bmVUaWxlcyx0aGlzKSwyNTApKSl9fSxfZ2V0VGlsZVBvczpmdW5jdGlvbih0KXtyZXR1cm4gdC5zY2FsZUJ5KHRoaXMuZ2V0VGlsZVNpemUoKSkuc3VidHJhY3QodGhpcy5fbGV2ZWwub3JpZ2luKX0sX3dyYXBDb29yZHM6ZnVuY3Rpb24odCl7dmFyIGU9bmV3IG8uUG9pbnQodGhpcy5fd3JhcFg/by5VdGlsLndyYXBOdW0odC54LHRoaXMuX3dyYXBYKTp0LngsdGhpcy5fd3JhcFk/by5VdGlsLndyYXBOdW0odC55LHRoaXMuX3dyYXBZKTp0LnkpO3JldHVybiBlLno9dC56LGV9LF9weEJvdW5kc1RvVGlsZVJhbmdlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0VGlsZVNpemUoKTtyZXR1cm4gbmV3IG8uQm91bmRzKHQubWluLnVuc2NhbGVCeShlKS5mbG9vcigpLHQubWF4LnVuc2NhbGVCeShlKS5jZWlsKCkuc3VidHJhY3QoWzEsMV0pKX0sX25vVGlsZXNUb0xvYWQ6ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW4gdGhpcy5fdGlsZXMpaWYoIXRoaXMuX3RpbGVzW3RdLmxvYWRlZClyZXR1cm4hMTtyZXR1cm4hMH19KSxvLmdyaWRMYXllcj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8uR3JpZExheWVyKHQpfSxvLlRpbGVMYXllcj1vLkdyaWRMYXllci5leHRlbmQoe29wdGlvbnM6e21pblpvb206MCxtYXhab29tOjE4LG1heE5hdGl2ZVpvb206bnVsbCxtaW5OYXRpdmVab29tOm51bGwsc3ViZG9tYWluczpcImFiY1wiLGVycm9yVGlsZVVybDpcIlwiLHpvb21PZmZzZXQ6MCx0bXM6ITEsem9vbVJldmVyc2U6ITEsZGV0ZWN0UmV0aW5hOiExLGNyb3NzT3JpZ2luOiExfSxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7dGhpcy5fdXJsPXQsZT1vLnNldE9wdGlvbnModGhpcyxlKSxlLmRldGVjdFJldGluYSYmby5Ccm93c2VyLnJldGluYSYmZS5tYXhab29tPjAmJihlLnRpbGVTaXplPU1hdGguZmxvb3IoZS50aWxlU2l6ZS8yKSxlLnpvb21SZXZlcnNlPyhlLnpvb21PZmZzZXQtLSxlLm1pblpvb20rKyk6KGUuem9vbU9mZnNldCsrLGUubWF4Wm9vbS0tKSxlLm1pblpvb209TWF0aC5tYXgoMCxlLm1pblpvb20pKSxcInN0cmluZ1wiPT10eXBlb2YgZS5zdWJkb21haW5zJiYoZS5zdWJkb21haW5zPWUuc3ViZG9tYWlucy5zcGxpdChcIlwiKSksby5Ccm93c2VyLmFuZHJvaWR8fHRoaXMub24oXCJ0aWxldW5sb2FkXCIsdGhpcy5fb25UaWxlUmVtb3ZlKX0sc2V0VXJsOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX3VybD10LGV8fHRoaXMucmVkcmF3KCksdGhpc30sY3JlYXRlVGlsZTpmdW5jdGlvbih0LGkpe3ZhciBuPWUuY3JlYXRlRWxlbWVudChcImltZ1wiKTtyZXR1cm4gby5Eb21FdmVudC5vbihuLFwibG9hZFwiLG8uYmluZCh0aGlzLl90aWxlT25Mb2FkLHRoaXMsaSxuKSksby5Eb21FdmVudC5vbihuLFwiZXJyb3JcIixvLmJpbmQodGhpcy5fdGlsZU9uRXJyb3IsdGhpcyxpLG4pKSx0aGlzLm9wdGlvbnMuY3Jvc3NPcmlnaW4mJihuLmNyb3NzT3JpZ2luPVwiXCIpLG4uYWx0PVwiXCIsbi5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJwcmVzZW50YXRpb25cIiksbi5zcmM9dGhpcy5nZXRUaWxlVXJsKHQpLG59LGdldFRpbGVVcmw6ZnVuY3Rpb24odCl7dmFyIGU9e3I6by5Ccm93c2VyLnJldGluYT9cIkAyeFwiOlwiXCIsczp0aGlzLl9nZXRTdWJkb21haW4odCkseDp0LngseTp0Lnksejp0aGlzLl9nZXRab29tRm9yVXJsKCl9O2lmKHRoaXMuX21hcCYmIXRoaXMuX21hcC5vcHRpb25zLmNycy5pbmZpbml0ZSl7dmFyIGk9dGhpcy5fZ2xvYmFsVGlsZVJhbmdlLm1heC55LXQueTt0aGlzLm9wdGlvbnMudG1zJiYoZS55PWkpLGVbXCIteVwiXT1pfXJldHVybiBvLlV0aWwudGVtcGxhdGUodGhpcy5fdXJsLG8uZXh0ZW5kKGUsdGhpcy5vcHRpb25zKSl9LF90aWxlT25Mb2FkOmZ1bmN0aW9uKHQsZSl7by5Ccm93c2VyLmllbHQ5P3NldFRpbWVvdXQoby5iaW5kKHQsdGhpcyxudWxsLGUpLDApOnQobnVsbCxlKX0sX3RpbGVPbkVycm9yOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLm9wdGlvbnMuZXJyb3JUaWxlVXJsO24mJmUuc3JjIT09biYmKGUuc3JjPW4pLHQoaSxlKX0sZ2V0VGlsZVNpemU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9tYXAsZT1vLkdyaWRMYXllci5wcm90b3R5cGUuZ2V0VGlsZVNpemUuY2FsbCh0aGlzKSxpPXRoaXMuX3RpbGVab29tK3RoaXMub3B0aW9ucy56b29tT2Zmc2V0LG49dGhpcy5vcHRpb25zLm1pbk5hdGl2ZVpvb20scz10aGlzLm9wdGlvbnMubWF4TmF0aXZlWm9vbTtyZXR1cm4gbnVsbCE9PW4mJmk8bj9lLmRpdmlkZUJ5KHQuZ2V0Wm9vbVNjYWxlKG4saSkpLnJvdW5kKCk6bnVsbCE9PXMmJmk+cz9lLmRpdmlkZUJ5KHQuZ2V0Wm9vbVNjYWxlKHMsaSkpLnJvdW5kKCk6ZX0sX29uVGlsZVJlbW92ZTpmdW5jdGlvbih0KXt0LnRpbGUub25sb2FkPW51bGx9LF9nZXRab29tRm9yVXJsOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fdGlsZVpvb20sZT10aGlzLm9wdGlvbnMubWF4Wm9vbSxpPXRoaXMub3B0aW9ucy56b29tUmV2ZXJzZSxuPXRoaXMub3B0aW9ucy56b29tT2Zmc2V0LG89dGhpcy5vcHRpb25zLm1pbk5hdGl2ZVpvb20scz10aGlzLm9wdGlvbnMubWF4TmF0aXZlWm9vbTtyZXR1cm4gaSYmKHQ9ZS10KSx0Kz1uLG51bGwhPT1vJiZ0PG8/bzpudWxsIT09cyYmdD5zP3M6dH0sX2dldFN1YmRvbWFpbjpmdW5jdGlvbih0KXt2YXIgZT1NYXRoLmFicyh0LngrdC55KSV0aGlzLm9wdGlvbnMuc3ViZG9tYWlucy5sZW5ndGg7cmV0dXJuIHRoaXMub3B0aW9ucy5zdWJkb21haW5zW2VdfSxfYWJvcnRMb2FkaW5nOmZ1bmN0aW9uKCl7dmFyIHQsZTtmb3IodCBpbiB0aGlzLl90aWxlcyl0aGlzLl90aWxlc1t0XS5jb29yZHMueiE9PXRoaXMuX3RpbGVab29tJiYoZT10aGlzLl90aWxlc1t0XS5lbCxlLm9ubG9hZD1vLlV0aWwuZmFsc2VGbixlLm9uZXJyb3I9by5VdGlsLmZhbHNlRm4sZS5jb21wbGV0ZXx8KGUuc3JjPW8uVXRpbC5lbXB0eUltYWdlVXJsLG8uRG9tVXRpbC5yZW1vdmUoZSkpKX19KSxvLnRpbGVMYXllcj1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgby5UaWxlTGF5ZXIodCxlKX0sby5UaWxlTGF5ZXIuV01TPW8uVGlsZUxheWVyLmV4dGVuZCh7ZGVmYXVsdFdtc1BhcmFtczp7c2VydmljZTpcIldNU1wiLHJlcXVlc3Q6XCJHZXRNYXBcIixsYXllcnM6XCJcIixzdHlsZXM6XCJcIixmb3JtYXQ6XCJpbWFnZS9qcGVnXCIsdHJhbnNwYXJlbnQ6ITEsdmVyc2lvbjpcIjEuMS4xXCJ9LG9wdGlvbnM6e2NyczpudWxsLHVwcGVyY2FzZTohMX0saW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe3RoaXMuX3VybD10O3ZhciBpPW8uZXh0ZW5kKHt9LHRoaXMuZGVmYXVsdFdtc1BhcmFtcyk7Zm9yKHZhciBuIGluIGUpbiBpbiB0aGlzLm9wdGlvbnN8fChpW25dPWVbbl0pO2U9by5zZXRPcHRpb25zKHRoaXMsZSksaS53aWR0aD1pLmhlaWdodD1lLnRpbGVTaXplKihlLmRldGVjdFJldGluYSYmby5Ccm93c2VyLnJldGluYT8yOjEpLHRoaXMud21zUGFyYW1zPWl9LG9uQWRkOmZ1bmN0aW9uKHQpe3RoaXMuX2Nycz10aGlzLm9wdGlvbnMuY3JzfHx0Lm9wdGlvbnMuY3JzLHRoaXMuX3dtc1ZlcnNpb249cGFyc2VGbG9hdCh0aGlzLndtc1BhcmFtcy52ZXJzaW9uKTt2YXIgZT10aGlzLl93bXNWZXJzaW9uPj0xLjM/XCJjcnNcIjpcInNyc1wiO3RoaXMud21zUGFyYW1zW2VdPXRoaXMuX2Nycy5jb2RlLG8uVGlsZUxheWVyLnByb3RvdHlwZS5vbkFkZC5jYWxsKHRoaXMsdCl9LGdldFRpbGVVcmw6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fdGlsZUNvb3Jkc1RvQm91bmRzKHQpLGk9dGhpcy5fY3JzLnByb2plY3QoZS5nZXROb3J0aFdlc3QoKSksbj10aGlzLl9jcnMucHJvamVjdChlLmdldFNvdXRoRWFzdCgpKSxzPSh0aGlzLl93bXNWZXJzaW9uPj0xLjMmJnRoaXMuX2Nycz09PW8uQ1JTLkVQU0c0MzI2P1tuLnksaS54LGkueSxuLnhdOltpLngsbi55LG4ueCxpLnldKS5qb2luKFwiLFwiKSxyPW8uVGlsZUxheWVyLnByb3RvdHlwZS5nZXRUaWxlVXJsLmNhbGwodGhpcyx0KTtyZXR1cm4gcitvLlV0aWwuZ2V0UGFyYW1TdHJpbmcodGhpcy53bXNQYXJhbXMscix0aGlzLm9wdGlvbnMudXBwZXJjYXNlKSsodGhpcy5vcHRpb25zLnVwcGVyY2FzZT9cIiZCQk9YPVwiOlwiJmJib3g9XCIpK3N9LHNldFBhcmFtczpmdW5jdGlvbih0LGUpe3JldHVybiBvLmV4dGVuZCh0aGlzLndtc1BhcmFtcyx0KSxlfHx0aGlzLnJlZHJhdygpLHRoaXN9fSksby50aWxlTGF5ZXIud21zPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBvLlRpbGVMYXllci5XTVModCxlKX0sby5JbWFnZU92ZXJsYXk9by5MYXllci5leHRlbmQoe29wdGlvbnM6e29wYWNpdHk6MSxhbHQ6XCJcIixpbnRlcmFjdGl2ZTohMSxjcm9zc09yaWdpbjohMX0saW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUsaSl7dGhpcy5fdXJsPXQsdGhpcy5fYm91bmRzPW8ubGF0TG5nQm91bmRzKGUpLG8uc2V0T3B0aW9ucyh0aGlzLGkpfSxvbkFkZDpmdW5jdGlvbigpe3RoaXMuX2ltYWdlfHwodGhpcy5faW5pdEltYWdlKCksdGhpcy5vcHRpb25zLm9wYWNpdHk8MSYmdGhpcy5fdXBkYXRlT3BhY2l0eSgpKSx0aGlzLm9wdGlvbnMuaW50ZXJhY3RpdmUmJihvLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5faW1hZ2UsXCJsZWFmbGV0LWludGVyYWN0aXZlXCIpLHRoaXMuYWRkSW50ZXJhY3RpdmVUYXJnZXQodGhpcy5faW1hZ2UpKSx0aGlzLmdldFBhbmUoKS5hcHBlbmRDaGlsZCh0aGlzLl9pbWFnZSksdGhpcy5fcmVzZXQoKX0sb25SZW1vdmU6ZnVuY3Rpb24oKXtvLkRvbVV0aWwucmVtb3ZlKHRoaXMuX2ltYWdlKSx0aGlzLm9wdGlvbnMuaW50ZXJhY3RpdmUmJnRoaXMucmVtb3ZlSW50ZXJhY3RpdmVUYXJnZXQodGhpcy5faW1hZ2UpfSxzZXRPcGFjaXR5OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMub3BhY2l0eT10LHRoaXMuX2ltYWdlJiZ0aGlzLl91cGRhdGVPcGFjaXR5KCksdGhpc30sc2V0U3R5bGU6ZnVuY3Rpb24odCl7cmV0dXJuIHQub3BhY2l0eSYmdGhpcy5zZXRPcGFjaXR5KHQub3BhY2l0eSksdGhpc30sYnJpbmdUb0Zyb250OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21hcCYmby5Eb21VdGlsLnRvRnJvbnQodGhpcy5faW1hZ2UpLHRoaXN9LGJyaW5nVG9CYWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21hcCYmby5Eb21VdGlsLnRvQmFjayh0aGlzLl9pbWFnZSksdGhpc30sc2V0VXJsOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl91cmw9dCx0aGlzLl9pbWFnZSYmKHRoaXMuX2ltYWdlLnNyYz10KSx0aGlzfSxzZXRCb3VuZHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2JvdW5kcz10LHRoaXMuX21hcCYmdGhpcy5fcmVzZXQoKSx0aGlzfSxnZXRFdmVudHM6ZnVuY3Rpb24oKXt2YXIgdD17em9vbTp0aGlzLl9yZXNldCx2aWV3cmVzZXQ6dGhpcy5fcmVzZXR9O3JldHVybiB0aGlzLl96b29tQW5pbWF0ZWQmJih0Lnpvb21hbmltPXRoaXMuX2FuaW1hdGVab29tKSx0fSxnZXRCb3VuZHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYm91bmRzfSxnZXRFbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ltYWdlfSxfaW5pdEltYWdlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5faW1hZ2U9by5Eb21VdGlsLmNyZWF0ZShcImltZ1wiLFwibGVhZmxldC1pbWFnZS1sYXllciBcIisodGhpcy5fem9vbUFuaW1hdGVkP1wibGVhZmxldC16b29tLWFuaW1hdGVkXCI6XCJcIikpO3Qub25zZWxlY3RzdGFydD1vLlV0aWwuZmFsc2VGbix0Lm9ubW91c2Vtb3ZlPW8uVXRpbC5mYWxzZUZuLHQub25sb2FkPW8uYmluZCh0aGlzLmZpcmUsdGhpcyxcImxvYWRcIiksdGhpcy5vcHRpb25zLmNyb3NzT3JpZ2luJiYodC5jcm9zc09yaWdpbj1cIlwiKSx0LnNyYz10aGlzLl91cmwsdC5hbHQ9dGhpcy5vcHRpb25zLmFsdH0sX2FuaW1hdGVab29tOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX21hcC5nZXRab29tU2NhbGUodC56b29tKSxpPXRoaXMuX21hcC5fbGF0TG5nQm91bmRzVG9OZXdMYXllckJvdW5kcyh0aGlzLl9ib3VuZHMsdC56b29tLHQuY2VudGVyKS5taW47XG5vLkRvbVV0aWwuc2V0VHJhbnNmb3JtKHRoaXMuX2ltYWdlLGksZSl9LF9yZXNldDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2ltYWdlLGU9bmV3IG8uQm91bmRzKHRoaXMuX21hcC5sYXRMbmdUb0xheWVyUG9pbnQodGhpcy5fYm91bmRzLmdldE5vcnRoV2VzdCgpKSx0aGlzLl9tYXAubGF0TG5nVG9MYXllclBvaW50KHRoaXMuX2JvdW5kcy5nZXRTb3V0aEVhc3QoKSkpLGk9ZS5nZXRTaXplKCk7by5Eb21VdGlsLnNldFBvc2l0aW9uKHQsZS5taW4pLHQuc3R5bGUud2lkdGg9aS54K1wicHhcIix0LnN0eWxlLmhlaWdodD1pLnkrXCJweFwifSxfdXBkYXRlT3BhY2l0eTpmdW5jdGlvbigpe28uRG9tVXRpbC5zZXRPcGFjaXR5KHRoaXMuX2ltYWdlLHRoaXMub3B0aW9ucy5vcGFjaXR5KX19KSxvLmltYWdlT3ZlcmxheT1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIG5ldyBvLkltYWdlT3ZlcmxheSh0LGUsaSl9LG8uSWNvbj1vLkNsYXNzLmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbih0KXtvLnNldE9wdGlvbnModGhpcyx0KX0sY3JlYXRlSWNvbjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fY3JlYXRlSWNvbihcImljb25cIix0KX0sY3JlYXRlU2hhZG93OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9jcmVhdGVJY29uKFwic2hhZG93XCIsdCl9LF9jcmVhdGVJY29uOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fZ2V0SWNvblVybCh0KTtpZighaSl7aWYoXCJpY29uXCI9PT10KXRocm93IG5ldyBFcnJvcihcImljb25Vcmwgbm90IHNldCBpbiBJY29uIG9wdGlvbnMgKHNlZSB0aGUgZG9jcykuXCIpO3JldHVybiBudWxsfXZhciBuPXRoaXMuX2NyZWF0ZUltZyhpLGUmJlwiSU1HXCI9PT1lLnRhZ05hbWU/ZTpudWxsKTtyZXR1cm4gdGhpcy5fc2V0SWNvblN0eWxlcyhuLHQpLG59LF9zZXRJY29uU3R5bGVzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5vcHRpb25zLG49aVtlK1wiU2l6ZVwiXTtcIm51bWJlclwiPT10eXBlb2YgbiYmKG49W24sbl0pO3ZhciBzPW8ucG9pbnQobikscj1vLnBvaW50KFwic2hhZG93XCI9PT1lJiZpLnNoYWRvd0FuY2hvcnx8aS5pY29uQW5jaG9yfHxzJiZzLmRpdmlkZUJ5KDIsITApKTt0LmNsYXNzTmFtZT1cImxlYWZsZXQtbWFya2VyLVwiK2UrXCIgXCIrKGkuY2xhc3NOYW1lfHxcIlwiKSxyJiYodC5zdHlsZS5tYXJnaW5MZWZ0PS1yLngrXCJweFwiLHQuc3R5bGUubWFyZ2luVG9wPS1yLnkrXCJweFwiKSxzJiYodC5zdHlsZS53aWR0aD1zLngrXCJweFwiLHQuc3R5bGUuaGVpZ2h0PXMueStcInB4XCIpfSxfY3JlYXRlSW1nOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIGk9aXx8ZS5jcmVhdGVFbGVtZW50KFwiaW1nXCIpLGkuc3JjPXQsaX0sX2dldEljb25Vcmw6ZnVuY3Rpb24odCl7cmV0dXJuIG8uQnJvd3Nlci5yZXRpbmEmJnRoaXMub3B0aW9uc1t0K1wiUmV0aW5hVXJsXCJdfHx0aGlzLm9wdGlvbnNbdCtcIlVybFwiXX19KSxvLmljb249ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvLkljb24odCl9LG8uSWNvbi5EZWZhdWx0PW8uSWNvbi5leHRlbmQoe29wdGlvbnM6e2ljb25Vcmw6XCJtYXJrZXItaWNvbi5wbmdcIixpY29uUmV0aW5hVXJsOlwibWFya2VyLWljb24tMngucG5nXCIsc2hhZG93VXJsOlwibWFya2VyLXNoYWRvdy5wbmdcIixpY29uU2l6ZTpbMjUsNDFdLGljb25BbmNob3I6WzEyLDQxXSxwb3B1cEFuY2hvcjpbMSwtMzRdLHRvb2x0aXBBbmNob3I6WzE2LC0yOF0sc2hhZG93U2l6ZTpbNDEsNDFdfSxfZ2V0SWNvblVybDpmdW5jdGlvbih0KXtyZXR1cm4gby5JY29uLkRlZmF1bHQuaW1hZ2VQYXRofHwoby5JY29uLkRlZmF1bHQuaW1hZ2VQYXRoPXRoaXMuX2RldGVjdEljb25QYXRoKCkpLCh0aGlzLm9wdGlvbnMuaW1hZ2VQYXRofHxvLkljb24uRGVmYXVsdC5pbWFnZVBhdGgpK28uSWNvbi5wcm90b3R5cGUuX2dldEljb25VcmwuY2FsbCh0aGlzLHQpfSxfZGV0ZWN0SWNvblBhdGg6ZnVuY3Rpb24oKXt2YXIgdD1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsXCJsZWFmbGV0LWRlZmF1bHQtaWNvbi1wYXRoXCIsZS5ib2R5KSxpPW8uRG9tVXRpbC5nZXRTdHlsZSh0LFwiYmFja2dyb3VuZC1pbWFnZVwiKXx8by5Eb21VdGlsLmdldFN0eWxlKHQsXCJiYWNrZ3JvdW5kSW1hZ2VcIik7cmV0dXJuIGUuYm9keS5yZW1vdmVDaGlsZCh0KSwwPT09aS5pbmRleE9mKFwidXJsXCIpP2kucmVwbGFjZSgvXnVybFxcKFtcXFwiXFwnXT8vLFwiXCIpLnJlcGxhY2UoL21hcmtlci1pY29uXFwucG5nW1xcXCJcXCddP1xcKSQvLFwiXCIpOlwiXCJ9fSksby5NYXJrZXI9by5MYXllci5leHRlbmQoe29wdGlvbnM6e2ljb246bmV3IG8uSWNvbi5EZWZhdWx0LGludGVyYWN0aXZlOiEwLGRyYWdnYWJsZTohMSxrZXlib2FyZDohMCx0aXRsZTpcIlwiLGFsdDpcIlwiLHpJbmRleE9mZnNldDowLG9wYWNpdHk6MSxyaXNlT25Ib3ZlcjohMSxyaXNlT2Zmc2V0OjI1MCxwYW5lOlwibWFya2VyUGFuZVwiLG5vbkJ1YmJsaW5nRXZlbnRzOltcImNsaWNrXCIsXCJkYmxjbGlja1wiLFwibW91c2VvdmVyXCIsXCJtb3VzZW91dFwiLFwiY29udGV4dG1lbnVcIl19LGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtvLnNldE9wdGlvbnModGhpcyxlKSx0aGlzLl9sYXRsbmc9by5sYXRMbmcodCl9LG9uQWRkOmZ1bmN0aW9uKHQpe3RoaXMuX3pvb21BbmltYXRlZD10aGlzLl96b29tQW5pbWF0ZWQmJnQub3B0aW9ucy5tYXJrZXJab29tQW5pbWF0aW9uLHRoaXMuX3pvb21BbmltYXRlZCYmdC5vbihcInpvb21hbmltXCIsdGhpcy5fYW5pbWF0ZVpvb20sdGhpcyksdGhpcy5faW5pdEljb24oKSx0aGlzLnVwZGF0ZSgpfSxvblJlbW92ZTpmdW5jdGlvbih0KXt0aGlzLmRyYWdnaW5nJiZ0aGlzLmRyYWdnaW5nLmVuYWJsZWQoKSYmKHRoaXMub3B0aW9ucy5kcmFnZ2FibGU9ITAsdGhpcy5kcmFnZ2luZy5yZW1vdmVIb29rcygpKSx0aGlzLl96b29tQW5pbWF0ZWQmJnQub2ZmKFwiem9vbWFuaW1cIix0aGlzLl9hbmltYXRlWm9vbSx0aGlzKSx0aGlzLl9yZW1vdmVJY29uKCksdGhpcy5fcmVtb3ZlU2hhZG93KCl9LGdldEV2ZW50czpmdW5jdGlvbigpe3JldHVybnt6b29tOnRoaXMudXBkYXRlLHZpZXdyZXNldDp0aGlzLnVwZGF0ZX19LGdldExhdExuZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sYXRsbmd9LHNldExhdExuZzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9sYXRsbmc7cmV0dXJuIHRoaXMuX2xhdGxuZz1vLmxhdExuZyh0KSx0aGlzLnVwZGF0ZSgpLHRoaXMuZmlyZShcIm1vdmVcIix7b2xkTGF0TG5nOmUsbGF0bG5nOnRoaXMuX2xhdGxuZ30pfSxzZXRaSW5kZXhPZmZzZXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3B0aW9ucy56SW5kZXhPZmZzZXQ9dCx0aGlzLnVwZGF0ZSgpfSxzZXRJY29uOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMuaWNvbj10LHRoaXMuX21hcCYmKHRoaXMuX2luaXRJY29uKCksdGhpcy51cGRhdGUoKSksdGhpcy5fcG9wdXAmJnRoaXMuYmluZFBvcHVwKHRoaXMuX3BvcHVwLHRoaXMuX3BvcHVwLm9wdGlvbnMpLHRoaXN9LGdldEVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faWNvbn0sdXBkYXRlOmZ1bmN0aW9uKCl7aWYodGhpcy5faWNvbil7dmFyIHQ9dGhpcy5fbWFwLmxhdExuZ1RvTGF5ZXJQb2ludCh0aGlzLl9sYXRsbmcpLnJvdW5kKCk7dGhpcy5fc2V0UG9zKHQpfXJldHVybiB0aGlzfSxfaW5pdEljb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMsZT1cImxlYWZsZXQtem9vbS1cIisodGhpcy5fem9vbUFuaW1hdGVkP1wiYW5pbWF0ZWRcIjpcImhpZGVcIiksaT10Lmljb24uY3JlYXRlSWNvbih0aGlzLl9pY29uKSxuPSExO2khPT10aGlzLl9pY29uJiYodGhpcy5faWNvbiYmdGhpcy5fcmVtb3ZlSWNvbigpLG49ITAsdC50aXRsZSYmKGkudGl0bGU9dC50aXRsZSksdC5hbHQmJihpLmFsdD10LmFsdCkpLG8uRG9tVXRpbC5hZGRDbGFzcyhpLGUpLHQua2V5Ym9hcmQmJihpLnRhYkluZGV4PVwiMFwiKSx0aGlzLl9pY29uPWksdC5yaXNlT25Ib3ZlciYmdGhpcy5vbih7bW91c2VvdmVyOnRoaXMuX2JyaW5nVG9Gcm9udCxtb3VzZW91dDp0aGlzLl9yZXNldFpJbmRleH0pO3ZhciBzPXQuaWNvbi5jcmVhdGVTaGFkb3codGhpcy5fc2hhZG93KSxyPSExO3MhPT10aGlzLl9zaGFkb3cmJih0aGlzLl9yZW1vdmVTaGFkb3coKSxyPSEwKSxzJiYoby5Eb21VdGlsLmFkZENsYXNzKHMsZSkscy5hbHQ9XCJcIiksdGhpcy5fc2hhZG93PXMsdC5vcGFjaXR5PDEmJnRoaXMuX3VwZGF0ZU9wYWNpdHkoKSxuJiZ0aGlzLmdldFBhbmUoKS5hcHBlbmRDaGlsZCh0aGlzLl9pY29uKSx0aGlzLl9pbml0SW50ZXJhY3Rpb24oKSxzJiZyJiZ0aGlzLmdldFBhbmUoXCJzaGFkb3dQYW5lXCIpLmFwcGVuZENoaWxkKHRoaXMuX3NoYWRvdyl9LF9yZW1vdmVJY29uOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLnJpc2VPbkhvdmVyJiZ0aGlzLm9mZih7bW91c2VvdmVyOnRoaXMuX2JyaW5nVG9Gcm9udCxtb3VzZW91dDp0aGlzLl9yZXNldFpJbmRleH0pLG8uRG9tVXRpbC5yZW1vdmUodGhpcy5faWNvbiksdGhpcy5yZW1vdmVJbnRlcmFjdGl2ZVRhcmdldCh0aGlzLl9pY29uKSx0aGlzLl9pY29uPW51bGx9LF9yZW1vdmVTaGFkb3c6ZnVuY3Rpb24oKXt0aGlzLl9zaGFkb3cmJm8uRG9tVXRpbC5yZW1vdmUodGhpcy5fc2hhZG93KSx0aGlzLl9zaGFkb3c9bnVsbH0sX3NldFBvczpmdW5jdGlvbih0KXtvLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5faWNvbix0KSx0aGlzLl9zaGFkb3cmJm8uRG9tVXRpbC5zZXRQb3NpdGlvbih0aGlzLl9zaGFkb3csdCksdGhpcy5fekluZGV4PXQueSt0aGlzLm9wdGlvbnMuekluZGV4T2Zmc2V0LHRoaXMuX3Jlc2V0WkluZGV4KCl9LF91cGRhdGVaSW5kZXg6ZnVuY3Rpb24odCl7dGhpcy5faWNvbi5zdHlsZS56SW5kZXg9dGhpcy5fekluZGV4K3R9LF9hbmltYXRlWm9vbTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9tYXAuX2xhdExuZ1RvTmV3TGF5ZXJQb2ludCh0aGlzLl9sYXRsbmcsdC56b29tLHQuY2VudGVyKS5yb3VuZCgpO3RoaXMuX3NldFBvcyhlKX0sX2luaXRJbnRlcmFjdGlvbjpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5pbnRlcmFjdGl2ZSYmKG8uRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9pY29uLFwibGVhZmxldC1pbnRlcmFjdGl2ZVwiKSx0aGlzLmFkZEludGVyYWN0aXZlVGFyZ2V0KHRoaXMuX2ljb24pLG8uSGFuZGxlci5NYXJrZXJEcmFnKSl7dmFyIHQ9dGhpcy5vcHRpb25zLmRyYWdnYWJsZTt0aGlzLmRyYWdnaW5nJiYodD10aGlzLmRyYWdnaW5nLmVuYWJsZWQoKSx0aGlzLmRyYWdnaW5nLmRpc2FibGUoKSksdGhpcy5kcmFnZ2luZz1uZXcgby5IYW5kbGVyLk1hcmtlckRyYWcodGhpcyksdCYmdGhpcy5kcmFnZ2luZy5lbmFibGUoKX19LHNldE9wYWNpdHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3B0aW9ucy5vcGFjaXR5PXQsdGhpcy5fbWFwJiZ0aGlzLl91cGRhdGVPcGFjaXR5KCksdGhpc30sX3VwZGF0ZU9wYWNpdHk6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMub3BhY2l0eTtvLkRvbVV0aWwuc2V0T3BhY2l0eSh0aGlzLl9pY29uLHQpLHRoaXMuX3NoYWRvdyYmby5Eb21VdGlsLnNldE9wYWNpdHkodGhpcy5fc2hhZG93LHQpfSxfYnJpbmdUb0Zyb250OmZ1bmN0aW9uKCl7dGhpcy5fdXBkYXRlWkluZGV4KHRoaXMub3B0aW9ucy5yaXNlT2Zmc2V0KX0sX3Jlc2V0WkluZGV4OmZ1bmN0aW9uKCl7dGhpcy5fdXBkYXRlWkluZGV4KDApfSxfZ2V0UG9wdXBBbmNob3I6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zLmljb24ub3B0aW9ucy5wb3B1cEFuY2hvcnx8WzAsMF19LF9nZXRUb29sdGlwQW5jaG9yOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5pY29uLm9wdGlvbnMudG9vbHRpcEFuY2hvcnx8WzAsMF19fSksby5tYXJrZXI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IG8uTWFya2VyKHQsZSl9LG8uRGl2SWNvbj1vLkljb24uZXh0ZW5kKHtvcHRpb25zOntpY29uU2l6ZTpbMTIsMTJdLGh0bWw6ITEsYmdQb3M6bnVsbCxjbGFzc05hbWU6XCJsZWFmbGV0LWRpdi1pY29uXCJ9LGNyZWF0ZUljb246ZnVuY3Rpb24odCl7dmFyIGk9dCYmXCJESVZcIj09PXQudGFnTmFtZT90OmUuY3JlYXRlRWxlbWVudChcImRpdlwiKSxuPXRoaXMub3B0aW9ucztpZihpLmlubmVySFRNTD1uLmh0bWwhPT0hMT9uLmh0bWw6XCJcIixuLmJnUG9zKXt2YXIgcz1vLnBvaW50KG4uYmdQb3MpO2kuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uPS1zLngrXCJweCBcIistcy55K1wicHhcIn1yZXR1cm4gdGhpcy5fc2V0SWNvblN0eWxlcyhpLFwiaWNvblwiKSxpfSxjcmVhdGVTaGFkb3c6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH19KSxvLmRpdkljb249ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvLkRpdkljb24odCl9LG8uRGl2T3ZlcmxheT1vLkxheWVyLmV4dGVuZCh7b3B0aW9uczp7b2Zmc2V0OlswLDddLGNsYXNzTmFtZTpcIlwiLHBhbmU6XCJwb3B1cFBhbmVcIn0saW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe28uc2V0T3B0aW9ucyh0aGlzLHQpLHRoaXMuX3NvdXJjZT1lfSxvbkFkZDpmdW5jdGlvbih0KXt0aGlzLl96b29tQW5pbWF0ZWQ9dC5fem9vbUFuaW1hdGVkLHRoaXMuX2NvbnRhaW5lcnx8dGhpcy5faW5pdExheW91dCgpLHQuX2ZhZGVBbmltYXRlZCYmby5Eb21VdGlsLnNldE9wYWNpdHkodGhpcy5fY29udGFpbmVyLDApLGNsZWFyVGltZW91dCh0aGlzLl9yZW1vdmVUaW1lb3V0KSx0aGlzLmdldFBhbmUoKS5hcHBlbmRDaGlsZCh0aGlzLl9jb250YWluZXIpLHRoaXMudXBkYXRlKCksdC5fZmFkZUFuaW1hdGVkJiZvLkRvbVV0aWwuc2V0T3BhY2l0eSh0aGlzLl9jb250YWluZXIsMSksdGhpcy5icmluZ1RvRnJvbnQoKX0sb25SZW1vdmU6ZnVuY3Rpb24odCl7dC5fZmFkZUFuaW1hdGVkPyhvLkRvbVV0aWwuc2V0T3BhY2l0eSh0aGlzLl9jb250YWluZXIsMCksdGhpcy5fcmVtb3ZlVGltZW91dD1zZXRUaW1lb3V0KG8uYmluZChvLkRvbVV0aWwucmVtb3ZlLG8uRG9tVXRpbCx0aGlzLl9jb250YWluZXIpLDIwMCkpOm8uRG9tVXRpbC5yZW1vdmUodGhpcy5fY29udGFpbmVyKX0sZ2V0TGF0TG5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xhdGxuZ30sc2V0TGF0TG5nOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9sYXRsbmc9by5sYXRMbmcodCksdGhpcy5fbWFwJiYodGhpcy5fdXBkYXRlUG9zaXRpb24oKSx0aGlzLl9hZGp1c3RQYW4oKSksdGhpc30sZ2V0Q29udGVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb250ZW50fSxzZXRDb250ZW50OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9jb250ZW50PXQsdGhpcy51cGRhdGUoKSx0aGlzfSxnZXRFbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnRhaW5lcn0sdXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy5fbWFwJiYodGhpcy5fY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIix0aGlzLl91cGRhdGVDb250ZW50KCksdGhpcy5fdXBkYXRlTGF5b3V0KCksdGhpcy5fdXBkYXRlUG9zaXRpb24oKSx0aGlzLl9jb250YWluZXIuc3R5bGUudmlzaWJpbGl0eT1cIlwiLHRoaXMuX2FkanVzdFBhbigpKX0sZ2V0RXZlbnRzOmZ1bmN0aW9uKCl7dmFyIHQ9e3pvb206dGhpcy5fdXBkYXRlUG9zaXRpb24sdmlld3Jlc2V0OnRoaXMuX3VwZGF0ZVBvc2l0aW9ufTtyZXR1cm4gdGhpcy5fem9vbUFuaW1hdGVkJiYodC56b29tYW5pbT10aGlzLl9hbmltYXRlWm9vbSksdH0saXNPcGVuOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLl9tYXAmJnRoaXMuX21hcC5oYXNMYXllcih0aGlzKX0sYnJpbmdUb0Zyb250OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21hcCYmby5Eb21VdGlsLnRvRnJvbnQodGhpcy5fY29udGFpbmVyKSx0aGlzfSxicmluZ1RvQmFjazpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tYXAmJm8uRG9tVXRpbC50b0JhY2sodGhpcy5fY29udGFpbmVyKSx0aGlzfSxfdXBkYXRlQ29udGVudDpmdW5jdGlvbigpe2lmKHRoaXMuX2NvbnRlbnQpe3ZhciB0PXRoaXMuX2NvbnRlbnROb2RlLGU9XCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5fY29udGVudD90aGlzLl9jb250ZW50KHRoaXMuX3NvdXJjZXx8dGhpcyk6dGhpcy5fY29udGVudDtpZihcInN0cmluZ1wiPT10eXBlb2YgZSl0LmlubmVySFRNTD1lO2Vsc2V7Zm9yKDt0Lmhhc0NoaWxkTm9kZXMoKTspdC5yZW1vdmVDaGlsZCh0LmZpcnN0Q2hpbGQpO3QuYXBwZW5kQ2hpbGQoZSl9dGhpcy5maXJlKFwiY29udGVudHVwZGF0ZVwiKX19LF91cGRhdGVQb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXMuX21hcCl7dmFyIHQ9dGhpcy5fbWFwLmxhdExuZ1RvTGF5ZXJQb2ludCh0aGlzLl9sYXRsbmcpLGU9by5wb2ludCh0aGlzLm9wdGlvbnMub2Zmc2V0KSxpPXRoaXMuX2dldEFuY2hvcigpO3RoaXMuX3pvb21BbmltYXRlZD9vLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fY29udGFpbmVyLHQuYWRkKGkpKTplPWUuYWRkKHQpLmFkZChpKTt2YXIgbj10aGlzLl9jb250YWluZXJCb3R0b209LWUueSxzPXRoaXMuX2NvbnRhaW5lckxlZnQ9LU1hdGgucm91bmQodGhpcy5fY29udGFpbmVyV2lkdGgvMikrZS54O3RoaXMuX2NvbnRhaW5lci5zdHlsZS5ib3R0b209bitcInB4XCIsdGhpcy5fY29udGFpbmVyLnN0eWxlLmxlZnQ9cytcInB4XCJ9fSxfZ2V0QW5jaG9yOmZ1bmN0aW9uKCl7cmV0dXJuWzAsMF19fSksby5Qb3B1cD1vLkRpdk92ZXJsYXkuZXh0ZW5kKHtvcHRpb25zOnttYXhXaWR0aDozMDAsbWluV2lkdGg6NTAsbWF4SGVpZ2h0Om51bGwsYXV0b1BhbjohMCxhdXRvUGFuUGFkZGluZ1RvcExlZnQ6bnVsbCxhdXRvUGFuUGFkZGluZ0JvdHRvbVJpZ2h0Om51bGwsYXV0b1BhblBhZGRpbmc6WzUsNV0sa2VlcEluVmlldzohMSxjbG9zZUJ1dHRvbjohMCxhdXRvQ2xvc2U6ITAsY2xhc3NOYW1lOlwiXCJ9LG9wZW5PbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5vcGVuUG9wdXAodGhpcyksdGhpc30sb25BZGQ6ZnVuY3Rpb24odCl7by5EaXZPdmVybGF5LnByb3RvdHlwZS5vbkFkZC5jYWxsKHRoaXMsdCksdC5maXJlKFwicG9wdXBvcGVuXCIse3BvcHVwOnRoaXN9KSx0aGlzLl9zb3VyY2UmJih0aGlzLl9zb3VyY2UuZmlyZShcInBvcHVwb3BlblwiLHtwb3B1cDp0aGlzfSwhMCksdGhpcy5fc291cmNlIGluc3RhbmNlb2Ygby5QYXRofHx0aGlzLl9zb3VyY2Uub24oXCJwcmVjbGlja1wiLG8uRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKSl9LG9uUmVtb3ZlOmZ1bmN0aW9uKHQpe28uRGl2T3ZlcmxheS5wcm90b3R5cGUub25SZW1vdmUuY2FsbCh0aGlzLHQpLHQuZmlyZShcInBvcHVwY2xvc2VcIix7cG9wdXA6dGhpc30pLHRoaXMuX3NvdXJjZSYmKHRoaXMuX3NvdXJjZS5maXJlKFwicG9wdXBjbG9zZVwiLHtwb3B1cDp0aGlzfSwhMCksdGhpcy5fc291cmNlIGluc3RhbmNlb2Ygby5QYXRofHx0aGlzLl9zb3VyY2Uub2ZmKFwicHJlY2xpY2tcIixvLkRvbUV2ZW50LnN0b3BQcm9wYWdhdGlvbikpfSxnZXRFdmVudHM6ZnVuY3Rpb24oKXt2YXIgdD1vLkRpdk92ZXJsYXkucHJvdG90eXBlLmdldEV2ZW50cy5jYWxsKHRoaXMpO3JldHVybihcImNsb3NlT25DbGlja1wiaW4gdGhpcy5vcHRpb25zP3RoaXMub3B0aW9ucy5jbG9zZU9uQ2xpY2s6dGhpcy5fbWFwLm9wdGlvbnMuY2xvc2VQb3B1cE9uQ2xpY2spJiYodC5wcmVjbGljaz10aGlzLl9jbG9zZSksdGhpcy5vcHRpb25zLmtlZXBJblZpZXcmJih0Lm1vdmVlbmQ9dGhpcy5fYWRqdXN0UGFuKSx0fSxfY2xvc2U6ZnVuY3Rpb24oKXt0aGlzLl9tYXAmJnRoaXMuX21hcC5jbG9zZVBvcHVwKHRoaXMpfSxfaW5pdExheW91dDpmdW5jdGlvbigpe3ZhciB0PVwibGVhZmxldC1wb3B1cFwiLGU9dGhpcy5fY29udGFpbmVyPW8uRG9tVXRpbC5jcmVhdGUoXCJkaXZcIix0K1wiIFwiKyh0aGlzLm9wdGlvbnMuY2xhc3NOYW1lfHxcIlwiKStcIiBsZWFmbGV0LXpvb20tYW5pbWF0ZWRcIik7aWYodGhpcy5vcHRpb25zLmNsb3NlQnV0dG9uKXt2YXIgaT10aGlzLl9jbG9zZUJ1dHRvbj1vLkRvbVV0aWwuY3JlYXRlKFwiYVwiLHQrXCItY2xvc2UtYnV0dG9uXCIsZSk7aS5ocmVmPVwiI2Nsb3NlXCIsaS5pbm5lckhUTUw9XCImIzIxNTtcIixvLkRvbUV2ZW50Lm9uKGksXCJjbGlja1wiLHRoaXMuX29uQ2xvc2VCdXR0b25DbGljayx0aGlzKX12YXIgbj10aGlzLl93cmFwcGVyPW8uRG9tVXRpbC5jcmVhdGUoXCJkaXZcIix0K1wiLWNvbnRlbnQtd3JhcHBlclwiLGUpO3RoaXMuX2NvbnRlbnROb2RlPW8uRG9tVXRpbC5jcmVhdGUoXCJkaXZcIix0K1wiLWNvbnRlbnRcIixuKSxvLkRvbUV2ZW50LmRpc2FibGVDbGlja1Byb3BhZ2F0aW9uKG4pLmRpc2FibGVTY3JvbGxQcm9wYWdhdGlvbih0aGlzLl9jb250ZW50Tm9kZSkub24obixcImNvbnRleHRtZW51XCIsby5Eb21FdmVudC5zdG9wUHJvcGFnYXRpb24pLHRoaXMuX3RpcENvbnRhaW5lcj1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsdCtcIi10aXAtY29udGFpbmVyXCIsZSksdGhpcy5fdGlwPW8uRG9tVXRpbC5jcmVhdGUoXCJkaXZcIix0K1wiLXRpcFwiLHRoaXMuX3RpcENvbnRhaW5lcil9LF91cGRhdGVMYXlvdXQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9jb250ZW50Tm9kZSxlPXQuc3R5bGU7ZS53aWR0aD1cIlwiLGUud2hpdGVTcGFjZT1cIm5vd3JhcFwiO3ZhciBpPXQub2Zmc2V0V2lkdGg7aT1NYXRoLm1pbihpLHRoaXMub3B0aW9ucy5tYXhXaWR0aCksaT1NYXRoLm1heChpLHRoaXMub3B0aW9ucy5taW5XaWR0aCksZS53aWR0aD1pKzErXCJweFwiLGUud2hpdGVTcGFjZT1cIlwiLGUuaGVpZ2h0PVwiXCI7dmFyIG49dC5vZmZzZXRIZWlnaHQscz10aGlzLm9wdGlvbnMubWF4SGVpZ2h0LHI9XCJsZWFmbGV0LXBvcHVwLXNjcm9sbGVkXCI7cyYmbj5zPyhlLmhlaWdodD1zK1wicHhcIixvLkRvbVV0aWwuYWRkQ2xhc3ModCxyKSk6by5Eb21VdGlsLnJlbW92ZUNsYXNzKHQsciksdGhpcy5fY29udGFpbmVyV2lkdGg9dGhpcy5fY29udGFpbmVyLm9mZnNldFdpZHRofSxfYW5pbWF0ZVpvb206ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fbWFwLl9sYXRMbmdUb05ld0xheWVyUG9pbnQodGhpcy5fbGF0bG5nLHQuem9vbSx0LmNlbnRlciksaT10aGlzLl9nZXRBbmNob3IoKTtvLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fY29udGFpbmVyLGUuYWRkKGkpKX0sX2FkanVzdFBhbjpmdW5jdGlvbigpe2lmKCEoIXRoaXMub3B0aW9ucy5hdXRvUGFufHx0aGlzLl9tYXAuX3BhbkFuaW0mJnRoaXMuX21hcC5fcGFuQW5pbS5faW5Qcm9ncmVzcykpe3ZhciB0PXRoaXMuX21hcCxlPXBhcnNlSW50KG8uRG9tVXRpbC5nZXRTdHlsZSh0aGlzLl9jb250YWluZXIsXCJtYXJnaW5Cb3R0b21cIiksMTApfHwwLGk9dGhpcy5fY29udGFpbmVyLm9mZnNldEhlaWdodCtlLG49dGhpcy5fY29udGFpbmVyV2lkdGgscz1uZXcgby5Qb2ludCh0aGlzLl9jb250YWluZXJMZWZ0LC1pLXRoaXMuX2NvbnRhaW5lckJvdHRvbSk7cy5fYWRkKG8uRG9tVXRpbC5nZXRQb3NpdGlvbih0aGlzLl9jb250YWluZXIpKTt2YXIgcj10LmxheWVyUG9pbnRUb0NvbnRhaW5lclBvaW50KHMpLGE9by5wb2ludCh0aGlzLm9wdGlvbnMuYXV0b1BhblBhZGRpbmcpLGg9by5wb2ludCh0aGlzLm9wdGlvbnMuYXV0b1BhblBhZGRpbmdUb3BMZWZ0fHxhKSxsPW8ucG9pbnQodGhpcy5vcHRpb25zLmF1dG9QYW5QYWRkaW5nQm90dG9tUmlnaHR8fGEpLHU9dC5nZXRTaXplKCksYz0wLGQ9MDtyLngrbitsLng+dS54JiYoYz1yLngrbi11LngrbC54KSxyLngtYy1oLng8MCYmKGM9ci54LWgueCksci55K2krbC55PnUueSYmKGQ9ci55K2ktdS55K2wueSksci55LWQtaC55PDAmJihkPXIueS1oLnkpLChjfHxkKSYmdC5maXJlKFwiYXV0b3BhbnN0YXJ0XCIpLnBhbkJ5KFtjLGRdKX19LF9vbkNsb3NlQnV0dG9uQ2xpY2s6ZnVuY3Rpb24odCl7dGhpcy5fY2xvc2UoKSxvLkRvbUV2ZW50LnN0b3AodCl9LF9nZXRBbmNob3I6ZnVuY3Rpb24oKXtyZXR1cm4gby5wb2ludCh0aGlzLl9zb3VyY2UmJnRoaXMuX3NvdXJjZS5fZ2V0UG9wdXBBbmNob3I/dGhpcy5fc291cmNlLl9nZXRQb3B1cEFuY2hvcigpOlswLDBdKX19KSxvLnBvcHVwPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBvLlBvcHVwKHQsZSl9LG8uTWFwLm1lcmdlT3B0aW9ucyh7Y2xvc2VQb3B1cE9uQ2xpY2s6ITB9KSxvLk1hcC5pbmNsdWRlKHtvcGVuUG9wdXA6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0IGluc3RhbmNlb2Ygby5Qb3B1cHx8KHQ9bmV3IG8uUG9wdXAoaSkuc2V0Q29udGVudCh0KSksZSYmdC5zZXRMYXRMbmcoZSksdGhpcy5oYXNMYXllcih0KT90aGlzOih0aGlzLl9wb3B1cCYmdGhpcy5fcG9wdXAub3B0aW9ucy5hdXRvQ2xvc2UmJnRoaXMuY2xvc2VQb3B1cCgpLHRoaXMuX3BvcHVwPXQsdGhpcy5hZGRMYXllcih0KSl9LGNsb3NlUG9wdXA6ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQhPT10aGlzLl9wb3B1cHx8KHQ9dGhpcy5fcG9wdXAsdGhpcy5fcG9wdXA9bnVsbCksdCYmdGhpcy5yZW1vdmVMYXllcih0KSx0aGlzfX0pLG8uTGF5ZXIuaW5jbHVkZSh7YmluZFBvcHVwOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQgaW5zdGFuY2VvZiBvLlBvcHVwPyhvLnNldE9wdGlvbnModCxlKSx0aGlzLl9wb3B1cD10LHQuX3NvdXJjZT10aGlzKToodGhpcy5fcG9wdXAmJiFlfHwodGhpcy5fcG9wdXA9bmV3IG8uUG9wdXAoZSx0aGlzKSksdGhpcy5fcG9wdXAuc2V0Q29udGVudCh0KSksdGhpcy5fcG9wdXBIYW5kbGVyc0FkZGVkfHwodGhpcy5vbih7Y2xpY2s6dGhpcy5fb3BlblBvcHVwLHJlbW92ZTp0aGlzLmNsb3NlUG9wdXAsbW92ZTp0aGlzLl9tb3ZlUG9wdXB9KSx0aGlzLl9wb3B1cEhhbmRsZXJzQWRkZWQ9ITApLHRoaXN9LHVuYmluZFBvcHVwOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BvcHVwJiYodGhpcy5vZmYoe2NsaWNrOnRoaXMuX29wZW5Qb3B1cCxyZW1vdmU6dGhpcy5jbG9zZVBvcHVwLG1vdmU6dGhpcy5fbW92ZVBvcHVwfSksdGhpcy5fcG9wdXBIYW5kbGVyc0FkZGVkPSExLHRoaXMuX3BvcHVwPW51bGwpLHRoaXN9LG9wZW5Qb3B1cDpmdW5jdGlvbih0LGUpe2lmKHQgaW5zdGFuY2VvZiBvLkxheWVyfHwoZT10LHQ9dGhpcyksdCBpbnN0YW5jZW9mIG8uRmVhdHVyZUdyb3VwKWZvcih2YXIgaSBpbiB0aGlzLl9sYXllcnMpe3Q9dGhpcy5fbGF5ZXJzW2ldO2JyZWFrfXJldHVybiBlfHwoZT10LmdldENlbnRlcj90LmdldENlbnRlcigpOnQuZ2V0TGF0TG5nKCkpLHRoaXMuX3BvcHVwJiZ0aGlzLl9tYXAmJih0aGlzLl9wb3B1cC5fc291cmNlPXQsdGhpcy5fcG9wdXAudXBkYXRlKCksdGhpcy5fbWFwLm9wZW5Qb3B1cCh0aGlzLl9wb3B1cCxlKSksdGhpc30sY2xvc2VQb3B1cDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb3B1cCYmdGhpcy5fcG9wdXAuX2Nsb3NlKCksdGhpc30sdG9nZ2xlUG9wdXA6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3BvcHVwJiYodGhpcy5fcG9wdXAuX21hcD90aGlzLmNsb3NlUG9wdXAoKTp0aGlzLm9wZW5Qb3B1cCh0KSksdGhpc30saXNQb3B1cE9wZW46ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuX3BvcHVwJiZ0aGlzLl9wb3B1cC5pc09wZW4oKX0sc2V0UG9wdXBDb250ZW50OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9wb3B1cCYmdGhpcy5fcG9wdXAuc2V0Q29udGVudCh0KSx0aGlzfSxnZXRQb3B1cDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb3B1cH0sX29wZW5Qb3B1cDpmdW5jdGlvbih0KXt2YXIgZT10LmxheWVyfHx0LnRhcmdldDtpZih0aGlzLl9wb3B1cCYmdGhpcy5fbWFwKXJldHVybiBvLkRvbUV2ZW50LnN0b3AodCksZSBpbnN0YW5jZW9mIG8uUGF0aD92b2lkIHRoaXMub3BlblBvcHVwKHQubGF5ZXJ8fHQudGFyZ2V0LHQubGF0bG5nKTp2b2lkKHRoaXMuX21hcC5oYXNMYXllcih0aGlzLl9wb3B1cCkmJnRoaXMuX3BvcHVwLl9zb3VyY2U9PT1lP3RoaXMuY2xvc2VQb3B1cCgpOnRoaXMub3BlblBvcHVwKGUsdC5sYXRsbmcpKX0sX21vdmVQb3B1cDpmdW5jdGlvbih0KXt0aGlzLl9wb3B1cC5zZXRMYXRMbmcodC5sYXRsbmcpfX0pLG8uVG9vbHRpcD1vLkRpdk92ZXJsYXkuZXh0ZW5kKHtvcHRpb25zOntwYW5lOlwidG9vbHRpcFBhbmVcIixvZmZzZXQ6WzAsMF0sZGlyZWN0aW9uOlwiYXV0b1wiLHBlcm1hbmVudDohMSxzdGlja3k6ITEsaW50ZXJhY3RpdmU6ITEsb3BhY2l0eTouOX0sb25BZGQ6ZnVuY3Rpb24odCl7by5EaXZPdmVybGF5LnByb3RvdHlwZS5vbkFkZC5jYWxsKHRoaXMsdCksdGhpcy5zZXRPcGFjaXR5KHRoaXMub3B0aW9ucy5vcGFjaXR5KSx0LmZpcmUoXCJ0b29sdGlwb3BlblwiLHt0b29sdGlwOnRoaXN9KSx0aGlzLl9zb3VyY2UmJnRoaXMuX3NvdXJjZS5maXJlKFwidG9vbHRpcG9wZW5cIix7dG9vbHRpcDp0aGlzfSwhMCl9LG9uUmVtb3ZlOmZ1bmN0aW9uKHQpe28uRGl2T3ZlcmxheS5wcm90b3R5cGUub25SZW1vdmUuY2FsbCh0aGlzLHQpLHQuZmlyZShcInRvb2x0aXBjbG9zZVwiLHt0b29sdGlwOnRoaXN9KSx0aGlzLl9zb3VyY2UmJnRoaXMuX3NvdXJjZS5maXJlKFwidG9vbHRpcGNsb3NlXCIse3Rvb2x0aXA6dGhpc30sITApfSxnZXRFdmVudHM6ZnVuY3Rpb24oKXt2YXIgdD1vLkRpdk92ZXJsYXkucHJvdG90eXBlLmdldEV2ZW50cy5jYWxsKHRoaXMpO3JldHVybiBvLkJyb3dzZXIudG91Y2gmJiF0aGlzLm9wdGlvbnMucGVybWFuZW50JiYodC5wcmVjbGljaz10aGlzLl9jbG9zZSksdH0sX2Nsb3NlOmZ1bmN0aW9uKCl7dGhpcy5fbWFwJiZ0aGlzLl9tYXAuY2xvc2VUb29sdGlwKHRoaXMpfSxfaW5pdExheW91dDpmdW5jdGlvbigpe3ZhciB0PVwibGVhZmxldC10b29sdGlwXCIsZT10K1wiIFwiKyh0aGlzLm9wdGlvbnMuY2xhc3NOYW1lfHxcIlwiKStcIiBsZWFmbGV0LXpvb20tXCIrKHRoaXMuX3pvb21BbmltYXRlZD9cImFuaW1hdGVkXCI6XCJoaWRlXCIpO3RoaXMuX2NvbnRlbnROb2RlPXRoaXMuX2NvbnRhaW5lcj1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsZSl9LF91cGRhdGVMYXlvdXQ6ZnVuY3Rpb24oKXt9LF9hZGp1c3RQYW46ZnVuY3Rpb24oKXt9LF9zZXRQb3NpdGlvbjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9tYXAsaT10aGlzLl9jb250YWluZXIsbj1lLmxhdExuZ1RvQ29udGFpbmVyUG9pbnQoZS5nZXRDZW50ZXIoKSkscz1lLmxheWVyUG9pbnRUb0NvbnRhaW5lclBvaW50KHQpLHI9dGhpcy5vcHRpb25zLmRpcmVjdGlvbixhPWkub2Zmc2V0V2lkdGgsaD1pLm9mZnNldEhlaWdodCxsPW8ucG9pbnQodGhpcy5vcHRpb25zLm9mZnNldCksdT10aGlzLl9nZXRBbmNob3IoKTtcInRvcFwiPT09cj90PXQuYWRkKG8ucG9pbnQoLWEvMitsLngsLWgrbC55K3UueSwhMCkpOlwiYm90dG9tXCI9PT1yP3Q9dC5zdWJ0cmFjdChvLnBvaW50KGEvMi1sLngsLWwueSwhMCkpOlwiY2VudGVyXCI9PT1yP3Q9dC5zdWJ0cmFjdChvLnBvaW50KGEvMitsLngsaC8yLXUueStsLnksITApKTpcInJpZ2h0XCI9PT1yfHxcImF1dG9cIj09PXImJnMueDxuLng/KHI9XCJyaWdodFwiLHQ9dC5hZGQoby5wb2ludChsLngrdS54LHUueS1oLzIrbC55LCEwKSkpOihyPVwibGVmdFwiLHQ9dC5zdWJ0cmFjdChvLnBvaW50KGErdS54LWwueCxoLzItdS55LWwueSwhMCkpKSxvLkRvbVV0aWwucmVtb3ZlQ2xhc3MoaSxcImxlYWZsZXQtdG9vbHRpcC1yaWdodFwiKSxvLkRvbVV0aWwucmVtb3ZlQ2xhc3MoaSxcImxlYWZsZXQtdG9vbHRpcC1sZWZ0XCIpLG8uRG9tVXRpbC5yZW1vdmVDbGFzcyhpLFwibGVhZmxldC10b29sdGlwLXRvcFwiKSxvLkRvbVV0aWwucmVtb3ZlQ2xhc3MoaSxcImxlYWZsZXQtdG9vbHRpcC1ib3R0b21cIiksby5Eb21VdGlsLmFkZENsYXNzKGksXCJsZWFmbGV0LXRvb2x0aXAtXCIrciksby5Eb21VdGlsLnNldFBvc2l0aW9uKGksdCl9LF91cGRhdGVQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX21hcC5sYXRMbmdUb0xheWVyUG9pbnQodGhpcy5fbGF0bG5nKTt0aGlzLl9zZXRQb3NpdGlvbih0KX0sc2V0T3BhY2l0eTpmdW5jdGlvbih0KXt0aGlzLm9wdGlvbnMub3BhY2l0eT10LHRoaXMuX2NvbnRhaW5lciYmby5Eb21VdGlsLnNldE9wYWNpdHkodGhpcy5fY29udGFpbmVyLHQpfSxfYW5pbWF0ZVpvb206ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fbWFwLl9sYXRMbmdUb05ld0xheWVyUG9pbnQodGhpcy5fbGF0bG5nLHQuem9vbSx0LmNlbnRlcik7dGhpcy5fc2V0UG9zaXRpb24oZSl9LF9nZXRBbmNob3I6ZnVuY3Rpb24oKXtyZXR1cm4gby5wb2ludCh0aGlzLl9zb3VyY2UmJnRoaXMuX3NvdXJjZS5fZ2V0VG9vbHRpcEFuY2hvciYmIXRoaXMub3B0aW9ucy5zdGlja3k/dGhpcy5fc291cmNlLl9nZXRUb29sdGlwQW5jaG9yKCk6WzAsMF0pfX0pLG8udG9vbHRpcD1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgby5Ub29sdGlwKHQsZSl9LG8uTWFwLmluY2x1ZGUoe29wZW5Ub29sdGlwOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdCBpbnN0YW5jZW9mIG8uVG9vbHRpcHx8KHQ9bmV3IG8uVG9vbHRpcChpKS5zZXRDb250ZW50KHQpKSxlJiZ0LnNldExhdExuZyhlKSx0aGlzLmhhc0xheWVyKHQpP3RoaXM6dGhpcy5hZGRMYXllcih0KX0sY2xvc2VUb29sdGlwOmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLnJlbW92ZUxheWVyKHQpLHRoaXN9fSksby5MYXllci5pbmNsdWRlKHtiaW5kVG9vbHRpcDpmdW5jdGlvbih0LGUpe3JldHVybiB0IGluc3RhbmNlb2Ygby5Ub29sdGlwPyhvLnNldE9wdGlvbnModCxlKSx0aGlzLl90b29sdGlwPXQsdC5fc291cmNlPXRoaXMpOih0aGlzLl90b29sdGlwJiYhZXx8KHRoaXMuX3Rvb2x0aXA9by50b29sdGlwKGUsdGhpcykpLHRoaXMuX3Rvb2x0aXAuc2V0Q29udGVudCh0KSksdGhpcy5faW5pdFRvb2x0aXBJbnRlcmFjdGlvbnMoKSx0aGlzLl90b29sdGlwLm9wdGlvbnMucGVybWFuZW50JiZ0aGlzLl9tYXAmJnRoaXMuX21hcC5oYXNMYXllcih0aGlzKSYmdGhpcy5vcGVuVG9vbHRpcCgpLHRoaXN9LHVuYmluZFRvb2x0aXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdG9vbHRpcCYmKHRoaXMuX2luaXRUb29sdGlwSW50ZXJhY3Rpb25zKCEwKSx0aGlzLmNsb3NlVG9vbHRpcCgpLHRoaXMuX3Rvb2x0aXA9bnVsbCksdGhpc30sX2luaXRUb29sdGlwSW50ZXJhY3Rpb25zOmZ1bmN0aW9uKHQpe2lmKHR8fCF0aGlzLl90b29sdGlwSGFuZGxlcnNBZGRlZCl7dmFyIGU9dD9cIm9mZlwiOlwib25cIixpPXtyZW1vdmU6dGhpcy5jbG9zZVRvb2x0aXAsbW92ZTp0aGlzLl9tb3ZlVG9vbHRpcH07dGhpcy5fdG9vbHRpcC5vcHRpb25zLnBlcm1hbmVudD9pLmFkZD10aGlzLl9vcGVuVG9vbHRpcDooaS5tb3VzZW92ZXI9dGhpcy5fb3BlblRvb2x0aXAsaS5tb3VzZW91dD10aGlzLmNsb3NlVG9vbHRpcCx0aGlzLl90b29sdGlwLm9wdGlvbnMuc3RpY2t5JiYoaS5tb3VzZW1vdmU9dGhpcy5fbW92ZVRvb2x0aXApLG8uQnJvd3Nlci50b3VjaCYmKGkuY2xpY2s9dGhpcy5fb3BlblRvb2x0aXApKSx0aGlzW2VdKGkpLHRoaXMuX3Rvb2x0aXBIYW5kbGVyc0FkZGVkPSF0fX0sb3BlblRvb2x0aXA6ZnVuY3Rpb24odCxlKXtpZih0IGluc3RhbmNlb2Ygby5MYXllcnx8KGU9dCx0PXRoaXMpLHQgaW5zdGFuY2VvZiBvLkZlYXR1cmVHcm91cClmb3IodmFyIGkgaW4gdGhpcy5fbGF5ZXJzKXt0PXRoaXMuX2xheWVyc1tpXTticmVha31yZXR1cm4gZXx8KGU9dC5nZXRDZW50ZXI/dC5nZXRDZW50ZXIoKTp0LmdldExhdExuZygpKSx0aGlzLl90b29sdGlwJiZ0aGlzLl9tYXAmJih0aGlzLl90b29sdGlwLl9zb3VyY2U9dCx0aGlzLl90b29sdGlwLnVwZGF0ZSgpLHRoaXMuX21hcC5vcGVuVG9vbHRpcCh0aGlzLl90b29sdGlwLGUpLHRoaXMuX3Rvb2x0aXAub3B0aW9ucy5pbnRlcmFjdGl2ZSYmdGhpcy5fdG9vbHRpcC5fY29udGFpbmVyJiYoby5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX3Rvb2x0aXAuX2NvbnRhaW5lcixcImxlYWZsZXQtY2xpY2thYmxlXCIpLHRoaXMuYWRkSW50ZXJhY3RpdmVUYXJnZXQodGhpcy5fdG9vbHRpcC5fY29udGFpbmVyKSkpLHRoaXN9LGNsb3NlVG9vbHRpcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90b29sdGlwJiYodGhpcy5fdG9vbHRpcC5fY2xvc2UoKSx0aGlzLl90b29sdGlwLm9wdGlvbnMuaW50ZXJhY3RpdmUmJnRoaXMuX3Rvb2x0aXAuX2NvbnRhaW5lciYmKG8uRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl90b29sdGlwLl9jb250YWluZXIsXCJsZWFmbGV0LWNsaWNrYWJsZVwiKSx0aGlzLnJlbW92ZUludGVyYWN0aXZlVGFyZ2V0KHRoaXMuX3Rvb2x0aXAuX2NvbnRhaW5lcikpKSx0aGlzfSx0b2dnbGVUb29sdGlwOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl90b29sdGlwJiYodGhpcy5fdG9vbHRpcC5fbWFwP3RoaXMuY2xvc2VUb29sdGlwKCk6dGhpcy5vcGVuVG9vbHRpcCh0KSksdGhpc30saXNUb29sdGlwT3BlbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90b29sdGlwLmlzT3BlbigpfSxzZXRUb29sdGlwQ29udGVudDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fdG9vbHRpcCYmdGhpcy5fdG9vbHRpcC5zZXRDb250ZW50KHQpLHRoaXN9LGdldFRvb2x0aXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdG9vbHRpcH0sX29wZW5Ub29sdGlwOmZ1bmN0aW9uKHQpe3ZhciBlPXQubGF5ZXJ8fHQudGFyZ2V0O3RoaXMuX3Rvb2x0aXAmJnRoaXMuX21hcCYmdGhpcy5vcGVuVG9vbHRpcChlLHRoaXMuX3Rvb2x0aXAub3B0aW9ucy5zdGlja3k/dC5sYXRsbmc6aSl9LF9tb3ZlVG9vbHRpcDpmdW5jdGlvbih0KXt2YXIgZSxpLG49dC5sYXRsbmc7dGhpcy5fdG9vbHRpcC5vcHRpb25zLnN0aWNreSYmdC5vcmlnaW5hbEV2ZW50JiYoZT10aGlzLl9tYXAubW91c2VFdmVudFRvQ29udGFpbmVyUG9pbnQodC5vcmlnaW5hbEV2ZW50KSxpPXRoaXMuX21hcC5jb250YWluZXJQb2ludFRvTGF5ZXJQb2ludChlKSxuPXRoaXMuX21hcC5sYXllclBvaW50VG9MYXRMbmcoaSkpLHRoaXMuX3Rvb2x0aXAuc2V0TGF0TG5nKG4pfX0pLG8uTGF5ZXJHcm91cD1vLkxheWVyLmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLl9sYXllcnM9e307dmFyIGUsaTtpZih0KWZvcihlPTAsaT10Lmxlbmd0aDtlPGk7ZSsrKXRoaXMuYWRkTGF5ZXIodFtlXSl9LGFkZExheWVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0TGF5ZXJJZCh0KTtyZXR1cm4gdGhpcy5fbGF5ZXJzW2VdPXQsdGhpcy5fbWFwJiZ0aGlzLl9tYXAuYWRkTGF5ZXIodCksdGhpc30scmVtb3ZlTGF5ZXI6ZnVuY3Rpb24odCl7dmFyIGU9dCBpbiB0aGlzLl9sYXllcnM/dDp0aGlzLmdldExheWVySWQodCk7cmV0dXJuIHRoaXMuX21hcCYmdGhpcy5fbGF5ZXJzW2VdJiZ0aGlzLl9tYXAucmVtb3ZlTGF5ZXIodGhpcy5fbGF5ZXJzW2VdKSxkZWxldGUgdGhpcy5fbGF5ZXJzW2VdLHRoaXN9LGhhc0xheWVyOmZ1bmN0aW9uKHQpe3JldHVybiEhdCYmKHQgaW4gdGhpcy5fbGF5ZXJzfHx0aGlzLmdldExheWVySWQodClpbiB0aGlzLl9sYXllcnMpfSxjbGVhckxheWVyczpmdW5jdGlvbigpe2Zvcih2YXIgdCBpbiB0aGlzLl9sYXllcnMpdGhpcy5yZW1vdmVMYXllcih0aGlzLl9sYXllcnNbdF0pO3JldHVybiB0aGlzfSxpbnZva2U6ZnVuY3Rpb24odCl7dmFyIGUsaSxuPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtmb3IoZSBpbiB0aGlzLl9sYXllcnMpaT10aGlzLl9sYXllcnNbZV0saVt0XSYmaVt0XS5hcHBseShpLG4pO3JldHVybiB0aGlzfSxvbkFkZDpmdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdGhpcy5fbGF5ZXJzKXQuYWRkTGF5ZXIodGhpcy5fbGF5ZXJzW2VdKX0sb25SZW1vdmU6ZnVuY3Rpb24odCl7Zm9yKHZhciBlIGluIHRoaXMuX2xheWVycyl0LnJlbW92ZUxheWVyKHRoaXMuX2xheWVyc1tlXSl9LGVhY2hMYXllcjpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaSBpbiB0aGlzLl9sYXllcnMpdC5jYWxsKGUsdGhpcy5fbGF5ZXJzW2ldKTtyZXR1cm4gdGhpc30sZ2V0TGF5ZXI6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2xheWVyc1t0XX0sZ2V0TGF5ZXJzOmZ1bmN0aW9uKCl7dmFyIHQ9W107Zm9yKHZhciBlIGluIHRoaXMuX2xheWVycyl0LnB1c2godGhpcy5fbGF5ZXJzW2VdKTtyZXR1cm4gdH0sc2V0WkluZGV4OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmludm9rZShcInNldFpJbmRleFwiLHQpfSxnZXRMYXllcklkOmZ1bmN0aW9uKHQpe3JldHVybiBvLnN0YW1wKHQpfX0pLG8ubGF5ZXJHcm91cD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8uTGF5ZXJHcm91cCh0KX0sby5GZWF0dXJlR3JvdXA9by5MYXllckdyb3VwLmV4dGVuZCh7YWRkTGF5ZXI6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuaGFzTGF5ZXIodCk/dGhpczoodC5hZGRFdmVudFBhcmVudCh0aGlzKSxvLkxheWVyR3JvdXAucHJvdG90eXBlLmFkZExheWVyLmNhbGwodGhpcyx0KSx0aGlzLmZpcmUoXCJsYXllcmFkZFwiLHtsYXllcjp0fSkpfSxyZW1vdmVMYXllcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5oYXNMYXllcih0KT8odCBpbiB0aGlzLl9sYXllcnMmJih0PXRoaXMuX2xheWVyc1t0XSksdC5yZW1vdmVFdmVudFBhcmVudCh0aGlzKSxvLkxheWVyR3JvdXAucHJvdG90eXBlLnJlbW92ZUxheWVyLmNhbGwodGhpcyx0KSx0aGlzLmZpcmUoXCJsYXllcnJlbW92ZVwiLHtsYXllcjp0fSkpOnRoaXN9LHNldFN0eWxlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmludm9rZShcInNldFN0eWxlXCIsdCl9LGJyaW5nVG9Gcm9udDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmludm9rZShcImJyaW5nVG9Gcm9udFwiKX0sYnJpbmdUb0JhY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZva2UoXCJicmluZ1RvQmFja1wiKX0sZ2V0Qm91bmRzOmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IG8uTGF0TG5nQm91bmRzO2Zvcih2YXIgZSBpbiB0aGlzLl9sYXllcnMpe3ZhciBpPXRoaXMuX2xheWVyc1tlXTt0LmV4dGVuZChpLmdldEJvdW5kcz9pLmdldEJvdW5kcygpOmkuZ2V0TGF0TG5nKCkpfXJldHVybiB0fX0pLG8uZmVhdHVyZUdyb3VwPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgby5GZWF0dXJlR3JvdXAodCl9LG8uUmVuZGVyZXI9by5MYXllci5leHRlbmQoe29wdGlvbnM6e3BhZGRpbmc6LjF9LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7by5zZXRPcHRpb25zKHRoaXMsdCksby5zdGFtcCh0aGlzKSx0aGlzLl9sYXllcnM9dGhpcy5fbGF5ZXJzfHx7fX0sb25BZGQ6ZnVuY3Rpb24oKXt0aGlzLl9jb250YWluZXJ8fCh0aGlzLl9pbml0Q29udGFpbmVyKCksdGhpcy5fem9vbUFuaW1hdGVkJiZvLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5fY29udGFpbmVyLFwibGVhZmxldC16b29tLWFuaW1hdGVkXCIpKSx0aGlzLmdldFBhbmUoKS5hcHBlbmRDaGlsZCh0aGlzLl9jb250YWluZXIpLHRoaXMuX3VwZGF0ZSgpLHRoaXMub24oXCJ1cGRhdGVcIix0aGlzLl91cGRhdGVQYXRocyx0aGlzKX0sb25SZW1vdmU6ZnVuY3Rpb24oKXtvLkRvbVV0aWwucmVtb3ZlKHRoaXMuX2NvbnRhaW5lciksdGhpcy5vZmYoXCJ1cGRhdGVcIix0aGlzLl91cGRhdGVQYXRocyx0aGlzKX0sZ2V0RXZlbnRzOmZ1bmN0aW9uKCl7dmFyIHQ9e3ZpZXdyZXNldDp0aGlzLl9yZXNldCx6b29tOnRoaXMuX29uWm9vbSxtb3ZlZW5kOnRoaXMuX3VwZGF0ZSx6b29tZW5kOnRoaXMuX29uWm9vbUVuZH07cmV0dXJuIHRoaXMuX3pvb21BbmltYXRlZCYmKHQuem9vbWFuaW09dGhpcy5fb25BbmltWm9vbSksdH0sX29uQW5pbVpvb206ZnVuY3Rpb24odCl7dGhpcy5fdXBkYXRlVHJhbnNmb3JtKHQuY2VudGVyLHQuem9vbSl9LF9vblpvb206ZnVuY3Rpb24oKXt0aGlzLl91cGRhdGVUcmFuc2Zvcm0odGhpcy5fbWFwLmdldENlbnRlcigpLHRoaXMuX21hcC5nZXRab29tKCkpfSxfdXBkYXRlVHJhbnNmb3JtOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fbWFwLmdldFpvb21TY2FsZShlLHRoaXMuX3pvb20pLG49by5Eb21VdGlsLmdldFBvc2l0aW9uKHRoaXMuX2NvbnRhaW5lcikscz10aGlzLl9tYXAuZ2V0U2l6ZSgpLm11bHRpcGx5QnkoLjUrdGhpcy5vcHRpb25zLnBhZGRpbmcpLHI9dGhpcy5fbWFwLnByb2plY3QodGhpcy5fY2VudGVyLGUpLGE9dGhpcy5fbWFwLnByb2plY3QodCxlKSxoPWEuc3VidHJhY3QociksbD1zLm11bHRpcGx5QnkoLWkpLmFkZChuKS5hZGQocykuc3VidHJhY3QoaCk7by5Ccm93c2VyLmFueTNkP28uRG9tVXRpbC5zZXRUcmFuc2Zvcm0odGhpcy5fY29udGFpbmVyLGwsaSk6by5Eb21VdGlsLnNldFBvc2l0aW9uKHRoaXMuX2NvbnRhaW5lcixsKX0sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fdXBkYXRlKCksdGhpcy5fdXBkYXRlVHJhbnNmb3JtKHRoaXMuX2NlbnRlcix0aGlzLl96b29tKTtmb3IodmFyIHQgaW4gdGhpcy5fbGF5ZXJzKXRoaXMuX2xheWVyc1t0XS5fcmVzZXQoKX0sX29uWm9vbUVuZDpmdW5jdGlvbigpe2Zvcih2YXIgdCBpbiB0aGlzLl9sYXllcnMpdGhpcy5fbGF5ZXJzW3RdLl9wcm9qZWN0KCl9LF91cGRhdGVQYXRoczpmdW5jdGlvbigpe2Zvcih2YXIgdCBpbiB0aGlzLl9sYXllcnMpdGhpcy5fbGF5ZXJzW3RdLl91cGRhdGUoKX0sX3VwZGF0ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucy5wYWRkaW5nLGU9dGhpcy5fbWFwLmdldFNpemUoKSxpPXRoaXMuX21hcC5jb250YWluZXJQb2ludFRvTGF5ZXJQb2ludChlLm11bHRpcGx5QnkoLXQpKS5yb3VuZCgpO3RoaXMuX2JvdW5kcz1uZXcgby5Cb3VuZHMoaSxpLmFkZChlLm11bHRpcGx5QnkoMSsyKnQpKS5yb3VuZCgpKSx0aGlzLl9jZW50ZXI9dGhpcy5fbWFwLmdldENlbnRlcigpLHRoaXMuX3pvb209dGhpcy5fbWFwLmdldFpvb20oKX19KSxvLk1hcC5pbmNsdWRlKHtnZXRSZW5kZXJlcjpmdW5jdGlvbih0KXt2YXIgZT10Lm9wdGlvbnMucmVuZGVyZXJ8fHRoaXMuX2dldFBhbmVSZW5kZXJlcih0Lm9wdGlvbnMucGFuZSl8fHRoaXMub3B0aW9ucy5yZW5kZXJlcnx8dGhpcy5fcmVuZGVyZXI7cmV0dXJuIGV8fChlPXRoaXMuX3JlbmRlcmVyPXRoaXMub3B0aW9ucy5wcmVmZXJDYW52YXMmJm8uY2FudmFzKCl8fG8uc3ZnKCkpLHRoaXMuaGFzTGF5ZXIoZSl8fHRoaXMuYWRkTGF5ZXIoZSksZX0sX2dldFBhbmVSZW5kZXJlcjpmdW5jdGlvbih0KXtpZihcIm92ZXJsYXlQYW5lXCI9PT10fHx0PT09aSlyZXR1cm4hMTt2YXIgZT10aGlzLl9wYW5lUmVuZGVyZXJzW3RdO3JldHVybiBlPT09aSYmKGU9by5TVkcmJm8uc3ZnKHtwYW5lOnR9KXx8by5DYW52YXMmJm8uY2FudmFzKHtwYW5lOnR9KSx0aGlzLl9wYW5lUmVuZGVyZXJzW3RdPWUpLGV9fSksby5QYXRoPW8uTGF5ZXIuZXh0ZW5kKHtvcHRpb25zOntzdHJva2U6ITAsY29sb3I6XCIjMzM4OGZmXCIsd2VpZ2h0OjMsb3BhY2l0eToxLGxpbmVDYXA6XCJyb3VuZFwiLGxpbmVKb2luOlwicm91bmRcIixkYXNoQXJyYXk6bnVsbCxkYXNoT2Zmc2V0Om51bGwsZmlsbDohMSxmaWxsQ29sb3I6bnVsbCxmaWxsT3BhY2l0eTouMixmaWxsUnVsZTpcImV2ZW5vZGRcIixpbnRlcmFjdGl2ZTohMH0sYmVmb3JlQWRkOmZ1bmN0aW9uKHQpe3RoaXMuX3JlbmRlcmVyPXQuZ2V0UmVuZGVyZXIodGhpcyl9LG9uQWRkOmZ1bmN0aW9uKCl7dGhpcy5fcmVuZGVyZXIuX2luaXRQYXRoKHRoaXMpLHRoaXMuX3Jlc2V0KCksdGhpcy5fcmVuZGVyZXIuX2FkZFBhdGgodGhpcyl9LG9uUmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy5fcmVuZGVyZXIuX3JlbW92ZVBhdGgodGhpcyl9LHJlZHJhdzpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tYXAmJnRoaXMuX3JlbmRlcmVyLl91cGRhdGVQYXRoKHRoaXMpLHRoaXN9LHNldFN0eWxlOmZ1bmN0aW9uKHQpe3JldHVybiBvLnNldE9wdGlvbnModGhpcyx0KSx0aGlzLl9yZW5kZXJlciYmdGhpcy5fcmVuZGVyZXIuX3VwZGF0ZVN0eWxlKHRoaXMpLHRoaXN9LGJyaW5nVG9Gcm9udDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW5kZXJlciYmdGhpcy5fcmVuZGVyZXIuX2JyaW5nVG9Gcm9udCh0aGlzKSx0aGlzfSxicmluZ1RvQmFjazpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW5kZXJlciYmdGhpcy5fcmVuZGVyZXIuX2JyaW5nVG9CYWNrKHRoaXMpLHRoaXN9LGdldEVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGF0aH0sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fcHJvamVjdCgpLHRoaXMuX3VwZGF0ZSgpfSxfY2xpY2tUb2xlcmFuY2U6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5vcHRpb25zLnN0cm9rZT90aGlzLm9wdGlvbnMud2VpZ2h0LzI6MCkrKG8uQnJvd3Nlci50b3VjaD8xMDowKX19KSxvLkxpbmVVdGlsPXtzaW1wbGlmeTpmdW5jdGlvbih0LGUpe2lmKCFlfHwhdC5sZW5ndGgpcmV0dXJuIHQuc2xpY2UoKTt2YXIgaT1lKmU7cmV0dXJuIHQ9dGhpcy5fcmVkdWNlUG9pbnRzKHQsaSksdD10aGlzLl9zaW1wbGlmeURQKHQsaSl9LHBvaW50VG9TZWdtZW50RGlzdGFuY2U6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBNYXRoLnNxcnQodGhpcy5fc3FDbG9zZXN0UG9pbnRPblNlZ21lbnQodCxlLGksITApKX0sY2xvc2VzdFBvaW50T25TZWdtZW50OmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5fc3FDbG9zZXN0UG9pbnRPblNlZ21lbnQodCxlLGkpfSxfc2ltcGxpZnlEUDpmdW5jdGlvbih0LGUpe3ZhciBuPXQubGVuZ3RoLG89dHlwZW9mIFVpbnQ4QXJyYXkhPWkrXCJcIj9VaW50OEFycmF5OkFycmF5LHM9bmV3IG8obik7c1swXT1zW24tMV09MSx0aGlzLl9zaW1wbGlmeURQU3RlcCh0LHMsZSwwLG4tMSk7dmFyIHIsYT1bXTtmb3Iocj0wO3I8bjtyKyspc1tyXSYmYS5wdXNoKHRbcl0pO3JldHVybiBhfSxfc2ltcGxpZnlEUFN0ZXA6ZnVuY3Rpb24odCxlLGksbixvKXt2YXIgcyxyLGEsaD0wO2ZvcihyPW4rMTtyPD1vLTE7cisrKWE9dGhpcy5fc3FDbG9zZXN0UG9pbnRPblNlZ21lbnQodFtyXSx0W25dLHRbb10sITApLGE+aCYmKHM9cixoPWEpO2g+aSYmKGVbc109MSx0aGlzLl9zaW1wbGlmeURQU3RlcCh0LGUsaSxuLHMpLHRoaXMuX3NpbXBsaWZ5RFBTdGVwKHQsZSxpLHMsbykpfSxfcmVkdWNlUG9pbnRzOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPVt0WzBdXSxuPTEsbz0wLHM9dC5sZW5ndGg7bjxzO24rKyl0aGlzLl9zcURpc3QodFtuXSx0W29dKT5lJiYoaS5wdXNoKHRbbl0pLG89bik7cmV0dXJuIG88cy0xJiZpLnB1c2godFtzLTFdKSxpfSxjbGlwU2VnbWVudDpmdW5jdGlvbih0LGUsaSxuLG8pe3ZhciBzLHIsYSxoPW4/dGhpcy5fbGFzdENvZGU6dGhpcy5fZ2V0Qml0Q29kZSh0LGkpLGw9dGhpcy5fZ2V0Qml0Q29kZShlLGkpO2Zvcih0aGlzLl9sYXN0Q29kZT1sOzspe2lmKCEoaHxsKSlyZXR1cm5bdCxlXTtpZihoJmwpcmV0dXJuITE7cz1ofHxsLHI9dGhpcy5fZ2V0RWRnZUludGVyc2VjdGlvbih0LGUscyxpLG8pLGE9dGhpcy5fZ2V0Qml0Q29kZShyLGkpLHM9PT1oPyh0PXIsaD1hKTooZT1yLGw9YSl9fSxfZ2V0RWRnZUludGVyc2VjdGlvbjpmdW5jdGlvbih0LGUsaSxuLHMpe3ZhciByLGEsaD1lLngtdC54LGw9ZS55LXQueSx1PW4ubWluLGM9bi5tYXg7cmV0dXJuIDgmaT8ocj10LngraCooYy55LXQueSkvbCxhPWMueSk6NCZpPyhyPXQueCtoKih1LnktdC55KS9sLGE9dS55KToyJmk/KHI9Yy54LGE9dC55K2wqKGMueC10LngpL2gpOjEmaSYmKHI9dS54LGE9dC55K2wqKHUueC10LngpL2gpLG5ldyBvLlBvaW50KHIsYSxzKX0sX2dldEJpdENvZGU6ZnVuY3Rpb24odCxlKXt2YXIgaT0wO3JldHVybiB0Lng8ZS5taW4ueD9pfD0xOnQueD5lLm1heC54JiYoaXw9MiksdC55PGUubWluLnk/aXw9NDp0Lnk+ZS5tYXgueSYmKGl8PTgpLGl9LF9zcURpc3Q6ZnVuY3Rpb24odCxlKXt2YXIgaT1lLngtdC54LG49ZS55LXQueTtyZXR1cm4gaSppK24qbn0sX3NxQ2xvc2VzdFBvaW50T25TZWdtZW50OmZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBzLHI9ZS54LGE9ZS55LGg9aS54LXIsbD1pLnktYSx1PWgqaCtsKmw7cmV0dXJuIHU+MCYmKHM9KCh0LngtcikqaCsodC55LWEpKmwpL3Uscz4xPyhyPWkueCxhPWkueSk6cz4wJiYocis9aCpzLGErPWwqcykpLGg9dC54LXIsbD10LnktYSxuP2gqaCtsKmw6bmV3IG8uUG9pbnQocixhKX19LG8uUG9seWxpbmU9by5QYXRoLmV4dGVuZCh7b3B0aW9uczp7c21vb3RoRmFjdG9yOjEsbm9DbGlwOiExfSxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7by5zZXRPcHRpb25zKHRoaXMsZSksdGhpcy5fc2V0TGF0TG5ncyh0KX0sZ2V0TGF0TG5nczpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sYXRsbmdzfSxzZXRMYXRMbmdzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9zZXRMYXRMbmdzKHQpLHRoaXMucmVkcmF3KCl9LGlzRW1wdHk6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5fbGF0bG5ncy5sZW5ndGh9LGNsb3Nlc3RMYXllclBvaW50OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxpLG49MS8wLHM9bnVsbCxyPW8uTGluZVV0aWwuX3NxQ2xvc2VzdFBvaW50T25TZWdtZW50LGE9MCxoPXRoaXMuX3BhcnRzLmxlbmd0aDthPGg7YSsrKWZvcih2YXIgbD10aGlzLl9wYXJ0c1thXSx1PTEsYz1sLmxlbmd0aDt1PGM7dSsrKXtlPWxbdS0xXSxpPWxbdV07dmFyIGQ9cih0LGUsaSwhMCk7ZDxuJiYobj1kLHM9cih0LGUsaSkpfXJldHVybiBzJiYocy5kaXN0YW5jZT1NYXRoLnNxcnQobikpLHN9LGdldENlbnRlcjpmdW5jdGlvbigpe2lmKCF0aGlzLl9tYXApdGhyb3cgbmV3IEVycm9yKFwiTXVzdCBhZGQgbGF5ZXIgdG8gbWFwIGJlZm9yZSB1c2luZyBnZXRDZW50ZXIoKVwiKTt2YXIgdCxlLGksbixvLHMscixhPXRoaXMuX3JpbmdzWzBdLGg9YS5sZW5ndGg7aWYoIWgpcmV0dXJuIG51bGw7Zm9yKHQ9MCxlPTA7dDxoLTE7dCsrKWUrPWFbdF0uZGlzdGFuY2VUbyhhW3QrMV0pLzI7aWYoMD09PWUpcmV0dXJuIHRoaXMuX21hcC5sYXllclBvaW50VG9MYXRMbmcoYVswXSk7Zm9yKHQ9MCxuPTA7dDxoLTE7dCsrKWlmKG89YVt0XSxzPWFbdCsxXSxpPW8uZGlzdGFuY2VUbyhzKSxuKz1pLG4+ZSlyZXR1cm4gcj0obi1lKS9pLHRoaXMuX21hcC5sYXllclBvaW50VG9MYXRMbmcoW3MueC1yKihzLngtby54KSxzLnktcioocy55LW8ueSldKX0sZ2V0Qm91bmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2JvdW5kc30sYWRkTGF0TG5nOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGU9ZXx8dGhpcy5fZGVmYXVsdFNoYXBlKCksdD1vLmxhdExuZyh0KSxlLnB1c2godCksdGhpcy5fYm91bmRzLmV4dGVuZCh0KSx0aGlzLnJlZHJhdygpfSxfc2V0TGF0TG5nczpmdW5jdGlvbih0KXt0aGlzLl9ib3VuZHM9bmV3IG8uTGF0TG5nQm91bmRzLHRoaXMuX2xhdGxuZ3M9dGhpcy5fY29udmVydExhdExuZ3ModCl9LF9kZWZhdWx0U2hhcGU6ZnVuY3Rpb24oKXtyZXR1cm4gby5Qb2x5bGluZS5fZmxhdCh0aGlzLl9sYXRsbmdzKT90aGlzLl9sYXRsbmdzOnRoaXMuX2xhdGxuZ3NbMF19LF9jb252ZXJ0TGF0TG5nczpmdW5jdGlvbih0KXtmb3IodmFyIGU9W10saT1vLlBvbHlsaW5lLl9mbGF0KHQpLG49MCxzPXQubGVuZ3RoO248cztuKyspaT8oZVtuXT1vLmxhdExuZyh0W25dKSx0aGlzLl9ib3VuZHMuZXh0ZW5kKGVbbl0pKTplW25dPXRoaXMuX2NvbnZlcnRMYXRMbmdzKHRbbl0pO3JldHVybiBlfSxfcHJvamVjdDpmdW5jdGlvbigpe3ZhciB0PW5ldyBvLkJvdW5kczt0aGlzLl9yaW5ncz1bXSx0aGlzLl9wcm9qZWN0TGF0bG5ncyh0aGlzLl9sYXRsbmdzLHRoaXMuX3JpbmdzLHQpO3ZhciBlPXRoaXMuX2NsaWNrVG9sZXJhbmNlKCksaT1uZXcgby5Qb2ludChlLGUpO3RoaXMuX2JvdW5kcy5pc1ZhbGlkKCkmJnQuaXNWYWxpZCgpJiYodC5taW4uX3N1YnRyYWN0KGkpLHQubWF4Ll9hZGQoaSksdGhpcy5fcHhCb3VuZHM9dCl9LF9wcm9qZWN0TGF0bG5nczpmdW5jdGlvbih0LGUsaSl7dmFyIG4scyxyPXRbMF1pbnN0YW5jZW9mIG8uTGF0TG5nLGE9dC5sZW5ndGg7aWYocil7Zm9yKHM9W10sbj0wO248YTtuKyspc1tuXT10aGlzLl9tYXAubGF0TG5nVG9MYXllclBvaW50KHRbbl0pLGkuZXh0ZW5kKHNbbl0pO2UucHVzaChzKX1lbHNlIGZvcihuPTA7bjxhO24rKyl0aGlzLl9wcm9qZWN0TGF0bG5ncyh0W25dLGUsaSl9LF9jbGlwUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fcmVuZGVyZXIuX2JvdW5kcztpZih0aGlzLl9wYXJ0cz1bXSx0aGlzLl9weEJvdW5kcyYmdGhpcy5fcHhCb3VuZHMuaW50ZXJzZWN0cyh0KSl7aWYodGhpcy5vcHRpb25zLm5vQ2xpcClyZXR1cm4gdm9pZCh0aGlzLl9wYXJ0cz10aGlzLl9yaW5ncyk7dmFyIGUsaSxuLHMscixhLGgsbD10aGlzLl9wYXJ0cztmb3IoZT0wLG49MCxzPXRoaXMuX3JpbmdzLmxlbmd0aDtlPHM7ZSsrKWZvcihoPXRoaXMuX3JpbmdzW2VdLGk9MCxyPWgubGVuZ3RoO2k8ci0xO2krKylhPW8uTGluZVV0aWwuY2xpcFNlZ21lbnQoaFtpXSxoW2krMV0sdCxpLCEwKSxhJiYobFtuXT1sW25dfHxbXSxsW25dLnB1c2goYVswXSksYVsxXT09PWhbaSsxXSYmaSE9PXItMnx8KGxbbl0ucHVzaChhWzFdKSxuKyspKX19LF9zaW1wbGlmeVBvaW50czpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLl9wYXJ0cyxlPXRoaXMub3B0aW9ucy5zbW9vdGhGYWN0b3IsaT0wLG49dC5sZW5ndGg7aTxuO2krKyl0W2ldPW8uTGluZVV0aWwuc2ltcGxpZnkodFtpXSxlKX0sX3VwZGF0ZTpmdW5jdGlvbigpe3RoaXMuX21hcCYmKHRoaXMuX2NsaXBQb2ludHMoKSx0aGlzLl9zaW1wbGlmeVBvaW50cygpLHRoaXMuX3VwZGF0ZVBhdGgoKSl9LF91cGRhdGVQYXRoOmZ1bmN0aW9uKCl7dGhpcy5fcmVuZGVyZXIuX3VwZGF0ZVBvbHkodGhpcyl9fSksby5wb2x5bGluZT1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgby5Qb2x5bGluZSh0LGUpfSxvLlBvbHlsaW5lLl9mbGF0PWZ1bmN0aW9uKHQpe3JldHVybiFvLlV0aWwuaXNBcnJheSh0WzBdKXx8XCJvYmplY3RcIiE9dHlwZW9mIHRbMF1bMF0mJlwidW5kZWZpbmVkXCIhPXR5cGVvZiB0WzBdWzBdfSxvLlBvbHlVdGlsPXt9LG8uUG9seVV0aWwuY2xpcFBvbHlnb249ZnVuY3Rpb24odCxlLGkpe3ZhciBuLHMscixhLGgsbCx1LGMsZCxfPVsxLDQsMiw4XSxtPW8uTGluZVV0aWw7Zm9yKHM9MCx1PXQubGVuZ3RoO3M8dTtzKyspdFtzXS5fY29kZT1tLl9nZXRCaXRDb2RlKHRbc10sZSk7Zm9yKGE9MDthPDQ7YSsrKXtmb3IoYz1fW2FdLG49W10scz0wLHU9dC5sZW5ndGgscj11LTE7czx1O3I9cysrKWg9dFtzXSxsPXRbcl0saC5fY29kZSZjP2wuX2NvZGUmY3x8KGQ9bS5fZ2V0RWRnZUludGVyc2VjdGlvbihsLGgsYyxlLGkpLGQuX2NvZGU9bS5fZ2V0Qml0Q29kZShkLGUpLG4ucHVzaChkKSk6KGwuX2NvZGUmYyYmKGQ9bS5fZ2V0RWRnZUludGVyc2VjdGlvbihsLGgsYyxlLGkpLGQuX2NvZGU9bS5fZ2V0Qml0Q29kZShkLGUpLG4ucHVzaChkKSksbi5wdXNoKGgpKTt0PW59cmV0dXJuIHR9LG8uUG9seWdvbj1vLlBvbHlsaW5lLmV4dGVuZCh7b3B0aW9uczp7ZmlsbDohMH0saXNFbXB0eTpmdW5jdGlvbigpe3JldHVybiF0aGlzLl9sYXRsbmdzLmxlbmd0aHx8IXRoaXMuX2xhdGxuZ3NbMF0ubGVuZ3RofSxnZXRDZW50ZXI6ZnVuY3Rpb24oKXtpZighdGhpcy5fbWFwKXRocm93IG5ldyBFcnJvcihcIk11c3QgYWRkIGxheWVyIHRvIG1hcCBiZWZvcmUgdXNpbmcgZ2V0Q2VudGVyKClcIik7dmFyIHQsZSxpLG4sbyxzLHIsYSxoLGw9dGhpcy5fcmluZ3NbMF0sdT1sLmxlbmd0aDtpZighdSlyZXR1cm4gbnVsbDtmb3Iocz1yPWE9MCx0PTAsZT11LTE7dDx1O2U9dCsrKWk9bFt0XSxuPWxbZV0sbz1pLnkqbi54LW4ueSppLngscis9KGkueCtuLngpKm8sYSs9KGkueStuLnkpKm8scys9MypvO3JldHVybiBoPTA9PT1zP2xbMF06W3IvcyxhL3NdLHRoaXMuX21hcC5sYXllclBvaW50VG9MYXRMbmcoaCl9LF9jb252ZXJ0TGF0TG5nczpmdW5jdGlvbih0KXt2YXIgZT1vLlBvbHlsaW5lLnByb3RvdHlwZS5fY29udmVydExhdExuZ3MuY2FsbCh0aGlzLHQpLGk9ZS5sZW5ndGg7cmV0dXJuIGk+PTImJmVbMF1pbnN0YW5jZW9mIG8uTGF0TG5nJiZlWzBdLmVxdWFscyhlW2ktMV0pJiZlLnBvcCgpLGV9LF9zZXRMYXRMbmdzOmZ1bmN0aW9uKHQpe28uUG9seWxpbmUucHJvdG90eXBlLl9zZXRMYXRMbmdzLmNhbGwodGhpcyx0KSxvLlBvbHlsaW5lLl9mbGF0KHRoaXMuX2xhdGxuZ3MpJiYodGhpcy5fbGF0bG5ncz1bdGhpcy5fbGF0bG5nc10pfSxfZGVmYXVsdFNoYXBlOmZ1bmN0aW9uKCl7cmV0dXJuIG8uUG9seWxpbmUuX2ZsYXQodGhpcy5fbGF0bG5nc1swXSk/dGhpcy5fbGF0bG5nc1swXTp0aGlzLl9sYXRsbmdzWzBdWzBdfSxfY2xpcFBvaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3JlbmRlcmVyLl9ib3VuZHMsZT10aGlzLm9wdGlvbnMud2VpZ2h0LGk9bmV3IG8uUG9pbnQoZSxlKTtpZih0PW5ldyBvLkJvdW5kcyh0Lm1pbi5zdWJ0cmFjdChpKSx0Lm1heC5hZGQoaSkpLHRoaXMuX3BhcnRzPVtdLHRoaXMuX3B4Qm91bmRzJiZ0aGlzLl9weEJvdW5kcy5pbnRlcnNlY3RzKHQpKXtpZih0aGlzLm9wdGlvbnMubm9DbGlwKXJldHVybiB2b2lkKHRoaXMuX3BhcnRzPXRoaXMuX3JpbmdzKTtmb3IodmFyIG4scz0wLHI9dGhpcy5fcmluZ3MubGVuZ3RoO3M8cjtzKyspbj1vLlBvbHlVdGlsLmNsaXBQb2x5Z29uKHRoaXMuX3JpbmdzW3NdLHQsITApLG4ubGVuZ3RoJiZ0aGlzLl9wYXJ0cy5wdXNoKG4pfX0sX3VwZGF0ZVBhdGg6ZnVuY3Rpb24oKXt0aGlzLl9yZW5kZXJlci5fdXBkYXRlUG9seSh0aGlzLCEwKX19KSxvLnBvbHlnb249ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IG8uUG9seWdvbih0LGUpfSxvLlJlY3RhbmdsZT1vLlBvbHlnb24uZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7by5Qb2x5Z29uLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcyx0aGlzLl9ib3VuZHNUb0xhdExuZ3ModCksZSl9LHNldEJvdW5kczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXRMYXRMbmdzKHRoaXMuX2JvdW5kc1RvTGF0TG5ncyh0KSl9LF9ib3VuZHNUb0xhdExuZ3M6ZnVuY3Rpb24odCl7cmV0dXJuIHQ9by5sYXRMbmdCb3VuZHModCksW3QuZ2V0U291dGhXZXN0KCksdC5nZXROb3J0aFdlc3QoKSx0LmdldE5vcnRoRWFzdCgpLHQuZ2V0U291dGhFYXN0KCldfX0pLG8ucmVjdGFuZ2xlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBvLlJlY3RhbmdsZSh0LGUpfSxvLkNpcmNsZU1hcmtlcj1vLlBhdGguZXh0ZW5kKHtvcHRpb25zOntmaWxsOiEwLHJhZGl1czoxMH0saW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe28uc2V0T3B0aW9ucyh0aGlzLGUpLHRoaXMuX2xhdGxuZz1vLmxhdExuZyh0KSx0aGlzLl9yYWRpdXM9dGhpcy5vcHRpb25zLnJhZGl1c30sc2V0TGF0TG5nOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9sYXRsbmc9by5sYXRMbmcodCksdGhpcy5yZWRyYXcoKSx0aGlzLmZpcmUoXCJtb3ZlXCIse2xhdGxuZzp0aGlzLl9sYXRsbmd9KX0sZ2V0TGF0TG5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xhdGxuZ30sc2V0UmFkaXVzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMucmFkaXVzPXRoaXMuX3JhZGl1cz10LHRoaXMucmVkcmF3KCl9LGdldFJhZGl1czpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yYWRpdXN9LHNldFN0eWxlOmZ1bmN0aW9uKHQpe3ZhciBlPXQmJnQucmFkaXVzfHx0aGlzLl9yYWRpdXM7cmV0dXJuIG8uUGF0aC5wcm90b3R5cGUuc2V0U3R5bGUuY2FsbCh0aGlzLHQpLHRoaXMuc2V0UmFkaXVzKGUpLHRoaXN9LF9wcm9qZWN0OmZ1bmN0aW9uKCl7dGhpcy5fcG9pbnQ9dGhpcy5fbWFwLmxhdExuZ1RvTGF5ZXJQb2ludCh0aGlzLl9sYXRsbmcpLHRoaXMuX3VwZGF0ZUJvdW5kcygpfSxfdXBkYXRlQm91bmRzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fcmFkaXVzLGU9dGhpcy5fcmFkaXVzWXx8dCxpPXRoaXMuX2NsaWNrVG9sZXJhbmNlKCksbj1bdCtpLGUraV07dGhpcy5fcHhCb3VuZHM9bmV3IG8uQm91bmRzKHRoaXMuX3BvaW50LnN1YnRyYWN0KG4pLHRoaXMuX3BvaW50LmFkZChuKSl9LF91cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLl9tYXAmJnRoaXMuX3VwZGF0ZVBhdGgoKX0sX3VwZGF0ZVBhdGg6ZnVuY3Rpb24oKXt0aGlzLl9yZW5kZXJlci5fdXBkYXRlQ2lyY2xlKHRoaXMpfSxfZW1wdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmFkaXVzJiYhdGhpcy5fcmVuZGVyZXIuX2JvdW5kcy5pbnRlcnNlY3RzKHRoaXMuX3B4Qm91bmRzKX19KSxvLmNpcmNsZU1hcmtlcj1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgby5DaXJjbGVNYXJrZXIodCxlKX0sby5DaXJjbGU9by5DaXJjbGVNYXJrZXIuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSxpKXtpZihcIm51bWJlclwiPT10eXBlb2YgZSYmKGU9by5leHRlbmQoe30saSx7cmFkaXVzOmV9KSksby5zZXRPcHRpb25zKHRoaXMsZSksdGhpcy5fbGF0bG5nPW8ubGF0TG5nKHQpLGlzTmFOKHRoaXMub3B0aW9ucy5yYWRpdXMpKXRocm93IG5ldyBFcnJvcihcIkNpcmNsZSByYWRpdXMgY2Fubm90IGJlIE5hTlwiKTt0aGlzLl9tUmFkaXVzPXRoaXMub3B0aW9ucy5yYWRpdXN9LHNldFJhZGl1czpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbVJhZGl1cz10LFxudGhpcy5yZWRyYXcoKX0sZ2V0UmFkaXVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21SYWRpdXN9LGdldEJvdW5kczpmdW5jdGlvbigpe3ZhciB0PVt0aGlzLl9yYWRpdXMsdGhpcy5fcmFkaXVzWXx8dGhpcy5fcmFkaXVzXTtyZXR1cm4gbmV3IG8uTGF0TG5nQm91bmRzKHRoaXMuX21hcC5sYXllclBvaW50VG9MYXRMbmcodGhpcy5fcG9pbnQuc3VidHJhY3QodCkpLHRoaXMuX21hcC5sYXllclBvaW50VG9MYXRMbmcodGhpcy5fcG9pbnQuYWRkKHQpKSl9LHNldFN0eWxlOm8uUGF0aC5wcm90b3R5cGUuc2V0U3R5bGUsX3Byb2plY3Q6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9sYXRsbmcubG5nLGU9dGhpcy5fbGF0bG5nLmxhdCxpPXRoaXMuX21hcCxuPWkub3B0aW9ucy5jcnM7aWYobi5kaXN0YW5jZT09PW8uQ1JTLkVhcnRoLmRpc3RhbmNlKXt2YXIgcz1NYXRoLlBJLzE4MCxyPXRoaXMuX21SYWRpdXMvby5DUlMuRWFydGguUi9zLGE9aS5wcm9qZWN0KFtlK3IsdF0pLGg9aS5wcm9qZWN0KFtlLXIsdF0pLGw9YS5hZGQoaCkuZGl2aWRlQnkoMiksdT1pLnVucHJvamVjdChsKS5sYXQsYz1NYXRoLmFjb3MoKE1hdGguY29zKHIqcyktTWF0aC5zaW4oZSpzKSpNYXRoLnNpbih1KnMpKS8oTWF0aC5jb3MoZSpzKSpNYXRoLmNvcyh1KnMpKSkvczsoaXNOYU4oYyl8fDA9PT1jKSYmKGM9ci9NYXRoLmNvcyhNYXRoLlBJLzE4MCplKSksdGhpcy5fcG9pbnQ9bC5zdWJ0cmFjdChpLmdldFBpeGVsT3JpZ2luKCkpLHRoaXMuX3JhZGl1cz1pc05hTihjKT8wOk1hdGgubWF4KE1hdGgucm91bmQobC54LWkucHJvamVjdChbdSx0LWNdKS54KSwxKSx0aGlzLl9yYWRpdXNZPU1hdGgubWF4KE1hdGgucm91bmQobC55LWEueSksMSl9ZWxzZXt2YXIgZD1uLnVucHJvamVjdChuLnByb2plY3QodGhpcy5fbGF0bG5nKS5zdWJ0cmFjdChbdGhpcy5fbVJhZGl1cywwXSkpO3RoaXMuX3BvaW50PWkubGF0TG5nVG9MYXllclBvaW50KHRoaXMuX2xhdGxuZyksdGhpcy5fcmFkaXVzPXRoaXMuX3BvaW50LngtaS5sYXRMbmdUb0xheWVyUG9pbnQoZCkueH10aGlzLl91cGRhdGVCb3VuZHMoKX19KSxvLmNpcmNsZT1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIG5ldyBvLkNpcmNsZSh0LGUsaSl9LG8uU1ZHPW8uUmVuZGVyZXIuZXh0ZW5kKHtnZXRFdmVudHM6ZnVuY3Rpb24oKXt2YXIgdD1vLlJlbmRlcmVyLnByb3RvdHlwZS5nZXRFdmVudHMuY2FsbCh0aGlzKTtyZXR1cm4gdC56b29tc3RhcnQ9dGhpcy5fb25ab29tU3RhcnQsdH0sX2luaXRDb250YWluZXI6ZnVuY3Rpb24oKXt0aGlzLl9jb250YWluZXI9by5TVkcuY3JlYXRlKFwic3ZnXCIpLHRoaXMuX2NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJwb2ludGVyLWV2ZW50c1wiLFwibm9uZVwiKSx0aGlzLl9yb290R3JvdXA9by5TVkcuY3JlYXRlKFwiZ1wiKSx0aGlzLl9jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5fcm9vdEdyb3VwKX0sX29uWm9vbVN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5fdXBkYXRlKCl9LF91cGRhdGU6ZnVuY3Rpb24oKXtpZighdGhpcy5fbWFwLl9hbmltYXRpbmdab29tfHwhdGhpcy5fYm91bmRzKXtvLlJlbmRlcmVyLnByb3RvdHlwZS5fdXBkYXRlLmNhbGwodGhpcyk7dmFyIHQ9dGhpcy5fYm91bmRzLGU9dC5nZXRTaXplKCksaT10aGlzLl9jb250YWluZXI7dGhpcy5fc3ZnU2l6ZSYmdGhpcy5fc3ZnU2l6ZS5lcXVhbHMoZSl8fCh0aGlzLl9zdmdTaXplPWUsaS5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLGUueCksaS5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIixlLnkpKSxvLkRvbVV0aWwuc2V0UG9zaXRpb24oaSx0Lm1pbiksaS5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsW3QubWluLngsdC5taW4ueSxlLngsZS55XS5qb2luKFwiIFwiKSksdGhpcy5maXJlKFwidXBkYXRlXCIpfX0sX2luaXRQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPXQuX3BhdGg9by5TVkcuY3JlYXRlKFwicGF0aFwiKTt0Lm9wdGlvbnMuY2xhc3NOYW1lJiZvLkRvbVV0aWwuYWRkQ2xhc3MoZSx0Lm9wdGlvbnMuY2xhc3NOYW1lKSx0Lm9wdGlvbnMuaW50ZXJhY3RpdmUmJm8uRG9tVXRpbC5hZGRDbGFzcyhlLFwibGVhZmxldC1pbnRlcmFjdGl2ZVwiKSx0aGlzLl91cGRhdGVTdHlsZSh0KSx0aGlzLl9sYXllcnNbby5zdGFtcCh0KV09dH0sX2FkZFBhdGg6ZnVuY3Rpb24odCl7dGhpcy5fcm9vdEdyb3VwLmFwcGVuZENoaWxkKHQuX3BhdGgpLHQuYWRkSW50ZXJhY3RpdmVUYXJnZXQodC5fcGF0aCl9LF9yZW1vdmVQYXRoOmZ1bmN0aW9uKHQpe28uRG9tVXRpbC5yZW1vdmUodC5fcGF0aCksdC5yZW1vdmVJbnRlcmFjdGl2ZVRhcmdldCh0Ll9wYXRoKSxkZWxldGUgdGhpcy5fbGF5ZXJzW28uc3RhbXAodCldfSxfdXBkYXRlUGF0aDpmdW5jdGlvbih0KXt0Ll9wcm9qZWN0KCksdC5fdXBkYXRlKCl9LF91cGRhdGVTdHlsZTpmdW5jdGlvbih0KXt2YXIgZT10Ll9wYXRoLGk9dC5vcHRpb25zO2UmJihpLnN0cm9rZT8oZS5zZXRBdHRyaWJ1dGUoXCJzdHJva2VcIixpLmNvbG9yKSxlLnNldEF0dHJpYnV0ZShcInN0cm9rZS1vcGFjaXR5XCIsaS5vcGFjaXR5KSxlLnNldEF0dHJpYnV0ZShcInN0cm9rZS13aWR0aFwiLGkud2VpZ2h0KSxlLnNldEF0dHJpYnV0ZShcInN0cm9rZS1saW5lY2FwXCIsaS5saW5lQ2FwKSxlLnNldEF0dHJpYnV0ZShcInN0cm9rZS1saW5lam9pblwiLGkubGluZUpvaW4pLGkuZGFzaEFycmF5P2Uuc2V0QXR0cmlidXRlKFwic3Ryb2tlLWRhc2hhcnJheVwiLGkuZGFzaEFycmF5KTplLnJlbW92ZUF0dHJpYnV0ZShcInN0cm9rZS1kYXNoYXJyYXlcIiksaS5kYXNoT2Zmc2V0P2Uuc2V0QXR0cmlidXRlKFwic3Ryb2tlLWRhc2hvZmZzZXRcIixpLmRhc2hPZmZzZXQpOmUucmVtb3ZlQXR0cmlidXRlKFwic3Ryb2tlLWRhc2hvZmZzZXRcIikpOmUuc2V0QXR0cmlidXRlKFwic3Ryb2tlXCIsXCJub25lXCIpLGkuZmlsbD8oZS5zZXRBdHRyaWJ1dGUoXCJmaWxsXCIsaS5maWxsQ29sb3J8fGkuY29sb3IpLGUuc2V0QXR0cmlidXRlKFwiZmlsbC1vcGFjaXR5XCIsaS5maWxsT3BhY2l0eSksZS5zZXRBdHRyaWJ1dGUoXCJmaWxsLXJ1bGVcIixpLmZpbGxSdWxlfHxcImV2ZW5vZGRcIikpOmUuc2V0QXR0cmlidXRlKFwiZmlsbFwiLFwibm9uZVwiKSl9LF91cGRhdGVQb2x5OmZ1bmN0aW9uKHQsZSl7dGhpcy5fc2V0UGF0aCh0LG8uU1ZHLnBvaW50c1RvUGF0aCh0Ll9wYXJ0cyxlKSl9LF91cGRhdGVDaXJjbGU6ZnVuY3Rpb24odCl7dmFyIGU9dC5fcG9pbnQsaT10Ll9yYWRpdXMsbj10Ll9yYWRpdXNZfHxpLG89XCJhXCIraStcIixcIituK1wiIDAgMSwwIFwiLHM9dC5fZW1wdHkoKT9cIk0wIDBcIjpcIk1cIisoZS54LWkpK1wiLFwiK2UueStvKzIqaStcIiwwIFwiK28rMiotaStcIiwwIFwiO3RoaXMuX3NldFBhdGgodCxzKX0sX3NldFBhdGg6ZnVuY3Rpb24odCxlKXt0Ll9wYXRoLnNldEF0dHJpYnV0ZShcImRcIixlKX0sX2JyaW5nVG9Gcm9udDpmdW5jdGlvbih0KXtvLkRvbVV0aWwudG9Gcm9udCh0Ll9wYXRoKX0sX2JyaW5nVG9CYWNrOmZ1bmN0aW9uKHQpe28uRG9tVXRpbC50b0JhY2sodC5fcGF0aCl9fSksby5leHRlbmQoby5TVkcse2NyZWF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLHQpfSxwb2ludHNUb1BhdGg6ZnVuY3Rpb24odCxlKXt2YXIgaSxuLHMscixhLGgsbD1cIlwiO2ZvcihpPTAscz10Lmxlbmd0aDtpPHM7aSsrKXtmb3IoYT10W2ldLG49MCxyPWEubGVuZ3RoO248cjtuKyspaD1hW25dLGwrPShuP1wiTFwiOlwiTVwiKStoLngrXCIgXCIraC55O2wrPWU/by5Ccm93c2VyLnN2Zz9cInpcIjpcInhcIjpcIlwifXJldHVybiBsfHxcIk0wIDBcIn19KSxvLkJyb3dzZXIuc3ZnPSEoIWUuY3JlYXRlRWxlbWVudE5TfHwhby5TVkcuY3JlYXRlKFwic3ZnXCIpLmNyZWF0ZVNWR1JlY3QpLG8uc3ZnPWZ1bmN0aW9uKHQpe3JldHVybiBvLkJyb3dzZXIuc3ZnfHxvLkJyb3dzZXIudm1sP25ldyBvLlNWRyh0KTpudWxsfSxvLkJyb3dzZXIudm1sPSFvLkJyb3dzZXIuc3ZnJiZmdW5jdGlvbigpe3RyeXt2YXIgdD1lLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dC5pbm5lckhUTUw9Jzx2OnNoYXBlIGFkaj1cIjFcIi8+Jzt2YXIgaT10LmZpcnN0Q2hpbGQ7cmV0dXJuIGkuc3R5bGUuYmVoYXZpb3I9XCJ1cmwoI2RlZmF1bHQjVk1MKVwiLGkmJlwib2JqZWN0XCI9PXR5cGVvZiBpLmFkan1jYXRjaCh0KXtyZXR1cm4hMX19KCksby5TVkcuaW5jbHVkZShvLkJyb3dzZXIudm1sP3tfaW5pdENvbnRhaW5lcjpmdW5jdGlvbigpe3RoaXMuX2NvbnRhaW5lcj1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsXCJsZWFmbGV0LXZtbC1jb250YWluZXJcIil9LF91cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLl9tYXAuX2FuaW1hdGluZ1pvb218fChvLlJlbmRlcmVyLnByb3RvdHlwZS5fdXBkYXRlLmNhbGwodGhpcyksdGhpcy5maXJlKFwidXBkYXRlXCIpKX0sX2luaXRQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPXQuX2NvbnRhaW5lcj1vLlNWRy5jcmVhdGUoXCJzaGFwZVwiKTtvLkRvbVV0aWwuYWRkQ2xhc3MoZSxcImxlYWZsZXQtdm1sLXNoYXBlIFwiKyh0aGlzLm9wdGlvbnMuY2xhc3NOYW1lfHxcIlwiKSksZS5jb29yZHNpemU9XCIxIDFcIix0Ll9wYXRoPW8uU1ZHLmNyZWF0ZShcInBhdGhcIiksZS5hcHBlbmRDaGlsZCh0Ll9wYXRoKSx0aGlzLl91cGRhdGVTdHlsZSh0KSx0aGlzLl9sYXllcnNbby5zdGFtcCh0KV09dH0sX2FkZFBhdGg6ZnVuY3Rpb24odCl7dmFyIGU9dC5fY29udGFpbmVyO3RoaXMuX2NvbnRhaW5lci5hcHBlbmRDaGlsZChlKSx0Lm9wdGlvbnMuaW50ZXJhY3RpdmUmJnQuYWRkSW50ZXJhY3RpdmVUYXJnZXQoZSl9LF9yZW1vdmVQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPXQuX2NvbnRhaW5lcjtvLkRvbVV0aWwucmVtb3ZlKGUpLHQucmVtb3ZlSW50ZXJhY3RpdmVUYXJnZXQoZSksZGVsZXRlIHRoaXMuX2xheWVyc1tvLnN0YW1wKHQpXX0sX3VwZGF0ZVN0eWxlOmZ1bmN0aW9uKHQpe3ZhciBlPXQuX3N0cm9rZSxpPXQuX2ZpbGwsbj10Lm9wdGlvbnMscz10Ll9jb250YWluZXI7cy5zdHJva2VkPSEhbi5zdHJva2Uscy5maWxsZWQ9ISFuLmZpbGwsbi5zdHJva2U/KGV8fChlPXQuX3N0cm9rZT1vLlNWRy5jcmVhdGUoXCJzdHJva2VcIikpLHMuYXBwZW5kQ2hpbGQoZSksZS53ZWlnaHQ9bi53ZWlnaHQrXCJweFwiLGUuY29sb3I9bi5jb2xvcixlLm9wYWNpdHk9bi5vcGFjaXR5LG4uZGFzaEFycmF5P2UuZGFzaFN0eWxlPW8uVXRpbC5pc0FycmF5KG4uZGFzaEFycmF5KT9uLmRhc2hBcnJheS5qb2luKFwiIFwiKTpuLmRhc2hBcnJheS5yZXBsYWNlKC8oICosICopL2csXCIgXCIpOmUuZGFzaFN0eWxlPVwiXCIsZS5lbmRjYXA9bi5saW5lQ2FwLnJlcGxhY2UoXCJidXR0XCIsXCJmbGF0XCIpLGUuam9pbnN0eWxlPW4ubGluZUpvaW4pOmUmJihzLnJlbW92ZUNoaWxkKGUpLHQuX3N0cm9rZT1udWxsKSxuLmZpbGw/KGl8fChpPXQuX2ZpbGw9by5TVkcuY3JlYXRlKFwiZmlsbFwiKSkscy5hcHBlbmRDaGlsZChpKSxpLmNvbG9yPW4uZmlsbENvbG9yfHxuLmNvbG9yLGkub3BhY2l0eT1uLmZpbGxPcGFjaXR5KTppJiYocy5yZW1vdmVDaGlsZChpKSx0Ll9maWxsPW51bGwpfSxfdXBkYXRlQ2lyY2xlOmZ1bmN0aW9uKHQpe3ZhciBlPXQuX3BvaW50LnJvdW5kKCksaT1NYXRoLnJvdW5kKHQuX3JhZGl1cyksbj1NYXRoLnJvdW5kKHQuX3JhZGl1c1l8fGkpO3RoaXMuX3NldFBhdGgodCx0Ll9lbXB0eSgpP1wiTTAgMFwiOlwiQUwgXCIrZS54K1wiLFwiK2UueStcIiBcIitpK1wiLFwiK24rXCIgMCwyMzU5MjYwMFwiKX0sX3NldFBhdGg6ZnVuY3Rpb24odCxlKXt0Ll9wYXRoLnY9ZX0sX2JyaW5nVG9Gcm9udDpmdW5jdGlvbih0KXtvLkRvbVV0aWwudG9Gcm9udCh0Ll9jb250YWluZXIpfSxfYnJpbmdUb0JhY2s6ZnVuY3Rpb24odCl7by5Eb21VdGlsLnRvQmFjayh0Ll9jb250YWluZXIpfX06e30pLG8uQnJvd3Nlci52bWwmJihvLlNWRy5jcmVhdGU9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIGUubmFtZXNwYWNlcy5hZGQoXCJsdm1sXCIsXCJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbFwiKSxmdW5jdGlvbih0KXtyZXR1cm4gZS5jcmVhdGVFbGVtZW50KFwiPGx2bWw6XCIrdCsnIGNsYXNzPVwibHZtbFwiPicpfX1jYXRjaCh0KXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGUuY3JlYXRlRWxlbWVudChcIjxcIit0KycgeG1sbnM9XCJ1cm46c2NoZW1hcy1taWNyb3NvZnQuY29tOnZtbFwiIGNsYXNzPVwibHZtbFwiPicpfX19KCkpLG8uQ2FudmFzPW8uUmVuZGVyZXIuZXh0ZW5kKHtnZXRFdmVudHM6ZnVuY3Rpb24oKXt2YXIgdD1vLlJlbmRlcmVyLnByb3RvdHlwZS5nZXRFdmVudHMuY2FsbCh0aGlzKTtyZXR1cm4gdC52aWV3cHJlcmVzZXQ9dGhpcy5fb25WaWV3UHJlUmVzZXQsdH0sX29uVmlld1ByZVJlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fcG9zdHBvbmVVcGRhdGVQYXRocz0hMH0sb25BZGQ6ZnVuY3Rpb24oKXtvLlJlbmRlcmVyLnByb3RvdHlwZS5vbkFkZC5jYWxsKHRoaXMpLHRoaXMuX2RyYXcoKX0sX2luaXRDb250YWluZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9jb250YWluZXI9ZS5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO28uRG9tRXZlbnQub24odCxcIm1vdXNlbW92ZVwiLG8uVXRpbC50aHJvdHRsZSh0aGlzLl9vbk1vdXNlTW92ZSwzMix0aGlzKSx0aGlzKS5vbih0LFwiY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgY29udGV4dG1lbnVcIix0aGlzLl9vbkNsaWNrLHRoaXMpLm9uKHQsXCJtb3VzZW91dFwiLHRoaXMuX2hhbmRsZU1vdXNlT3V0LHRoaXMpLHRoaXMuX2N0eD10LmdldENvbnRleHQoXCIyZFwiKX0sX3VwZGF0ZVBhdGhzOmZ1bmN0aW9uKCl7aWYoIXRoaXMuX3Bvc3Rwb25lVXBkYXRlUGF0aHMpe3ZhciB0O3RoaXMuX3JlZHJhd0JvdW5kcz1udWxsO2Zvcih2YXIgZSBpbiB0aGlzLl9sYXllcnMpdD10aGlzLl9sYXllcnNbZV0sdC5fdXBkYXRlKCk7dGhpcy5fcmVkcmF3KCl9fSxfdXBkYXRlOmZ1bmN0aW9uKCl7aWYoIXRoaXMuX21hcC5fYW5pbWF0aW5nWm9vbXx8IXRoaXMuX2JvdW5kcyl7dGhpcy5fZHJhd25MYXllcnM9e30sby5SZW5kZXJlci5wcm90b3R5cGUuX3VwZGF0ZS5jYWxsKHRoaXMpO3ZhciB0PXRoaXMuX2JvdW5kcyxlPXRoaXMuX2NvbnRhaW5lcixpPXQuZ2V0U2l6ZSgpLG49by5Ccm93c2VyLnJldGluYT8yOjE7by5Eb21VdGlsLnNldFBvc2l0aW9uKGUsdC5taW4pLGUud2lkdGg9bippLngsZS5oZWlnaHQ9bippLnksZS5zdHlsZS53aWR0aD1pLngrXCJweFwiLGUuc3R5bGUuaGVpZ2h0PWkueStcInB4XCIsby5Ccm93c2VyLnJldGluYSYmdGhpcy5fY3R4LnNjYWxlKDIsMiksdGhpcy5fY3R4LnRyYW5zbGF0ZSgtdC5taW4ueCwtdC5taW4ueSksdGhpcy5maXJlKFwidXBkYXRlXCIpfX0sX3Jlc2V0OmZ1bmN0aW9uKCl7by5SZW5kZXJlci5wcm90b3R5cGUuX3Jlc2V0LmNhbGwodGhpcyksdGhpcy5fcG9zdHBvbmVVcGRhdGVQYXRocyYmKHRoaXMuX3Bvc3Rwb25lVXBkYXRlUGF0aHM9ITEsdGhpcy5fdXBkYXRlUGF0aHMoKSl9LF9pbml0UGF0aDpmdW5jdGlvbih0KXt0aGlzLl91cGRhdGVEYXNoQXJyYXkodCksdGhpcy5fbGF5ZXJzW28uc3RhbXAodCldPXQ7dmFyIGU9dC5fb3JkZXI9e2xheWVyOnQscHJldjp0aGlzLl9kcmF3TGFzdCxuZXh0Om51bGx9O3RoaXMuX2RyYXdMYXN0JiYodGhpcy5fZHJhd0xhc3QubmV4dD1lKSx0aGlzLl9kcmF3TGFzdD1lLHRoaXMuX2RyYXdGaXJzdD10aGlzLl9kcmF3Rmlyc3R8fHRoaXMuX2RyYXdMYXN0fSxfYWRkUGF0aDpmdW5jdGlvbih0KXt0aGlzLl9yZXF1ZXN0UmVkcmF3KHQpfSxfcmVtb3ZlUGF0aDpmdW5jdGlvbih0KXt2YXIgZT10Ll9vcmRlcixpPWUubmV4dCxuPWUucHJldjtpP2kucHJldj1uOnRoaXMuX2RyYXdMYXN0PW4sbj9uLm5leHQ9aTp0aGlzLl9kcmF3Rmlyc3Q9aSxkZWxldGUgdC5fb3JkZXIsZGVsZXRlIHRoaXMuX2xheWVyc1tvLnN0YW1wKHQpXSx0aGlzLl9yZXF1ZXN0UmVkcmF3KHQpfSxfdXBkYXRlUGF0aDpmdW5jdGlvbih0KXt0aGlzLl9leHRlbmRSZWRyYXdCb3VuZHModCksdC5fcHJvamVjdCgpLHQuX3VwZGF0ZSgpLHRoaXMuX3JlcXVlc3RSZWRyYXcodCl9LF91cGRhdGVTdHlsZTpmdW5jdGlvbih0KXt0aGlzLl91cGRhdGVEYXNoQXJyYXkodCksdGhpcy5fcmVxdWVzdFJlZHJhdyh0KX0sX3VwZGF0ZURhc2hBcnJheTpmdW5jdGlvbih0KXtpZih0Lm9wdGlvbnMuZGFzaEFycmF5KXt2YXIgZSxpPXQub3B0aW9ucy5kYXNoQXJyYXkuc3BsaXQoXCIsXCIpLG49W107Zm9yKGU9MDtlPGkubGVuZ3RoO2UrKyluLnB1c2goTnVtYmVyKGlbZV0pKTt0Lm9wdGlvbnMuX2Rhc2hBcnJheT1ufX0sX3JlcXVlc3RSZWRyYXc6ZnVuY3Rpb24odCl7dGhpcy5fbWFwJiYodGhpcy5fZXh0ZW5kUmVkcmF3Qm91bmRzKHQpLHRoaXMuX3JlZHJhd1JlcXVlc3Q9dGhpcy5fcmVkcmF3UmVxdWVzdHx8by5VdGlsLnJlcXVlc3RBbmltRnJhbWUodGhpcy5fcmVkcmF3LHRoaXMpKX0sX2V4dGVuZFJlZHJhd0JvdW5kczpmdW5jdGlvbih0KXt2YXIgZT0odC5vcHRpb25zLndlaWdodHx8MCkrMTt0aGlzLl9yZWRyYXdCb3VuZHM9dGhpcy5fcmVkcmF3Qm91bmRzfHxuZXcgby5Cb3VuZHMsdGhpcy5fcmVkcmF3Qm91bmRzLmV4dGVuZCh0Ll9weEJvdW5kcy5taW4uc3VidHJhY3QoW2UsZV0pKSx0aGlzLl9yZWRyYXdCb3VuZHMuZXh0ZW5kKHQuX3B4Qm91bmRzLm1heC5hZGQoW2UsZV0pKX0sX3JlZHJhdzpmdW5jdGlvbigpe3RoaXMuX3JlZHJhd1JlcXVlc3Q9bnVsbCx0aGlzLl9yZWRyYXdCb3VuZHMmJih0aGlzLl9yZWRyYXdCb3VuZHMubWluLl9mbG9vcigpLHRoaXMuX3JlZHJhd0JvdW5kcy5tYXguX2NlaWwoKSksdGhpcy5fY2xlYXIoKSx0aGlzLl9kcmF3KCksdGhpcy5fcmVkcmF3Qm91bmRzPW51bGx9LF9jbGVhcjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3JlZHJhd0JvdW5kcztpZih0KXt2YXIgZT10LmdldFNpemUoKTt0aGlzLl9jdHguY2xlYXJSZWN0KHQubWluLngsdC5taW4ueSxlLngsZS55KX1lbHNlIHRoaXMuX2N0eC5jbGVhclJlY3QoMCwwLHRoaXMuX2NvbnRhaW5lci53aWR0aCx0aGlzLl9jb250YWluZXIuaGVpZ2h0KX0sX2RyYXc6ZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMuX3JlZHJhd0JvdW5kcztpZih0aGlzLl9jdHguc2F2ZSgpLGUpe3ZhciBpPWUuZ2V0U2l6ZSgpO3RoaXMuX2N0eC5iZWdpblBhdGgoKSx0aGlzLl9jdHgucmVjdChlLm1pbi54LGUubWluLnksaS54LGkueSksdGhpcy5fY3R4LmNsaXAoKX10aGlzLl9kcmF3aW5nPSEwO2Zvcih2YXIgbj10aGlzLl9kcmF3Rmlyc3Q7bjtuPW4ubmV4dCl0PW4ubGF5ZXIsKCFlfHx0Ll9weEJvdW5kcyYmdC5fcHhCb3VuZHMuaW50ZXJzZWN0cyhlKSkmJnQuX3VwZGF0ZVBhdGgoKTt0aGlzLl9kcmF3aW5nPSExLHRoaXMuX2N0eC5yZXN0b3JlKCl9LF91cGRhdGVQb2x5OmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fZHJhd2luZyl7dmFyIGksbixvLHMscj10Ll9wYXJ0cyxhPXIubGVuZ3RoLGg9dGhpcy5fY3R4O2lmKGEpe2Zvcih0aGlzLl9kcmF3bkxheWVyc1t0Ll9sZWFmbGV0X2lkXT10LGguYmVnaW5QYXRoKCksaC5zZXRMaW5lRGFzaCYmaC5zZXRMaW5lRGFzaCh0Lm9wdGlvbnMmJnQub3B0aW9ucy5fZGFzaEFycmF5fHxbXSksaT0wO2k8YTtpKyspe2ZvcihuPTAsbz1yW2ldLmxlbmd0aDtuPG87bisrKXM9cltpXVtuXSxoW24/XCJsaW5lVG9cIjpcIm1vdmVUb1wiXShzLngscy55KTtlJiZoLmNsb3NlUGF0aCgpfXRoaXMuX2ZpbGxTdHJva2UoaCx0KX19fSxfdXBkYXRlQ2lyY2xlOmZ1bmN0aW9uKHQpe2lmKHRoaXMuX2RyYXdpbmcmJiF0Ll9lbXB0eSgpKXt2YXIgZT10Ll9wb2ludCxpPXRoaXMuX2N0eCxuPXQuX3JhZGl1cyxvPSh0Ll9yYWRpdXNZfHxuKS9uO3RoaXMuX2RyYXduTGF5ZXJzW3QuX2xlYWZsZXRfaWRdPXQsMSE9PW8mJihpLnNhdmUoKSxpLnNjYWxlKDEsbykpLGkuYmVnaW5QYXRoKCksaS5hcmMoZS54LGUueS9vLG4sMCwyKk1hdGguUEksITEpLDEhPT1vJiZpLnJlc3RvcmUoKSx0aGlzLl9maWxsU3Ryb2tlKGksdCl9fSxfZmlsbFN0cm9rZTpmdW5jdGlvbih0LGUpe3ZhciBpPWUub3B0aW9ucztpLmZpbGwmJih0Lmdsb2JhbEFscGhhPWkuZmlsbE9wYWNpdHksdC5maWxsU3R5bGU9aS5maWxsQ29sb3J8fGkuY29sb3IsdC5maWxsKGkuZmlsbFJ1bGV8fFwiZXZlbm9kZFwiKSksaS5zdHJva2UmJjAhPT1pLndlaWdodCYmKHQuZ2xvYmFsQWxwaGE9aS5vcGFjaXR5LHQubGluZVdpZHRoPWkud2VpZ2h0LHQuc3Ryb2tlU3R5bGU9aS5jb2xvcix0LmxpbmVDYXA9aS5saW5lQ2FwLHQubGluZUpvaW49aS5saW5lSm9pbix0LnN0cm9rZSgpKX0sX29uQ2xpY2s6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGksbj10aGlzLl9tYXAubW91c2VFdmVudFRvTGF5ZXJQb2ludCh0KSxzPXRoaXMuX2RyYXdGaXJzdDtzO3M9cy5uZXh0KWU9cy5sYXllcixlLm9wdGlvbnMuaW50ZXJhY3RpdmUmJmUuX2NvbnRhaW5zUG9pbnQobikmJiF0aGlzLl9tYXAuX2RyYWdnYWJsZU1vdmVkKGUpJiYoaT1lKTtpJiYoby5Eb21FdmVudC5fZmFrZVN0b3AodCksdGhpcy5fZmlyZUV2ZW50KFtpXSx0KSl9LF9vbk1vdXNlTW92ZTpmdW5jdGlvbih0KXtpZih0aGlzLl9tYXAmJiF0aGlzLl9tYXAuZHJhZ2dpbmcubW92aW5nKCkmJiF0aGlzLl9tYXAuX2FuaW1hdGluZ1pvb20pe3ZhciBlPXRoaXMuX21hcC5tb3VzZUV2ZW50VG9MYXllclBvaW50KHQpO3RoaXMuX2hhbmRsZU1vdXNlSG92ZXIodCxlKX19LF9oYW5kbGVNb3VzZU91dDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9ob3ZlcmVkTGF5ZXI7ZSYmKG8uRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl9jb250YWluZXIsXCJsZWFmbGV0LWludGVyYWN0aXZlXCIpLHRoaXMuX2ZpcmVFdmVudChbZV0sdCxcIm1vdXNlb3V0XCIpLHRoaXMuX2hvdmVyZWRMYXllcj1udWxsKX0sX2hhbmRsZU1vdXNlSG92ZXI6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGksbixzPXRoaXMuX2RyYXdGaXJzdDtzO3M9cy5uZXh0KWk9cy5sYXllcixpLm9wdGlvbnMuaW50ZXJhY3RpdmUmJmkuX2NvbnRhaW5zUG9pbnQoZSkmJihuPWkpO24hPT10aGlzLl9ob3ZlcmVkTGF5ZXImJih0aGlzLl9oYW5kbGVNb3VzZU91dCh0KSxuJiYoby5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX2NvbnRhaW5lcixcImxlYWZsZXQtaW50ZXJhY3RpdmVcIiksdGhpcy5fZmlyZUV2ZW50KFtuXSx0LFwibW91c2VvdmVyXCIpLHRoaXMuX2hvdmVyZWRMYXllcj1uKSksdGhpcy5faG92ZXJlZExheWVyJiZ0aGlzLl9maXJlRXZlbnQoW3RoaXMuX2hvdmVyZWRMYXllcl0sdCl9LF9maXJlRXZlbnQ6ZnVuY3Rpb24odCxlLGkpe3RoaXMuX21hcC5fZmlyZURPTUV2ZW50KGUsaXx8ZS50eXBlLHQpfSxfYnJpbmdUb0Zyb250OmZ1bmN0aW9uKHQpe3ZhciBlPXQuX29yZGVyLGk9ZS5uZXh0LG49ZS5wcmV2O2kmJihpLnByZXY9bixuP24ubmV4dD1pOmkmJih0aGlzLl9kcmF3Rmlyc3Q9aSksZS5wcmV2PXRoaXMuX2RyYXdMYXN0LHRoaXMuX2RyYXdMYXN0Lm5leHQ9ZSxlLm5leHQ9bnVsbCx0aGlzLl9kcmF3TGFzdD1lLHRoaXMuX3JlcXVlc3RSZWRyYXcodCkpfSxfYnJpbmdUb0JhY2s6ZnVuY3Rpb24odCl7dmFyIGU9dC5fb3JkZXIsaT1lLm5leHQsbj1lLnByZXY7biYmKG4ubmV4dD1pLGk/aS5wcmV2PW46biYmKHRoaXMuX2RyYXdMYXN0PW4pLGUucHJldj1udWxsLGUubmV4dD10aGlzLl9kcmF3Rmlyc3QsdGhpcy5fZHJhd0ZpcnN0LnByZXY9ZSx0aGlzLl9kcmF3Rmlyc3Q9ZSx0aGlzLl9yZXF1ZXN0UmVkcmF3KHQpKX19KSxvLkJyb3dzZXIuY2FudmFzPWZ1bmN0aW9uKCl7cmV0dXJuISFlLmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikuZ2V0Q29udGV4dH0oKSxvLmNhbnZhcz1mdW5jdGlvbih0KXtyZXR1cm4gby5Ccm93c2VyLmNhbnZhcz9uZXcgby5DYW52YXModCk6bnVsbH0sby5Qb2x5bGluZS5wcm90b3R5cGUuX2NvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24odCxlKXt2YXIgaSxuLHMscixhLGgsbD10aGlzLl9jbGlja1RvbGVyYW5jZSgpO2lmKCF0aGlzLl9weEJvdW5kcy5jb250YWlucyh0KSlyZXR1cm4hMTtmb3IoaT0wLHI9dGhpcy5fcGFydHMubGVuZ3RoO2k8cjtpKyspZm9yKGg9dGhpcy5fcGFydHNbaV0sbj0wLGE9aC5sZW5ndGgscz1hLTE7bjxhO3M9bisrKWlmKChlfHwwIT09bikmJm8uTGluZVV0aWwucG9pbnRUb1NlZ21lbnREaXN0YW5jZSh0LGhbc10saFtuXSk8PWwpcmV0dXJuITA7cmV0dXJuITF9LG8uUG9seWdvbi5wcm90b3R5cGUuX2NvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24odCl7dmFyIGUsaSxuLHMscixhLGgsbCx1PSExO2lmKCF0aGlzLl9weEJvdW5kcy5jb250YWlucyh0KSlyZXR1cm4hMTtmb3Iocz0wLGg9dGhpcy5fcGFydHMubGVuZ3RoO3M8aDtzKyspZm9yKGU9dGhpcy5fcGFydHNbc10scj0wLGw9ZS5sZW5ndGgsYT1sLTE7cjxsO2E9cisrKWk9ZVtyXSxuPWVbYV0saS55PnQueSE9bi55PnQueSYmdC54PChuLngtaS54KSoodC55LWkueSkvKG4ueS1pLnkpK2kueCYmKHU9IXUpO3JldHVybiB1fHxvLlBvbHlsaW5lLnByb3RvdHlwZS5fY29udGFpbnNQb2ludC5jYWxsKHRoaXMsdCwhMCl9LG8uQ2lyY2xlTWFya2VyLnByb3RvdHlwZS5fY29udGFpbnNQb2ludD1mdW5jdGlvbih0KXtyZXR1cm4gdC5kaXN0YW5jZVRvKHRoaXMuX3BvaW50KTw9dGhpcy5fcmFkaXVzK3RoaXMuX2NsaWNrVG9sZXJhbmNlKCl9LG8uR2VvSlNPTj1vLkZlYXR1cmVHcm91cC5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtvLnNldE9wdGlvbnModGhpcyxlKSx0aGlzLl9sYXllcnM9e30sdCYmdGhpcy5hZGREYXRhKHQpfSxhZGREYXRhOmZ1bmN0aW9uKHQpe3ZhciBlLGksbixzPW8uVXRpbC5pc0FycmF5KHQpP3Q6dC5mZWF0dXJlcztpZihzKXtmb3IoZT0wLGk9cy5sZW5ndGg7ZTxpO2UrKyluPXNbZV0sKG4uZ2VvbWV0cmllc3x8bi5nZW9tZXRyeXx8bi5mZWF0dXJlc3x8bi5jb29yZGluYXRlcykmJnRoaXMuYWRkRGF0YShuKTtyZXR1cm4gdGhpc312YXIgcj10aGlzLm9wdGlvbnM7aWYoci5maWx0ZXImJiFyLmZpbHRlcih0KSlyZXR1cm4gdGhpczt2YXIgYT1vLkdlb0pTT04uZ2VvbWV0cnlUb0xheWVyKHQscik7cmV0dXJuIGE/KGEuZmVhdHVyZT1vLkdlb0pTT04uYXNGZWF0dXJlKHQpLGEuZGVmYXVsdE9wdGlvbnM9YS5vcHRpb25zLHRoaXMucmVzZXRTdHlsZShhKSxyLm9uRWFjaEZlYXR1cmUmJnIub25FYWNoRmVhdHVyZSh0LGEpLHRoaXMuYWRkTGF5ZXIoYSkpOnRoaXN9LHJlc2V0U3R5bGU6ZnVuY3Rpb24odCl7cmV0dXJuIHQub3B0aW9ucz1vLlV0aWwuZXh0ZW5kKHt9LHQuZGVmYXVsdE9wdGlvbnMpLHRoaXMuX3NldExheWVyU3R5bGUodCx0aGlzLm9wdGlvbnMuc3R5bGUpLHRoaXN9LHNldFN0eWxlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmVhY2hMYXllcihmdW5jdGlvbihlKXt0aGlzLl9zZXRMYXllclN0eWxlKGUsdCl9LHRoaXMpfSxfc2V0TGF5ZXJTdHlsZTpmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGUmJihlPWUodC5mZWF0dXJlKSksdC5zZXRTdHlsZSYmdC5zZXRTdHlsZShlKX19KSxvLmV4dGVuZChvLkdlb0pTT04se2dlb21ldHJ5VG9MYXllcjpmdW5jdGlvbih0LGUpe3ZhciBpLG4scyxyLGE9XCJGZWF0dXJlXCI9PT10LnR5cGU/dC5nZW9tZXRyeTp0LGg9YT9hLmNvb3JkaW5hdGVzOm51bGwsbD1bXSx1PWUmJmUucG9pbnRUb0xheWVyLGM9ZSYmZS5jb29yZHNUb0xhdExuZ3x8dGhpcy5jb29yZHNUb0xhdExuZztpZighaCYmIWEpcmV0dXJuIG51bGw7c3dpdGNoKGEudHlwZSl7Y2FzZVwiUG9pbnRcIjpyZXR1cm4gaT1jKGgpLHU/dSh0LGkpOm5ldyBvLk1hcmtlcihpKTtjYXNlXCJNdWx0aVBvaW50XCI6Zm9yKHM9MCxyPWgubGVuZ3RoO3M8cjtzKyspaT1jKGhbc10pLGwucHVzaCh1P3UodCxpKTpuZXcgby5NYXJrZXIoaSkpO3JldHVybiBuZXcgby5GZWF0dXJlR3JvdXAobCk7Y2FzZVwiTGluZVN0cmluZ1wiOmNhc2VcIk11bHRpTGluZVN0cmluZ1wiOnJldHVybiBuPXRoaXMuY29vcmRzVG9MYXRMbmdzKGgsXCJMaW5lU3RyaW5nXCI9PT1hLnR5cGU/MDoxLGMpLG5ldyBvLlBvbHlsaW5lKG4sZSk7Y2FzZVwiUG9seWdvblwiOmNhc2VcIk11bHRpUG9seWdvblwiOnJldHVybiBuPXRoaXMuY29vcmRzVG9MYXRMbmdzKGgsXCJQb2x5Z29uXCI9PT1hLnR5cGU/MToyLGMpLG5ldyBvLlBvbHlnb24obixlKTtjYXNlXCJHZW9tZXRyeUNvbGxlY3Rpb25cIjpmb3Iocz0wLHI9YS5nZW9tZXRyaWVzLmxlbmd0aDtzPHI7cysrKXt2YXIgZD10aGlzLmdlb21ldHJ5VG9MYXllcih7Z2VvbWV0cnk6YS5nZW9tZXRyaWVzW3NdLHR5cGU6XCJGZWF0dXJlXCIscHJvcGVydGllczp0LnByb3BlcnRpZXN9LGUpO2QmJmwucHVzaChkKX1yZXR1cm4gbmV3IG8uRmVhdHVyZUdyb3VwKGwpO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBHZW9KU09OIG9iamVjdC5cIil9fSxjb29yZHNUb0xhdExuZzpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8uTGF0TG5nKHRbMV0sdFswXSx0WzJdKX0sY29vcmRzVG9MYXRMbmdzOmZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIG4sbz1bXSxzPTAscj10Lmxlbmd0aDtzPHI7cysrKW49ZT90aGlzLmNvb3Jkc1RvTGF0TG5ncyh0W3NdLGUtMSxpKTooaXx8dGhpcy5jb29yZHNUb0xhdExuZykodFtzXSksby5wdXNoKG4pO3JldHVybiBvfSxsYXRMbmdUb0Nvb3JkczpmdW5jdGlvbih0KXtyZXR1cm4gdC5hbHQhPT1pP1t0LmxuZyx0LmxhdCx0LmFsdF06W3QubG5nLHQubGF0XX0sbGF0TG5nc1RvQ29vcmRzOmZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIG49W10scz0wLHI9dC5sZW5ndGg7czxyO3MrKyluLnB1c2goZT9vLkdlb0pTT04ubGF0TG5nc1RvQ29vcmRzKHRbc10sZS0xLGkpOm8uR2VvSlNPTi5sYXRMbmdUb0Nvb3Jkcyh0W3NdKSk7cmV0dXJuIWUmJmkmJm4ucHVzaChuWzBdKSxufSxnZXRGZWF0dXJlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuZmVhdHVyZT9vLmV4dGVuZCh7fSx0LmZlYXR1cmUse2dlb21ldHJ5OmV9KTpvLkdlb0pTT04uYXNGZWF0dXJlKGUpfSxhc0ZlYXR1cmU6ZnVuY3Rpb24odCl7cmV0dXJuXCJGZWF0dXJlXCI9PT10LnR5cGV8fFwiRmVhdHVyZUNvbGxlY3Rpb25cIj09PXQudHlwZT90Ont0eXBlOlwiRmVhdHVyZVwiLHByb3BlcnRpZXM6e30sZ2VvbWV0cnk6dH19fSk7dmFyIGE9e3RvR2VvSlNPTjpmdW5jdGlvbigpe3JldHVybiBvLkdlb0pTT04uZ2V0RmVhdHVyZSh0aGlzLHt0eXBlOlwiUG9pbnRcIixjb29yZGluYXRlczpvLkdlb0pTT04ubGF0TG5nVG9Db29yZHModGhpcy5nZXRMYXRMbmcoKSl9KX19O28uTWFya2VyLmluY2x1ZGUoYSksby5DaXJjbGUuaW5jbHVkZShhKSxvLkNpcmNsZU1hcmtlci5pbmNsdWRlKGEpLG8uUG9seWxpbmUucHJvdG90eXBlLnRvR2VvSlNPTj1mdW5jdGlvbigpe3ZhciB0PSFvLlBvbHlsaW5lLl9mbGF0KHRoaXMuX2xhdGxuZ3MpLGU9by5HZW9KU09OLmxhdExuZ3NUb0Nvb3Jkcyh0aGlzLl9sYXRsbmdzLHQ/MTowKTtyZXR1cm4gby5HZW9KU09OLmdldEZlYXR1cmUodGhpcyx7dHlwZToodD9cIk11bHRpXCI6XCJcIikrXCJMaW5lU3RyaW5nXCIsY29vcmRpbmF0ZXM6ZX0pfSxvLlBvbHlnb24ucHJvdG90eXBlLnRvR2VvSlNPTj1mdW5jdGlvbigpe3ZhciB0PSFvLlBvbHlsaW5lLl9mbGF0KHRoaXMuX2xhdGxuZ3MpLGU9dCYmIW8uUG9seWxpbmUuX2ZsYXQodGhpcy5fbGF0bG5nc1swXSksaT1vLkdlb0pTT04ubGF0TG5nc1RvQ29vcmRzKHRoaXMuX2xhdGxuZ3MsZT8yOnQ/MTowLCEwKTtyZXR1cm4gdHx8KGk9W2ldKSxvLkdlb0pTT04uZ2V0RmVhdHVyZSh0aGlzLHt0eXBlOihlP1wiTXVsdGlcIjpcIlwiKStcIlBvbHlnb25cIixjb29yZGluYXRlczppfSl9LG8uTGF5ZXJHcm91cC5pbmNsdWRlKHt0b011bHRpUG9pbnQ6ZnVuY3Rpb24oKXt2YXIgdD1bXTtyZXR1cm4gdGhpcy5lYWNoTGF5ZXIoZnVuY3Rpb24oZSl7dC5wdXNoKGUudG9HZW9KU09OKCkuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpfSksby5HZW9KU09OLmdldEZlYXR1cmUodGhpcyx7dHlwZTpcIk11bHRpUG9pbnRcIixjb29yZGluYXRlczp0fSl9LHRvR2VvSlNPTjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZmVhdHVyZSYmdGhpcy5mZWF0dXJlLmdlb21ldHJ5JiZ0aGlzLmZlYXR1cmUuZ2VvbWV0cnkudHlwZTtpZihcIk11bHRpUG9pbnRcIj09PXQpcmV0dXJuIHRoaXMudG9NdWx0aVBvaW50KCk7dmFyIGU9XCJHZW9tZXRyeUNvbGxlY3Rpb25cIj09PXQsaT1bXTtyZXR1cm4gdGhpcy5lYWNoTGF5ZXIoZnVuY3Rpb24odCl7aWYodC50b0dlb0pTT04pe3ZhciBuPXQudG9HZW9KU09OKCk7aS5wdXNoKGU/bi5nZW9tZXRyeTpvLkdlb0pTT04uYXNGZWF0dXJlKG4pKX19KSxlP28uR2VvSlNPTi5nZXRGZWF0dXJlKHRoaXMse2dlb21ldHJpZXM6aSx0eXBlOlwiR2VvbWV0cnlDb2xsZWN0aW9uXCJ9KTp7dHlwZTpcIkZlYXR1cmVDb2xsZWN0aW9uXCIsZmVhdHVyZXM6aX19fSksby5nZW9KU09OPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBvLkdlb0pTT04odCxlKX0sby5nZW9Kc29uPW8uZ2VvSlNPTixvLkRyYWdnYWJsZT1vLkV2ZW50ZWQuZXh0ZW5kKHtvcHRpb25zOntjbGlja1RvbGVyYW5jZTozfSxzdGF0aWNzOntTVEFSVDpvLkJyb3dzZXIudG91Y2g/W1widG91Y2hzdGFydFwiLFwibW91c2Vkb3duXCJdOltcIm1vdXNlZG93blwiXSxFTkQ6e21vdXNlZG93bjpcIm1vdXNldXBcIix0b3VjaHN0YXJ0OlwidG91Y2hlbmRcIixwb2ludGVyZG93bjpcInRvdWNoZW5kXCIsTVNQb2ludGVyRG93bjpcInRvdWNoZW5kXCJ9LE1PVkU6e21vdXNlZG93bjpcIm1vdXNlbW92ZVwiLHRvdWNoc3RhcnQ6XCJ0b3VjaG1vdmVcIixwb2ludGVyZG93bjpcInRvdWNobW92ZVwiLE1TUG9pbnRlckRvd246XCJ0b3VjaG1vdmVcIn19LGluaXRpYWxpemU6ZnVuY3Rpb24odCxlLGkpe3RoaXMuX2VsZW1lbnQ9dCx0aGlzLl9kcmFnU3RhcnRUYXJnZXQ9ZXx8dCx0aGlzLl9wcmV2ZW50T3V0bGluZT1pfSxlbmFibGU6ZnVuY3Rpb24oKXt0aGlzLl9lbmFibGVkfHwoby5Eb21FdmVudC5vbih0aGlzLl9kcmFnU3RhcnRUYXJnZXQsby5EcmFnZ2FibGUuU1RBUlQuam9pbihcIiBcIiksdGhpcy5fb25Eb3duLHRoaXMpLHRoaXMuX2VuYWJsZWQ9ITApfSxkaXNhYmxlOmZ1bmN0aW9uKCl7dGhpcy5fZW5hYmxlZCYmKG8uRHJhZ2dhYmxlLl9kcmFnZ2luZz09PXRoaXMmJnRoaXMuZmluaXNoRHJhZygpLG8uRG9tRXZlbnQub2ZmKHRoaXMuX2RyYWdTdGFydFRhcmdldCxvLkRyYWdnYWJsZS5TVEFSVC5qb2luKFwiIFwiKSx0aGlzLl9vbkRvd24sdGhpcyksdGhpcy5fZW5hYmxlZD0hMSx0aGlzLl9tb3ZlZD0hMSl9LF9vbkRvd246ZnVuY3Rpb24odCl7aWYoIXQuX3NpbXVsYXRlZCYmdGhpcy5fZW5hYmxlZCYmKHRoaXMuX21vdmVkPSExLCFvLkRvbVV0aWwuaGFzQ2xhc3ModGhpcy5fZWxlbWVudCxcImxlYWZsZXQtem9vbS1hbmltXCIpJiYhKG8uRHJhZ2dhYmxlLl9kcmFnZ2luZ3x8dC5zaGlmdEtleXx8MSE9PXQud2hpY2gmJjEhPT10LmJ1dHRvbiYmIXQudG91Y2hlc3x8KG8uRHJhZ2dhYmxlLl9kcmFnZ2luZz10aGlzLHRoaXMuX3ByZXZlbnRPdXRsaW5lJiZvLkRvbVV0aWwucHJldmVudE91dGxpbmUodGhpcy5fZWxlbWVudCksby5Eb21VdGlsLmRpc2FibGVJbWFnZURyYWcoKSxvLkRvbVV0aWwuZGlzYWJsZVRleHRTZWxlY3Rpb24oKSx0aGlzLl9tb3ZpbmcpKSkpe3RoaXMuZmlyZShcImRvd25cIik7dmFyIGk9dC50b3VjaGVzP3QudG91Y2hlc1swXTp0O3RoaXMuX3N0YXJ0UG9pbnQ9bmV3IG8uUG9pbnQoaS5jbGllbnRYLGkuY2xpZW50WSksby5Eb21FdmVudC5vbihlLG8uRHJhZ2dhYmxlLk1PVkVbdC50eXBlXSx0aGlzLl9vbk1vdmUsdGhpcykub24oZSxvLkRyYWdnYWJsZS5FTkRbdC50eXBlXSx0aGlzLl9vblVwLHRoaXMpfX0sX29uTW92ZTpmdW5jdGlvbihpKXtpZighaS5fc2ltdWxhdGVkJiZ0aGlzLl9lbmFibGVkKXtpZihpLnRvdWNoZXMmJmkudG91Y2hlcy5sZW5ndGg+MSlyZXR1cm4gdm9pZCh0aGlzLl9tb3ZlZD0hMCk7dmFyIG49aS50b3VjaGVzJiYxPT09aS50b3VjaGVzLmxlbmd0aD9pLnRvdWNoZXNbMF06aSxzPW5ldyBvLlBvaW50KG4uY2xpZW50WCxuLmNsaWVudFkpLHI9cy5zdWJ0cmFjdCh0aGlzLl9zdGFydFBvaW50KTsoci54fHxyLnkpJiYoTWF0aC5hYnMoci54KStNYXRoLmFicyhyLnkpPHRoaXMub3B0aW9ucy5jbGlja1RvbGVyYW5jZXx8KG8uRG9tRXZlbnQucHJldmVudERlZmF1bHQoaSksdGhpcy5fbW92ZWR8fCh0aGlzLmZpcmUoXCJkcmFnc3RhcnRcIiksdGhpcy5fbW92ZWQ9ITAsdGhpcy5fc3RhcnRQb3M9by5Eb21VdGlsLmdldFBvc2l0aW9uKHRoaXMuX2VsZW1lbnQpLnN1YnRyYWN0KHIpLG8uRG9tVXRpbC5hZGRDbGFzcyhlLmJvZHksXCJsZWFmbGV0LWRyYWdnaW5nXCIpLHRoaXMuX2xhc3RUYXJnZXQ9aS50YXJnZXR8fGkuc3JjRWxlbWVudCx0LlNWR0VsZW1lbnRJbnN0YW5jZSYmdGhpcy5fbGFzdFRhcmdldCBpbnN0YW5jZW9mIFNWR0VsZW1lbnRJbnN0YW5jZSYmKHRoaXMuX2xhc3RUYXJnZXQ9dGhpcy5fbGFzdFRhcmdldC5jb3JyZXNwb25kaW5nVXNlRWxlbWVudCksby5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX2xhc3RUYXJnZXQsXCJsZWFmbGV0LWRyYWctdGFyZ2V0XCIpKSx0aGlzLl9uZXdQb3M9dGhpcy5fc3RhcnRQb3MuYWRkKHIpLHRoaXMuX21vdmluZz0hMCxvLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2FuaW1SZXF1ZXN0KSx0aGlzLl9sYXN0RXZlbnQ9aSx0aGlzLl9hbmltUmVxdWVzdD1vLlV0aWwucmVxdWVzdEFuaW1GcmFtZSh0aGlzLl91cGRhdGVQb3NpdGlvbix0aGlzLCEwKSkpfX0sX3VwZGF0ZVBvc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIHQ9e29yaWdpbmFsRXZlbnQ6dGhpcy5fbGFzdEV2ZW50fTt0aGlzLmZpcmUoXCJwcmVkcmFnXCIsdCksby5Eb21VdGlsLnNldFBvc2l0aW9uKHRoaXMuX2VsZW1lbnQsdGhpcy5fbmV3UG9zKSx0aGlzLmZpcmUoXCJkcmFnXCIsdCl9LF9vblVwOmZ1bmN0aW9uKHQpeyF0Ll9zaW11bGF0ZWQmJnRoaXMuX2VuYWJsZWQmJnRoaXMuZmluaXNoRHJhZygpfSxmaW5pc2hEcmFnOmZ1bmN0aW9uKCl7by5Eb21VdGlsLnJlbW92ZUNsYXNzKGUuYm9keSxcImxlYWZsZXQtZHJhZ2dpbmdcIiksdGhpcy5fbGFzdFRhcmdldCYmKG8uRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl9sYXN0VGFyZ2V0LFwibGVhZmxldC1kcmFnLXRhcmdldFwiKSx0aGlzLl9sYXN0VGFyZ2V0PW51bGwpO2Zvcih2YXIgdCBpbiBvLkRyYWdnYWJsZS5NT1ZFKW8uRG9tRXZlbnQub2ZmKGUsby5EcmFnZ2FibGUuTU9WRVt0XSx0aGlzLl9vbk1vdmUsdGhpcykub2ZmKGUsby5EcmFnZ2FibGUuRU5EW3RdLHRoaXMuX29uVXAsdGhpcyk7by5Eb21VdGlsLmVuYWJsZUltYWdlRHJhZygpLG8uRG9tVXRpbC5lbmFibGVUZXh0U2VsZWN0aW9uKCksdGhpcy5fbW92ZWQmJnRoaXMuX21vdmluZyYmKG8uVXRpbC5jYW5jZWxBbmltRnJhbWUodGhpcy5fYW5pbVJlcXVlc3QpLHRoaXMuZmlyZShcImRyYWdlbmRcIix7ZGlzdGFuY2U6dGhpcy5fbmV3UG9zLmRpc3RhbmNlVG8odGhpcy5fc3RhcnRQb3MpfSkpLHRoaXMuX21vdmluZz0hMSxvLkRyYWdnYWJsZS5fZHJhZ2dpbmc9ITF9fSksby5IYW5kbGVyPW8uQ2xhc3MuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuX21hcD10fSxlbmFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZW5hYmxlZD90aGlzOih0aGlzLl9lbmFibGVkPSEwLHRoaXMuYWRkSG9va3MoKSx0aGlzKX0sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9lbmFibGVkPyh0aGlzLl9lbmFibGVkPSExLHRoaXMucmVtb3ZlSG9va3MoKSx0aGlzKTp0aGlzfSxlbmFibGVkOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLl9lbmFibGVkfX0pLG8uTWFwLm1lcmdlT3B0aW9ucyh7ZHJhZ2dpbmc6ITAsaW5lcnRpYTohby5Ccm93c2VyLmFuZHJvaWQyMyxpbmVydGlhRGVjZWxlcmF0aW9uOjM0MDAsaW5lcnRpYU1heFNwZWVkOjEvMCxlYXNlTGluZWFyaXR5Oi4yLHdvcmxkQ29weUp1bXA6ITEsbWF4Qm91bmRzVmlzY29zaXR5OjB9KSxvLk1hcC5EcmFnPW8uSGFuZGxlci5leHRlbmQoe2FkZEhvb2tzOmZ1bmN0aW9uKCl7aWYoIXRoaXMuX2RyYWdnYWJsZSl7dmFyIHQ9dGhpcy5fbWFwO3RoaXMuX2RyYWdnYWJsZT1uZXcgby5EcmFnZ2FibGUodC5fbWFwUGFuZSx0Ll9jb250YWluZXIpLHRoaXMuX2RyYWdnYWJsZS5vbih7ZG93bjp0aGlzLl9vbkRvd24sZHJhZ3N0YXJ0OnRoaXMuX29uRHJhZ1N0YXJ0LGRyYWc6dGhpcy5fb25EcmFnLGRyYWdlbmQ6dGhpcy5fb25EcmFnRW5kfSx0aGlzKSx0aGlzLl9kcmFnZ2FibGUub24oXCJwcmVkcmFnXCIsdGhpcy5fb25QcmVEcmFnTGltaXQsdGhpcyksdC5vcHRpb25zLndvcmxkQ29weUp1bXAmJih0aGlzLl9kcmFnZ2FibGUub24oXCJwcmVkcmFnXCIsdGhpcy5fb25QcmVEcmFnV3JhcCx0aGlzKSx0Lm9uKFwiem9vbWVuZFwiLHRoaXMuX29uWm9vbUVuZCx0aGlzKSx0LndoZW5SZWFkeSh0aGlzLl9vblpvb21FbmQsdGhpcykpfW8uRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9tYXAuX2NvbnRhaW5lcixcImxlYWZsZXQtZ3JhYiBsZWFmbGV0LXRvdWNoLWRyYWdcIiksdGhpcy5fZHJhZ2dhYmxlLmVuYWJsZSgpLHRoaXMuX3Bvc2l0aW9ucz1bXSx0aGlzLl90aW1lcz1bXX0scmVtb3ZlSG9va3M6ZnVuY3Rpb24oKXtvLkRvbVV0aWwucmVtb3ZlQ2xhc3ModGhpcy5fbWFwLl9jb250YWluZXIsXCJsZWFmbGV0LWdyYWJcIiksby5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX21hcC5fY29udGFpbmVyLFwibGVhZmxldC10b3VjaC1kcmFnXCIpLHRoaXMuX2RyYWdnYWJsZS5kaXNhYmxlKCl9LG1vdmVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RyYWdnYWJsZSYmdGhpcy5fZHJhZ2dhYmxlLl9tb3ZlZH0sbW92aW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RyYWdnYWJsZSYmdGhpcy5fZHJhZ2dhYmxlLl9tb3Zpbmd9LF9vbkRvd246ZnVuY3Rpb24oKXt0aGlzLl9tYXAuX3N0b3AoKX0sX29uRHJhZ1N0YXJ0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fbWFwO2lmKHRoaXMuX21hcC5vcHRpb25zLm1heEJvdW5kcyYmdGhpcy5fbWFwLm9wdGlvbnMubWF4Qm91bmRzVmlzY29zaXR5KXt2YXIgZT1vLmxhdExuZ0JvdW5kcyh0aGlzLl9tYXAub3B0aW9ucy5tYXhCb3VuZHMpO3RoaXMuX29mZnNldExpbWl0PW8uYm91bmRzKHRoaXMuX21hcC5sYXRMbmdUb0NvbnRhaW5lclBvaW50KGUuZ2V0Tm9ydGhXZXN0KCkpLm11bHRpcGx5QnkoLTEpLHRoaXMuX21hcC5sYXRMbmdUb0NvbnRhaW5lclBvaW50KGUuZ2V0U291dGhFYXN0KCkpLm11bHRpcGx5QnkoLTEpLmFkZCh0aGlzLl9tYXAuZ2V0U2l6ZSgpKSksdGhpcy5fdmlzY29zaXR5PU1hdGgubWluKDEsTWF0aC5tYXgoMCx0aGlzLl9tYXAub3B0aW9ucy5tYXhCb3VuZHNWaXNjb3NpdHkpKX1lbHNlIHRoaXMuX29mZnNldExpbWl0PW51bGw7dC5maXJlKFwibW92ZXN0YXJ0XCIpLmZpcmUoXCJkcmFnc3RhcnRcIiksdC5vcHRpb25zLmluZXJ0aWEmJih0aGlzLl9wb3NpdGlvbnM9W10sdGhpcy5fdGltZXM9W10pfSxfb25EcmFnOmZ1bmN0aW9uKHQpe2lmKHRoaXMuX21hcC5vcHRpb25zLmluZXJ0aWEpe3ZhciBlPXRoaXMuX2xhc3RUaW1lPStuZXcgRGF0ZSxpPXRoaXMuX2xhc3RQb3M9dGhpcy5fZHJhZ2dhYmxlLl9hYnNQb3N8fHRoaXMuX2RyYWdnYWJsZS5fbmV3UG9zO3RoaXMuX3Bvc2l0aW9ucy5wdXNoKGkpLHRoaXMuX3RpbWVzLnB1c2goZSksZS10aGlzLl90aW1lc1swXT41MCYmKHRoaXMuX3Bvc2l0aW9ucy5zaGlmdCgpLHRoaXMuX3RpbWVzLnNoaWZ0KCkpfXRoaXMuX21hcC5maXJlKFwibW92ZVwiLHQpLmZpcmUoXCJkcmFnXCIsdCl9LF9vblpvb21FbmQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9tYXAuZ2V0U2l6ZSgpLmRpdmlkZUJ5KDIpLGU9dGhpcy5fbWFwLmxhdExuZ1RvTGF5ZXJQb2ludChbMCwwXSk7dGhpcy5faW5pdGlhbFdvcmxkT2Zmc2V0PWUuc3VidHJhY3QodCkueCx0aGlzLl93b3JsZFdpZHRoPXRoaXMuX21hcC5nZXRQaXhlbFdvcmxkQm91bmRzKCkuZ2V0U2l6ZSgpLnh9LF92aXNjb3VzTGltaXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC0odC1lKSp0aGlzLl92aXNjb3NpdHl9LF9vblByZURyYWdMaW1pdDpmdW5jdGlvbigpe2lmKHRoaXMuX3Zpc2Nvc2l0eSYmdGhpcy5fb2Zmc2V0TGltaXQpe3ZhciB0PXRoaXMuX2RyYWdnYWJsZS5fbmV3UG9zLnN1YnRyYWN0KHRoaXMuX2RyYWdnYWJsZS5fc3RhcnRQb3MpLGU9dGhpcy5fb2Zmc2V0TGltaXQ7dC54PGUubWluLngmJih0Lng9dGhpcy5fdmlzY291c0xpbWl0KHQueCxlLm1pbi54KSksdC55PGUubWluLnkmJih0Lnk9dGhpcy5fdmlzY291c0xpbWl0KHQueSxlLm1pbi55KSksdC54PmUubWF4LngmJih0Lng9dGhpcy5fdmlzY291c0xpbWl0KHQueCxlLm1heC54KSksdC55PmUubWF4LnkmJih0Lnk9dGhpcy5fdmlzY291c0xpbWl0KHQueSxlLm1heC55KSksdGhpcy5fZHJhZ2dhYmxlLl9uZXdQb3M9dGhpcy5fZHJhZ2dhYmxlLl9zdGFydFBvcy5hZGQodCl9fSxfb25QcmVEcmFnV3JhcDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3dvcmxkV2lkdGgsZT1NYXRoLnJvdW5kKHQvMiksaT10aGlzLl9pbml0aWFsV29ybGRPZmZzZXQsbj10aGlzLl9kcmFnZ2FibGUuX25ld1Bvcy54LG89KG4tZStpKSV0K2UtaSxzPShuK2UraSkldC1lLWkscj1NYXRoLmFicyhvK2kpPE1hdGguYWJzKHMraSk/bzpzO3RoaXMuX2RyYWdnYWJsZS5fYWJzUG9zPXRoaXMuX2RyYWdnYWJsZS5fbmV3UG9zLmNsb25lKCksdGhpcy5fZHJhZ2dhYmxlLl9uZXdQb3MueD1yfSxfb25EcmFnRW5kOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX21hcCxpPWUub3B0aW9ucyxuPSFpLmluZXJ0aWF8fHRoaXMuX3RpbWVzLmxlbmd0aDwyO2lmKGUuZmlyZShcImRyYWdlbmRcIix0KSxuKWUuZmlyZShcIm1vdmVlbmRcIik7ZWxzZXt2YXIgcz10aGlzLl9sYXN0UG9zLnN1YnRyYWN0KHRoaXMuX3Bvc2l0aW9uc1swXSkscj0odGhpcy5fbGFzdFRpbWUtdGhpcy5fdGltZXNbMF0pLzFlMyxhPWkuZWFzZUxpbmVhcml0eSxoPXMubXVsdGlwbHlCeShhL3IpLGw9aC5kaXN0YW5jZVRvKFswLDBdKSx1PU1hdGgubWluKGkuaW5lcnRpYU1heFNwZWVkLGwpLGM9aC5tdWx0aXBseUJ5KHUvbCksZD11LyhpLmluZXJ0aWFEZWNlbGVyYXRpb24qYSksXz1jLm11bHRpcGx5QnkoLWQvMikucm91bmQoKTtfLnh8fF8ueT8oXz1lLl9saW1pdE9mZnNldChfLGUub3B0aW9ucy5tYXhCb3VuZHMpLG8uVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKGZ1bmN0aW9uKCl7ZS5wYW5CeShfLHtkdXJhdGlvbjpkLGVhc2VMaW5lYXJpdHk6YSxub01vdmVTdGFydDohMCxhbmltYXRlOiEwfSl9KSk6ZS5maXJlKFwibW92ZWVuZFwiKX19fSksby5NYXAuYWRkSW5pdEhvb2soXCJhZGRIYW5kbGVyXCIsXCJkcmFnZ2luZ1wiLG8uTWFwLkRyYWcpLG8uTWFwLm1lcmdlT3B0aW9ucyh7ZG91YmxlQ2xpY2tab29tOiEwfSksby5NYXAuRG91YmxlQ2xpY2tab29tPW8uSGFuZGxlci5leHRlbmQoe2FkZEhvb2tzOmZ1bmN0aW9uKCl7dGhpcy5fbWFwLm9uKFwiZGJsY2xpY2tcIix0aGlzLl9vbkRvdWJsZUNsaWNrLHRoaXMpfSxyZW1vdmVIb29rczpmdW5jdGlvbigpe3RoaXMuX21hcC5vZmYoXCJkYmxjbGlja1wiLHRoaXMuX29uRG91YmxlQ2xpY2ssdGhpcyl9LF9vbkRvdWJsZUNsaWNrOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX21hcCxpPWUuZ2V0Wm9vbSgpLG49ZS5vcHRpb25zLnpvb21EZWx0YSxvPXQub3JpZ2luYWxFdmVudC5zaGlmdEtleT9pLW46aStuO1wiY2VudGVyXCI9PT1lLm9wdGlvbnMuZG91YmxlQ2xpY2tab29tP2Uuc2V0Wm9vbShvKTplLnNldFpvb21Bcm91bmQodC5jb250YWluZXJQb2ludCxvKX19KSxvLk1hcC5hZGRJbml0SG9vayhcImFkZEhhbmRsZXJcIixcImRvdWJsZUNsaWNrWm9vbVwiLG8uTWFwLkRvdWJsZUNsaWNrWm9vbSksby5NYXAubWVyZ2VPcHRpb25zKHtzY3JvbGxXaGVlbFpvb206ITAsd2hlZWxEZWJvdW5jZVRpbWU6NDAsd2hlZWxQeFBlclpvb21MZXZlbDo2MH0pLG8uTWFwLlNjcm9sbFdoZWVsWm9vbT1vLkhhbmRsZXIuZXh0ZW5kKHthZGRIb29rczpmdW5jdGlvbigpe28uRG9tRXZlbnQub24odGhpcy5fbWFwLl9jb250YWluZXIsXCJtb3VzZXdoZWVsXCIsdGhpcy5fb25XaGVlbFNjcm9sbCx0aGlzKSx0aGlzLl9kZWx0YT0wfSxyZW1vdmVIb29rczpmdW5jdGlvbigpe28uRG9tRXZlbnQub2ZmKHRoaXMuX21hcC5fY29udGFpbmVyLFwibW91c2V3aGVlbFwiLHRoaXMuX29uV2hlZWxTY3JvbGwsdGhpcyl9LF9vbldoZWVsU2Nyb2xsOmZ1bmN0aW9uKHQpe3ZhciBlPW8uRG9tRXZlbnQuZ2V0V2hlZWxEZWx0YSh0KSxpPXRoaXMuX21hcC5vcHRpb25zLndoZWVsRGVib3VuY2VUaW1lO3RoaXMuX2RlbHRhKz1lLHRoaXMuX2xhc3RNb3VzZVBvcz10aGlzLl9tYXAubW91c2VFdmVudFRvQ29udGFpbmVyUG9pbnQodCksdGhpcy5fc3RhcnRUaW1lfHwodGhpcy5fc3RhcnRUaW1lPStuZXcgRGF0ZSk7dmFyIG49TWF0aC5tYXgoaS0oK25ldyBEYXRlLXRoaXMuX3N0YXJ0VGltZSksMCk7Y2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVyKSx0aGlzLl90aW1lcj1zZXRUaW1lb3V0KG8uYmluZCh0aGlzLl9wZXJmb3JtWm9vbSx0aGlzKSxuKSxvLkRvbUV2ZW50LnN0b3AodCl9LF9wZXJmb3JtWm9vbTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX21hcCxlPXQuZ2V0Wm9vbSgpLGk9dGhpcy5fbWFwLm9wdGlvbnMuem9vbVNuYXB8fDA7dC5fc3RvcCgpO3ZhciBuPXRoaXMuX2RlbHRhLyg0KnRoaXMuX21hcC5vcHRpb25zLndoZWVsUHhQZXJab29tTGV2ZWwpLG89NCpNYXRoLmxvZygyLygxK01hdGguZXhwKC1NYXRoLmFicyhuKSkpKS9NYXRoLkxOMixzPWk/TWF0aC5jZWlsKG8vaSkqaTpvLHI9dC5fbGltaXRab29tKGUrKHRoaXMuX2RlbHRhPjA/czotcykpLWU7dGhpcy5fZGVsdGE9MCx0aGlzLl9zdGFydFRpbWU9bnVsbCxyJiYoXCJjZW50ZXJcIj09PXQub3B0aW9ucy5zY3JvbGxXaGVlbFpvb20/dC5zZXRab29tKGUrcik6dC5zZXRab29tQXJvdW5kKHRoaXMuX2xhc3RNb3VzZVBvcyxlK3IpKX19KSxvLk1hcC5hZGRJbml0SG9vayhcImFkZEhhbmRsZXJcIixcInNjcm9sbFdoZWVsWm9vbVwiLG8uTWFwLlNjcm9sbFdoZWVsWm9vbSksby5leHRlbmQoby5Eb21FdmVudCx7X3RvdWNoc3RhcnQ6by5Ccm93c2VyLm1zUG9pbnRlcj9cIk1TUG9pbnRlckRvd25cIjpvLkJyb3dzZXIucG9pbnRlcj9cInBvaW50ZXJkb3duXCI6XCJ0b3VjaHN0YXJ0XCIsX3RvdWNoZW5kOm8uQnJvd3Nlci5tc1BvaW50ZXI/XCJNU1BvaW50ZXJVcFwiOm8uQnJvd3Nlci5wb2ludGVyP1wicG9pbnRlcnVwXCI6XCJ0b3VjaGVuZFwiLGFkZERvdWJsZVRhcExpc3RlbmVyOmZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQpe3ZhciBlO2lmKG8uQnJvd3Nlci5wb2ludGVyKXtpZighby5Ccm93c2VyLmVkZ2V8fFwibW91c2VcIj09PXQucG9pbnRlclR5cGUpcmV0dXJuO2U9by5Eb21FdmVudC5fcG9pbnRlcnNDb3VudH1lbHNlIGU9dC50b3VjaGVzLmxlbmd0aDtpZighKGU+MSkpe3ZhciBpPURhdGUubm93KCksbj1pLShyfHxpKTthPXQudG91Y2hlcz90LnRvdWNoZXNbMF06dCxoPW4+MCYmbjw9bCxyPWl9fWZ1bmN0aW9uIHModCl7aWYoaCYmIWEuY2FuY2VsQnViYmxlKXtpZihvLkJyb3dzZXIucG9pbnRlcil7aWYoIW8uQnJvd3Nlci5lZGdlfHxcIm1vdXNlXCI9PT10LnBvaW50ZXJUeXBlKXJldHVybjt2YXIgaSxuLHM9e307Zm9yKG4gaW4gYSlpPWFbbl0sc1tuXT1pJiZpLmJpbmQ/aS5iaW5kKGEpOmk7YT1zfWEudHlwZT1cImRibGNsaWNrXCIsZShhKSxyPW51bGx9fXZhciByLGEsaD0hMSxsPTI1MCx1PVwiX2xlYWZsZXRfXCIsYz10aGlzLl90b3VjaHN0YXJ0LGQ9dGhpcy5fdG91Y2hlbmQ7cmV0dXJuIHRbdStjK2ldPW4sdFt1K2QraV09cyx0W3UrXCJkYmxjbGlja1wiK2ldPWUsdC5hZGRFdmVudExpc3RlbmVyKGMsbiwhMSksdC5hZGRFdmVudExpc3RlbmVyKGQscywhMSksdC5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIixlLCExKSx0aGlzfSxyZW1vdmVEb3VibGVUYXBMaXN0ZW5lcjpmdW5jdGlvbih0LGUpe3ZhciBpPVwiX2xlYWZsZXRfXCIsbj10W2krdGhpcy5fdG91Y2hzdGFydCtlXSxzPXRbaSt0aGlzLl90b3VjaGVuZCtlXSxyPXRbaStcImRibGNsaWNrXCIrZV07cmV0dXJuIHQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl90b3VjaHN0YXJ0LG4sITEpLHQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl90b3VjaGVuZCxzLCExKSxvLkJyb3dzZXIuZWRnZXx8dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIixyLCExKSx0aGlzfX0pLG8uZXh0ZW5kKG8uRG9tRXZlbnQse1BPSU5URVJfRE9XTjpvLkJyb3dzZXIubXNQb2ludGVyP1wiTVNQb2ludGVyRG93blwiOlwicG9pbnRlcmRvd25cIixQT0lOVEVSX01PVkU6by5Ccm93c2VyLm1zUG9pbnRlcj9cIk1TUG9pbnRlck1vdmVcIjpcInBvaW50ZXJtb3ZlXCIsUE9JTlRFUl9VUDpvLkJyb3dzZXIubXNQb2ludGVyP1wiTVNQb2ludGVyVXBcIjpcInBvaW50ZXJ1cFwiLFBPSU5URVJfQ0FOQ0VMOm8uQnJvd3Nlci5tc1BvaW50ZXI/XCJNU1BvaW50ZXJDYW5jZWxcIjpcInBvaW50ZXJjYW5jZWxcIixUQUdfV0hJVEVfTElTVDpbXCJJTlBVVFwiLFwiU0VMRUNUXCIsXCJPUFRJT05cIl0sX3BvaW50ZXJzOnt9LF9wb2ludGVyc0NvdW50OjAsYWRkUG9pbnRlckxpc3RlbmVyOmZ1bmN0aW9uKHQsZSxpLG4pe3JldHVyblwidG91Y2hzdGFydFwiPT09ZT90aGlzLl9hZGRQb2ludGVyU3RhcnQodCxpLG4pOlwidG91Y2htb3ZlXCI9PT1lP3RoaXMuX2FkZFBvaW50ZXJNb3ZlKHQsaSxuKTpcInRvdWNoZW5kXCI9PT1lJiZ0aGlzLl9hZGRQb2ludGVyRW5kKHQsaSxuKSx0aGlzfSxyZW1vdmVQb2ludGVyTGlzdGVuZXI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRbXCJfbGVhZmxldF9cIitlK2ldO3JldHVyblwidG91Y2hzdGFydFwiPT09ZT90LnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX0RPV04sbiwhMSk6XCJ0b3VjaG1vdmVcIj09PWU/dC5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuUE9JTlRFUl9NT1ZFLG4sITEpOlwidG91Y2hlbmRcIj09PWUmJih0LnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX1VQLG4sITEpLHQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLlBPSU5URVJfQ0FOQ0VMLG4sITEpKSx0aGlzfSxfYWRkUG9pbnRlclN0YXJ0OmZ1bmN0aW9uKHQsaSxuKXt2YXIgcz1vLmJpbmQoZnVuY3Rpb24odCl7aWYoXCJtb3VzZVwiIT09dC5wb2ludGVyVHlwZSYmdC5NU1BPSU5URVJfVFlQRV9NT1VTRSYmdC5wb2ludGVyVHlwZSE9PXQuTVNQT0lOVEVSX1RZUEVfTU9VU0Upe2lmKCEodGhpcy5UQUdfV0hJVEVfTElTVC5pbmRleE9mKHQudGFyZ2V0LnRhZ05hbWUpPDApKXJldHVybjtvLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KHQpfXRoaXMuX2hhbmRsZVBvaW50ZXIodCxpKX0sdGhpcyk7aWYodFtcIl9sZWFmbGV0X3RvdWNoc3RhcnRcIituXT1zLHQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlBPSU5URVJfRE9XTixzLCExKSwhdGhpcy5fcG9pbnRlckRvY0xpc3RlbmVyKXt2YXIgcj1vLmJpbmQodGhpcy5fZ2xvYmFsUG9pbnRlclVwLHRoaXMpO2UuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX0RPV04sby5iaW5kKHRoaXMuX2dsb2JhbFBvaW50ZXJEb3duLHRoaXMpLCEwKSxlLmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHRoaXMuUE9JTlRFUl9NT1ZFLG8uYmluZCh0aGlzLl9nbG9iYWxQb2ludGVyTW92ZSx0aGlzKSwhMCksZS5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlBPSU5URVJfVVAsciwhMCksZS5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlBPSU5URVJfQ0FOQ0VMLHIsITApLHRoaXMuX3BvaW50ZXJEb2NMaXN0ZW5lcj0hMH19LF9nbG9iYWxQb2ludGVyRG93bjpmdW5jdGlvbih0KXt0aGlzLl9wb2ludGVyc1t0LnBvaW50ZXJJZF09dCx0aGlzLl9wb2ludGVyc0NvdW50Kyt9LF9nbG9iYWxQb2ludGVyTW92ZTpmdW5jdGlvbih0KXt0aGlzLl9wb2ludGVyc1t0LnBvaW50ZXJJZF0mJih0aGlzLl9wb2ludGVyc1t0LnBvaW50ZXJJZF09dCl9LF9nbG9iYWxQb2ludGVyVXA6ZnVuY3Rpb24odCl7ZGVsZXRlIHRoaXMuX3BvaW50ZXJzW3QucG9pbnRlcklkXSx0aGlzLl9wb2ludGVyc0NvdW50LS19LF9oYW5kbGVQb2ludGVyOmZ1bmN0aW9uKHQsZSl7dC50b3VjaGVzPVtdO2Zvcih2YXIgaSBpbiB0aGlzLl9wb2ludGVycyl0LnRvdWNoZXMucHVzaCh0aGlzLl9wb2ludGVyc1tpXSk7dC5jaGFuZ2VkVG91Y2hlcz1bdF0sZSh0KX0sX2FkZFBvaW50ZXJNb3ZlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1vLmJpbmQoZnVuY3Rpb24odCl7KHQucG9pbnRlclR5cGUhPT10Lk1TUE9JTlRFUl9UWVBFX01PVVNFJiZcIm1vdXNlXCIhPT10LnBvaW50ZXJUeXBlfHwwIT09dC5idXR0b25zKSYmdGhpcy5faGFuZGxlUG9pbnRlcih0LGUpfSx0aGlzKTt0W1wiX2xlYWZsZXRfdG91Y2htb3ZlXCIraV09bix0LmFkZEV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX01PVkUsbiwhMSl9LF9hZGRQb2ludGVyRW5kOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1vLmJpbmQoZnVuY3Rpb24odCl7dGhpcy5faGFuZGxlUG9pbnRlcih0LGUpfSx0aGlzKTt0W1wiX2xlYWZsZXRfdG91Y2hlbmRcIitpXT1uLHQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlBPSU5URVJfVVAsbiwhMSksdC5hZGRFdmVudExpc3RlbmVyKHRoaXMuUE9JTlRFUl9DQU5DRUwsbiwhMSl9fSksby5NYXAubWVyZ2VPcHRpb25zKHt0b3VjaFpvb206by5Ccm93c2VyLnRvdWNoJiYhby5Ccm93c2VyLmFuZHJvaWQyMyxib3VuY2VBdFpvb21MaW1pdHM6ITB9KSxvLk1hcC5Ub3VjaFpvb209by5IYW5kbGVyLmV4dGVuZCh7YWRkSG9va3M6ZnVuY3Rpb24oKXtvLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5fbWFwLl9jb250YWluZXIsXCJsZWFmbGV0LXRvdWNoLXpvb21cIiksby5Eb21FdmVudC5vbih0aGlzLl9tYXAuX2NvbnRhaW5lcixcInRvdWNoc3RhcnRcIix0aGlzLl9vblRvdWNoU3RhcnQsdGhpcyl9LHJlbW92ZUhvb2tzOmZ1bmN0aW9uKCl7by5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX21hcC5fY29udGFpbmVyLFwibGVhZmxldC10b3VjaC16b29tXCIpLG8uRG9tRXZlbnQub2ZmKHRoaXMuX21hcC5fY29udGFpbmVyLFwidG91Y2hzdGFydFwiLHRoaXMuX29uVG91Y2hTdGFydCx0aGlzKX0sX29uVG91Y2hTdGFydDpmdW5jdGlvbih0KXt2YXIgaT10aGlzLl9tYXA7aWYodC50b3VjaGVzJiYyPT09dC50b3VjaGVzLmxlbmd0aCYmIWkuX2FuaW1hdGluZ1pvb20mJiF0aGlzLl96b29taW5nKXt2YXIgbj1pLm1vdXNlRXZlbnRUb0NvbnRhaW5lclBvaW50KHQudG91Y2hlc1swXSkscz1pLm1vdXNlRXZlbnRUb0NvbnRhaW5lclBvaW50KHQudG91Y2hlc1sxXSk7dGhpcy5fY2VudGVyUG9pbnQ9aS5nZXRTaXplKCkuX2RpdmlkZUJ5KDIpLHRoaXMuX3N0YXJ0TGF0TG5nPWkuY29udGFpbmVyUG9pbnRUb0xhdExuZyh0aGlzLl9jZW50ZXJQb2ludCksXCJjZW50ZXJcIiE9PWkub3B0aW9ucy50b3VjaFpvb20mJih0aGlzLl9waW5jaFN0YXJ0TGF0TG5nPWkuY29udGFpbmVyUG9pbnRUb0xhdExuZyhuLmFkZChzKS5fZGl2aWRlQnkoMikpKSx0aGlzLl9zdGFydERpc3Q9bi5kaXN0YW5jZVRvKHMpLHRoaXMuX3N0YXJ0Wm9vbT1pLmdldFpvb20oKSx0aGlzLl9tb3ZlZD0hMSx0aGlzLl96b29taW5nPSEwLGkuX3N0b3AoKSxvLkRvbUV2ZW50Lm9uKGUsXCJ0b3VjaG1vdmVcIix0aGlzLl9vblRvdWNoTW92ZSx0aGlzKS5vbihlLFwidG91Y2hlbmRcIix0aGlzLl9vblRvdWNoRW5kLHRoaXMpLG8uRG9tRXZlbnQucHJldmVudERlZmF1bHQodCl9fSxfb25Ub3VjaE1vdmU6ZnVuY3Rpb24odCl7aWYodC50b3VjaGVzJiYyPT09dC50b3VjaGVzLmxlbmd0aCYmdGhpcy5fem9vbWluZyl7dmFyIGU9dGhpcy5fbWFwLGk9ZS5tb3VzZUV2ZW50VG9Db250YWluZXJQb2ludCh0LnRvdWNoZXNbMF0pLG49ZS5tb3VzZUV2ZW50VG9Db250YWluZXJQb2ludCh0LnRvdWNoZXNbMV0pLHM9aS5kaXN0YW5jZVRvKG4pL3RoaXMuX3N0YXJ0RGlzdDtpZih0aGlzLl96b29tPWUuZ2V0U2NhbGVab29tKHMsdGhpcy5fc3RhcnRab29tKSwhZS5vcHRpb25zLmJvdW5jZUF0Wm9vbUxpbWl0cyYmKHRoaXMuX3pvb208ZS5nZXRNaW5ab29tKCkmJnM8MXx8dGhpcy5fem9vbT5lLmdldE1heFpvb20oKSYmcz4xKSYmKHRoaXMuX3pvb209ZS5fbGltaXRab29tKHRoaXMuX3pvb20pKSxcImNlbnRlclwiPT09ZS5vcHRpb25zLnRvdWNoWm9vbSl7aWYodGhpcy5fY2VudGVyPXRoaXMuX3N0YXJ0TGF0TG5nLDE9PT1zKXJldHVybn1lbHNle3ZhciByPWkuX2FkZChuKS5fZGl2aWRlQnkoMikuX3N1YnRyYWN0KHRoaXMuX2NlbnRlclBvaW50KTtpZigxPT09cyYmMD09PXIueCYmMD09PXIueSlyZXR1cm47dGhpcy5fY2VudGVyPWUudW5wcm9qZWN0KGUucHJvamVjdCh0aGlzLl9waW5jaFN0YXJ0TGF0TG5nLHRoaXMuX3pvb20pLnN1YnRyYWN0KHIpLHRoaXMuX3pvb20pfXRoaXMuX21vdmVkfHwoZS5fbW92ZVN0YXJ0KCEwKSx0aGlzLl9tb3ZlZD0hMCksby5VdGlsLmNhbmNlbEFuaW1GcmFtZSh0aGlzLl9hbmltUmVxdWVzdCk7dmFyIGE9by5iaW5kKGUuX21vdmUsZSx0aGlzLl9jZW50ZXIsdGhpcy5fem9vbSx7cGluY2g6ITAscm91bmQ6ITF9KTt0aGlzLl9hbmltUmVxdWVzdD1vLlV0aWwucmVxdWVzdEFuaW1GcmFtZShhLHRoaXMsITApLG8uRG9tRXZlbnQucHJldmVudERlZmF1bHQodCl9fSxfb25Ub3VjaEVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tb3ZlZCYmdGhpcy5fem9vbWluZz8odGhpcy5fem9vbWluZz0hMSxvLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2FuaW1SZXF1ZXN0KSxvLkRvbUV2ZW50Lm9mZihlLFwidG91Y2htb3ZlXCIsdGhpcy5fb25Ub3VjaE1vdmUpLm9mZihlLFwidG91Y2hlbmRcIix0aGlzLl9vblRvdWNoRW5kKSx2b2lkKHRoaXMuX21hcC5vcHRpb25zLnpvb21BbmltYXRpb24/dGhpcy5fbWFwLl9hbmltYXRlWm9vbSh0aGlzLl9jZW50ZXIsdGhpcy5fbWFwLl9saW1pdFpvb20odGhpcy5fem9vbSksITAsdGhpcy5fbWFwLm9wdGlvbnMuem9vbVNuYXApOnRoaXMuX21hcC5fcmVzZXRWaWV3KHRoaXMuX2NlbnRlcix0aGlzLl9tYXAuX2xpbWl0Wm9vbSh0aGlzLl96b29tKSkpKTp2b2lkKHRoaXMuX3pvb21pbmc9ITEpfX0pLG8uTWFwLmFkZEluaXRIb29rKFwiYWRkSGFuZGxlclwiLFwidG91Y2hab29tXCIsby5NYXAuVG91Y2hab29tKSxvLk1hcC5tZXJnZU9wdGlvbnMoe3RhcDohMCx0YXBUb2xlcmFuY2U6MTV9KSxvLk1hcC5UYXA9by5IYW5kbGVyLmV4dGVuZCh7YWRkSG9va3M6ZnVuY3Rpb24oKXtvLkRvbUV2ZW50Lm9uKHRoaXMuX21hcC5fY29udGFpbmVyLFwidG91Y2hzdGFydFwiLHRoaXMuX29uRG93bix0aGlzKX0scmVtb3ZlSG9va3M6ZnVuY3Rpb24oKXtvLkRvbUV2ZW50Lm9mZih0aGlzLl9tYXAuX2NvbnRhaW5lcixcInRvdWNoc3RhcnRcIix0aGlzLl9vbkRvd24sdGhpcyl9LF9vbkRvd246ZnVuY3Rpb24odCl7aWYodC50b3VjaGVzKXtpZihvLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KHQpLHRoaXMuX2ZpcmVDbGljaz0hMCx0LnRvdWNoZXMubGVuZ3RoPjEpcmV0dXJuIHRoaXMuX2ZpcmVDbGljaz0hMSx2b2lkIGNsZWFyVGltZW91dCh0aGlzLl9ob2xkVGltZW91dCk7dmFyIGk9dC50b3VjaGVzWzBdLG49aS50YXJnZXQ7dGhpcy5fc3RhcnRQb3M9dGhpcy5fbmV3UG9zPW5ldyBvLlBvaW50KGkuY2xpZW50WCxpLmNsaWVudFkpLG4udGFnTmFtZSYmXCJhXCI9PT1uLnRhZ05hbWUudG9Mb3dlckNhc2UoKSYmby5Eb21VdGlsLmFkZENsYXNzKG4sXCJsZWFmbGV0LWFjdGl2ZVwiKSx0aGlzLl9ob2xkVGltZW91dD1zZXRUaW1lb3V0KG8uYmluZChmdW5jdGlvbigpe3RoaXMuX2lzVGFwVmFsaWQoKSYmKHRoaXMuX2ZpcmVDbGljaz0hMSx0aGlzLl9vblVwKCksdGhpcy5fc2ltdWxhdGVFdmVudChcImNvbnRleHRtZW51XCIsaSkpfSx0aGlzKSwxZTMpLHRoaXMuX3NpbXVsYXRlRXZlbnQoXCJtb3VzZWRvd25cIixpKSxvLkRvbUV2ZW50Lm9uKGUse3RvdWNobW92ZTp0aGlzLl9vbk1vdmUsdG91Y2hlbmQ6dGhpcy5fb25VcH0sdGhpcyl9fSxfb25VcDpmdW5jdGlvbih0KXtpZihjbGVhclRpbWVvdXQodGhpcy5faG9sZFRpbWVvdXQpLG8uRG9tRXZlbnQub2ZmKGUse3RvdWNobW92ZTp0aGlzLl9vbk1vdmUsdG91Y2hlbmQ6dGhpcy5fb25VcH0sdGhpcyksdGhpcy5fZmlyZUNsaWNrJiZ0JiZ0LmNoYW5nZWRUb3VjaGVzKXt2YXIgaT10LmNoYW5nZWRUb3VjaGVzWzBdLG49aS50YXJnZXQ7biYmbi50YWdOYW1lJiZcImFcIj09PW4udGFnTmFtZS50b0xvd2VyQ2FzZSgpJiZvLkRvbVV0aWwucmVtb3ZlQ2xhc3MobixcImxlYWZsZXQtYWN0aXZlXCIpLHRoaXMuX3NpbXVsYXRlRXZlbnQoXCJtb3VzZXVwXCIsaSksXG50aGlzLl9pc1RhcFZhbGlkKCkmJnRoaXMuX3NpbXVsYXRlRXZlbnQoXCJjbGlja1wiLGkpfX0sX2lzVGFwVmFsaWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbmV3UG9zLmRpc3RhbmNlVG8odGhpcy5fc3RhcnRQb3MpPD10aGlzLl9tYXAub3B0aW9ucy50YXBUb2xlcmFuY2V9LF9vbk1vdmU6ZnVuY3Rpb24odCl7dmFyIGU9dC50b3VjaGVzWzBdO3RoaXMuX25ld1Bvcz1uZXcgby5Qb2ludChlLmNsaWVudFgsZS5jbGllbnRZKSx0aGlzLl9zaW11bGF0ZUV2ZW50KFwibW91c2Vtb3ZlXCIsZSl9LF9zaW11bGF0ZUV2ZW50OmZ1bmN0aW9uKGksbil7dmFyIG89ZS5jcmVhdGVFdmVudChcIk1vdXNlRXZlbnRzXCIpO28uX3NpbXVsYXRlZD0hMCxuLnRhcmdldC5fc2ltdWxhdGVkQ2xpY2s9ITAsby5pbml0TW91c2VFdmVudChpLCEwLCEwLHQsMSxuLnNjcmVlblgsbi5zY3JlZW5ZLG4uY2xpZW50WCxuLmNsaWVudFksITEsITEsITEsITEsMCxudWxsKSxuLnRhcmdldC5kaXNwYXRjaEV2ZW50KG8pfX0pLG8uQnJvd3Nlci50b3VjaCYmIW8uQnJvd3Nlci5wb2ludGVyJiZvLk1hcC5hZGRJbml0SG9vayhcImFkZEhhbmRsZXJcIixcInRhcFwiLG8uTWFwLlRhcCksby5NYXAubWVyZ2VPcHRpb25zKHtib3hab29tOiEwfSksby5NYXAuQm94Wm9vbT1vLkhhbmRsZXIuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuX21hcD10LHRoaXMuX2NvbnRhaW5lcj10Ll9jb250YWluZXIsdGhpcy5fcGFuZT10Ll9wYW5lcy5vdmVybGF5UGFuZX0sYWRkSG9va3M6ZnVuY3Rpb24oKXtvLkRvbUV2ZW50Lm9uKHRoaXMuX2NvbnRhaW5lcixcIm1vdXNlZG93blwiLHRoaXMuX29uTW91c2VEb3duLHRoaXMpfSxyZW1vdmVIb29rczpmdW5jdGlvbigpe28uRG9tRXZlbnQub2ZmKHRoaXMuX2NvbnRhaW5lcixcIm1vdXNlZG93blwiLHRoaXMuX29uTW91c2VEb3duLHRoaXMpfSxtb3ZlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tb3ZlZH0sX3Jlc2V0U3RhdGU6ZnVuY3Rpb24oKXt0aGlzLl9tb3ZlZD0hMX0sX29uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3JldHVybiEoIXQuc2hpZnRLZXl8fDEhPT10LndoaWNoJiYxIT09dC5idXR0b24pJiYodGhpcy5fcmVzZXRTdGF0ZSgpLG8uRG9tVXRpbC5kaXNhYmxlVGV4dFNlbGVjdGlvbigpLG8uRG9tVXRpbC5kaXNhYmxlSW1hZ2VEcmFnKCksdGhpcy5fc3RhcnRQb2ludD10aGlzLl9tYXAubW91c2VFdmVudFRvQ29udGFpbmVyUG9pbnQodCksdm9pZCBvLkRvbUV2ZW50Lm9uKGUse2NvbnRleHRtZW51Om8uRG9tRXZlbnQuc3RvcCxtb3VzZW1vdmU6dGhpcy5fb25Nb3VzZU1vdmUsbW91c2V1cDp0aGlzLl9vbk1vdXNlVXAsa2V5ZG93bjp0aGlzLl9vbktleURvd259LHRoaXMpKX0sX29uTW91c2VNb3ZlOmZ1bmN0aW9uKHQpe3RoaXMuX21vdmVkfHwodGhpcy5fbW92ZWQ9ITAsdGhpcy5fYm94PW8uRG9tVXRpbC5jcmVhdGUoXCJkaXZcIixcImxlYWZsZXQtem9vbS1ib3hcIix0aGlzLl9jb250YWluZXIpLG8uRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9jb250YWluZXIsXCJsZWFmbGV0LWNyb3NzaGFpclwiKSx0aGlzLl9tYXAuZmlyZShcImJveHpvb21zdGFydFwiKSksdGhpcy5fcG9pbnQ9dGhpcy5fbWFwLm1vdXNlRXZlbnRUb0NvbnRhaW5lclBvaW50KHQpO3ZhciBlPW5ldyBvLkJvdW5kcyh0aGlzLl9wb2ludCx0aGlzLl9zdGFydFBvaW50KSxpPWUuZ2V0U2l6ZSgpO28uRG9tVXRpbC5zZXRQb3NpdGlvbih0aGlzLl9ib3gsZS5taW4pLHRoaXMuX2JveC5zdHlsZS53aWR0aD1pLngrXCJweFwiLHRoaXMuX2JveC5zdHlsZS5oZWlnaHQ9aS55K1wicHhcIn0sX2ZpbmlzaDpmdW5jdGlvbigpe3RoaXMuX21vdmVkJiYoby5Eb21VdGlsLnJlbW92ZSh0aGlzLl9ib3gpLG8uRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl9jb250YWluZXIsXCJsZWFmbGV0LWNyb3NzaGFpclwiKSksby5Eb21VdGlsLmVuYWJsZVRleHRTZWxlY3Rpb24oKSxvLkRvbVV0aWwuZW5hYmxlSW1hZ2VEcmFnKCksby5Eb21FdmVudC5vZmYoZSx7Y29udGV4dG1lbnU6by5Eb21FdmVudC5zdG9wLG1vdXNlbW92ZTp0aGlzLl9vbk1vdXNlTW92ZSxtb3VzZXVwOnRoaXMuX29uTW91c2VVcCxrZXlkb3duOnRoaXMuX29uS2V5RG93bn0sdGhpcyl9LF9vbk1vdXNlVXA6ZnVuY3Rpb24odCl7aWYoKDE9PT10LndoaWNofHwxPT09dC5idXR0b24pJiYodGhpcy5fZmluaXNoKCksdGhpcy5fbW92ZWQpKXtzZXRUaW1lb3V0KG8uYmluZCh0aGlzLl9yZXNldFN0YXRlLHRoaXMpLDApO3ZhciBlPW5ldyBvLkxhdExuZ0JvdW5kcyh0aGlzLl9tYXAuY29udGFpbmVyUG9pbnRUb0xhdExuZyh0aGlzLl9zdGFydFBvaW50KSx0aGlzLl9tYXAuY29udGFpbmVyUG9pbnRUb0xhdExuZyh0aGlzLl9wb2ludCkpO3RoaXMuX21hcC5maXRCb3VuZHMoZSkuZmlyZShcImJveHpvb21lbmRcIix7Ym94Wm9vbUJvdW5kczplfSl9fSxfb25LZXlEb3duOmZ1bmN0aW9uKHQpezI3PT09dC5rZXlDb2RlJiZ0aGlzLl9maW5pc2goKX19KSxvLk1hcC5hZGRJbml0SG9vayhcImFkZEhhbmRsZXJcIixcImJveFpvb21cIixvLk1hcC5Cb3hab29tKSxvLk1hcC5tZXJnZU9wdGlvbnMoe2tleWJvYXJkOiEwLGtleWJvYXJkUGFuRGVsdGE6ODB9KSxvLk1hcC5LZXlib2FyZD1vLkhhbmRsZXIuZXh0ZW5kKHtrZXlDb2Rlczp7bGVmdDpbMzddLHJpZ2h0OlszOV0sZG93bjpbNDBdLHVwOlszOF0sem9vbUluOlsxODcsMTA3LDYxLDE3MV0sem9vbU91dDpbMTg5LDEwOSw1NCwxNzNdfSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuX21hcD10LHRoaXMuX3NldFBhbkRlbHRhKHQub3B0aW9ucy5rZXlib2FyZFBhbkRlbHRhKSx0aGlzLl9zZXRab29tRGVsdGEodC5vcHRpb25zLnpvb21EZWx0YSl9LGFkZEhvb2tzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fbWFwLl9jb250YWluZXI7dC50YWJJbmRleDw9MCYmKHQudGFiSW5kZXg9XCIwXCIpLG8uRG9tRXZlbnQub24odCx7Zm9jdXM6dGhpcy5fb25Gb2N1cyxibHVyOnRoaXMuX29uQmx1cixtb3VzZWRvd246dGhpcy5fb25Nb3VzZURvd259LHRoaXMpLHRoaXMuX21hcC5vbih7Zm9jdXM6dGhpcy5fYWRkSG9va3MsYmx1cjp0aGlzLl9yZW1vdmVIb29rc30sdGhpcyl9LHJlbW92ZUhvb2tzOmZ1bmN0aW9uKCl7dGhpcy5fcmVtb3ZlSG9va3MoKSxvLkRvbUV2ZW50Lm9mZih0aGlzLl9tYXAuX2NvbnRhaW5lcix7Zm9jdXM6dGhpcy5fb25Gb2N1cyxibHVyOnRoaXMuX29uQmx1cixtb3VzZWRvd246dGhpcy5fb25Nb3VzZURvd259LHRoaXMpLHRoaXMuX21hcC5vZmYoe2ZvY3VzOnRoaXMuX2FkZEhvb2tzLGJsdXI6dGhpcy5fcmVtb3ZlSG9va3N9LHRoaXMpfSxfb25Nb3VzZURvd246ZnVuY3Rpb24oKXtpZighdGhpcy5fZm9jdXNlZCl7dmFyIGk9ZS5ib2R5LG49ZS5kb2N1bWVudEVsZW1lbnQsbz1pLnNjcm9sbFRvcHx8bi5zY3JvbGxUb3Ascz1pLnNjcm9sbExlZnR8fG4uc2Nyb2xsTGVmdDt0aGlzLl9tYXAuX2NvbnRhaW5lci5mb2N1cygpLHQuc2Nyb2xsVG8ocyxvKX19LF9vbkZvY3VzOmZ1bmN0aW9uKCl7dGhpcy5fZm9jdXNlZD0hMCx0aGlzLl9tYXAuZmlyZShcImZvY3VzXCIpfSxfb25CbHVyOmZ1bmN0aW9uKCl7dGhpcy5fZm9jdXNlZD0hMSx0aGlzLl9tYXAuZmlyZShcImJsdXJcIil9LF9zZXRQYW5EZWx0YTpmdW5jdGlvbih0KXt2YXIgZSxpLG49dGhpcy5fcGFuS2V5cz17fSxvPXRoaXMua2V5Q29kZXM7Zm9yKGU9MCxpPW8ubGVmdC5sZW5ndGg7ZTxpO2UrKyluW28ubGVmdFtlXV09Wy0xKnQsMF07Zm9yKGU9MCxpPW8ucmlnaHQubGVuZ3RoO2U8aTtlKyspbltvLnJpZ2h0W2VdXT1bdCwwXTtmb3IoZT0wLGk9by5kb3duLmxlbmd0aDtlPGk7ZSsrKW5bby5kb3duW2VdXT1bMCx0XTtmb3IoZT0wLGk9by51cC5sZW5ndGg7ZTxpO2UrKyluW28udXBbZV1dPVswLC0xKnRdfSxfc2V0Wm9vbURlbHRhOmZ1bmN0aW9uKHQpe3ZhciBlLGksbj10aGlzLl96b29tS2V5cz17fSxvPXRoaXMua2V5Q29kZXM7Zm9yKGU9MCxpPW8uem9vbUluLmxlbmd0aDtlPGk7ZSsrKW5bby56b29tSW5bZV1dPXQ7Zm9yKGU9MCxpPW8uem9vbU91dC5sZW5ndGg7ZTxpO2UrKyluW28uem9vbU91dFtlXV09LXR9LF9hZGRIb29rczpmdW5jdGlvbigpe28uRG9tRXZlbnQub24oZSxcImtleWRvd25cIix0aGlzLl9vbktleURvd24sdGhpcyl9LF9yZW1vdmVIb29rczpmdW5jdGlvbigpe28uRG9tRXZlbnQub2ZmKGUsXCJrZXlkb3duXCIsdGhpcy5fb25LZXlEb3duLHRoaXMpfSxfb25LZXlEb3duOmZ1bmN0aW9uKHQpe2lmKCEodC5hbHRLZXl8fHQuY3RybEtleXx8dC5tZXRhS2V5KSl7dmFyIGUsaT10LmtleUNvZGUsbj10aGlzLl9tYXA7aWYoaSBpbiB0aGlzLl9wYW5LZXlzKXtpZihuLl9wYW5BbmltJiZuLl9wYW5BbmltLl9pblByb2dyZXNzKXJldHVybjtlPXRoaXMuX3BhbktleXNbaV0sdC5zaGlmdEtleSYmKGU9by5wb2ludChlKS5tdWx0aXBseUJ5KDMpKSxuLnBhbkJ5KGUpLG4ub3B0aW9ucy5tYXhCb3VuZHMmJm4ucGFuSW5zaWRlQm91bmRzKG4ub3B0aW9ucy5tYXhCb3VuZHMpfWVsc2UgaWYoaSBpbiB0aGlzLl96b29tS2V5cyluLnNldFpvb20obi5nZXRab29tKCkrKHQuc2hpZnRLZXk/MzoxKSp0aGlzLl96b29tS2V5c1tpXSk7ZWxzZXtpZigyNyE9PWkpcmV0dXJuO24uY2xvc2VQb3B1cCgpfW8uRG9tRXZlbnQuc3RvcCh0KX19fSksby5NYXAuYWRkSW5pdEhvb2soXCJhZGRIYW5kbGVyXCIsXCJrZXlib2FyZFwiLG8uTWFwLktleWJvYXJkKSxvLkhhbmRsZXIuTWFya2VyRHJhZz1vLkhhbmRsZXIuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuX21hcmtlcj10fSxhZGRIb29rczpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX21hcmtlci5faWNvbjt0aGlzLl9kcmFnZ2FibGV8fCh0aGlzLl9kcmFnZ2FibGU9bmV3IG8uRHJhZ2dhYmxlKHQsdCwhMCkpLHRoaXMuX2RyYWdnYWJsZS5vbih7ZHJhZ3N0YXJ0OnRoaXMuX29uRHJhZ1N0YXJ0LGRyYWc6dGhpcy5fb25EcmFnLGRyYWdlbmQ6dGhpcy5fb25EcmFnRW5kfSx0aGlzKS5lbmFibGUoKSxvLkRvbVV0aWwuYWRkQ2xhc3ModCxcImxlYWZsZXQtbWFya2VyLWRyYWdnYWJsZVwiKX0scmVtb3ZlSG9va3M6ZnVuY3Rpb24oKXt0aGlzLl9kcmFnZ2FibGUub2ZmKHtkcmFnc3RhcnQ6dGhpcy5fb25EcmFnU3RhcnQsZHJhZzp0aGlzLl9vbkRyYWcsZHJhZ2VuZDp0aGlzLl9vbkRyYWdFbmR9LHRoaXMpLmRpc2FibGUoKSx0aGlzLl9tYXJrZXIuX2ljb24mJm8uRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl9tYXJrZXIuX2ljb24sXCJsZWFmbGV0LW1hcmtlci1kcmFnZ2FibGVcIil9LG1vdmVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RyYWdnYWJsZSYmdGhpcy5fZHJhZ2dhYmxlLl9tb3ZlZH0sX29uRHJhZ1N0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5fb2xkTGF0TG5nPXRoaXMuX21hcmtlci5nZXRMYXRMbmcoKSx0aGlzLl9tYXJrZXIuY2xvc2VQb3B1cCgpLmZpcmUoXCJtb3Zlc3RhcnRcIikuZmlyZShcImRyYWdzdGFydFwiKX0sX29uRHJhZzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9tYXJrZXIsaT1lLl9zaGFkb3csbj1vLkRvbVV0aWwuZ2V0UG9zaXRpb24oZS5faWNvbikscz1lLl9tYXAubGF5ZXJQb2ludFRvTGF0TG5nKG4pO2kmJm8uRG9tVXRpbC5zZXRQb3NpdGlvbihpLG4pLGUuX2xhdGxuZz1zLHQubGF0bG5nPXMsdC5vbGRMYXRMbmc9dGhpcy5fb2xkTGF0TG5nLGUuZmlyZShcIm1vdmVcIix0KS5maXJlKFwiZHJhZ1wiLHQpfSxfb25EcmFnRW5kOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0aGlzLl9vbGRMYXRMbmcsdGhpcy5fbWFya2VyLmZpcmUoXCJtb3ZlZW5kXCIpLmZpcmUoXCJkcmFnZW5kXCIsdCl9fSksby5Db250cm9sPW8uQ2xhc3MuZXh0ZW5kKHtvcHRpb25zOntwb3NpdGlvbjpcInRvcHJpZ2h0XCJ9LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7by5zZXRPcHRpb25zKHRoaXMsdCl9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5wb3NpdGlvbn0sc2V0UG9zaXRpb246ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fbWFwO3JldHVybiBlJiZlLnJlbW92ZUNvbnRyb2wodGhpcyksdGhpcy5vcHRpb25zLnBvc2l0aW9uPXQsZSYmZS5hZGRDb250cm9sKHRoaXMpLHRoaXN9LGdldENvbnRhaW5lcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb250YWluZXJ9LGFkZFRvOmZ1bmN0aW9uKHQpe3RoaXMucmVtb3ZlKCksdGhpcy5fbWFwPXQ7dmFyIGU9dGhpcy5fY29udGFpbmVyPXRoaXMub25BZGQodCksaT10aGlzLmdldFBvc2l0aW9uKCksbj10Ll9jb250cm9sQ29ybmVyc1tpXTtyZXR1cm4gby5Eb21VdGlsLmFkZENsYXNzKGUsXCJsZWFmbGV0LWNvbnRyb2xcIiksaS5pbmRleE9mKFwiYm90dG9tXCIpIT09LTE/bi5pbnNlcnRCZWZvcmUoZSxuLmZpcnN0Q2hpbGQpOm4uYXBwZW5kQ2hpbGQoZSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21hcD8oby5Eb21VdGlsLnJlbW92ZSh0aGlzLl9jb250YWluZXIpLHRoaXMub25SZW1vdmUmJnRoaXMub25SZW1vdmUodGhpcy5fbWFwKSx0aGlzLl9tYXA9bnVsbCx0aGlzKTp0aGlzfSxfcmVmb2N1c09uTWFwOmZ1bmN0aW9uKHQpe3RoaXMuX21hcCYmdCYmdC5zY3JlZW5YPjAmJnQuc2NyZWVuWT4wJiZ0aGlzLl9tYXAuZ2V0Q29udGFpbmVyKCkuZm9jdXMoKX19KSxvLmNvbnRyb2w9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvLkNvbnRyb2wodCl9LG8uTWFwLmluY2x1ZGUoe2FkZENvbnRyb2w6ZnVuY3Rpb24odCl7cmV0dXJuIHQuYWRkVG8odGhpcyksdGhpc30scmVtb3ZlQ29udHJvbDpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZW1vdmUoKSx0aGlzfSxfaW5pdENvbnRyb2xQb3M6ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQscyl7dmFyIHI9aSt0K1wiIFwiK2krcztlW3Qrc109by5Eb21VdGlsLmNyZWF0ZShcImRpdlwiLHIsbil9dmFyIGU9dGhpcy5fY29udHJvbENvcm5lcnM9e30saT1cImxlYWZsZXQtXCIsbj10aGlzLl9jb250cm9sQ29udGFpbmVyPW8uRG9tVXRpbC5jcmVhdGUoXCJkaXZcIixpK1wiY29udHJvbC1jb250YWluZXJcIix0aGlzLl9jb250YWluZXIpO3QoXCJ0b3BcIixcImxlZnRcIiksdChcInRvcFwiLFwicmlnaHRcIiksdChcImJvdHRvbVwiLFwibGVmdFwiKSx0KFwiYm90dG9tXCIsXCJyaWdodFwiKX0sX2NsZWFyQ29udHJvbFBvczpmdW5jdGlvbigpe28uRG9tVXRpbC5yZW1vdmUodGhpcy5fY29udHJvbENvbnRhaW5lcil9fSksby5Db250cm9sLlpvb209by5Db250cm9sLmV4dGVuZCh7b3B0aW9uczp7cG9zaXRpb246XCJ0b3BsZWZ0XCIsem9vbUluVGV4dDpcIitcIix6b29tSW5UaXRsZTpcIlpvb20gaW5cIix6b29tT3V0VGV4dDpcIi1cIix6b29tT3V0VGl0bGU6XCJab29tIG91dFwifSxvbkFkZDpmdW5jdGlvbih0KXt2YXIgZT1cImxlYWZsZXQtY29udHJvbC16b29tXCIsaT1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsZStcIiBsZWFmbGV0LWJhclwiKSxuPXRoaXMub3B0aW9ucztyZXR1cm4gdGhpcy5fem9vbUluQnV0dG9uPXRoaXMuX2NyZWF0ZUJ1dHRvbihuLnpvb21JblRleHQsbi56b29tSW5UaXRsZSxlK1wiLWluXCIsaSx0aGlzLl96b29tSW4pLHRoaXMuX3pvb21PdXRCdXR0b249dGhpcy5fY3JlYXRlQnV0dG9uKG4uem9vbU91dFRleHQsbi56b29tT3V0VGl0bGUsZStcIi1vdXRcIixpLHRoaXMuX3pvb21PdXQpLHRoaXMuX3VwZGF0ZURpc2FibGVkKCksdC5vbihcInpvb21lbmQgem9vbWxldmVsc2NoYW5nZVwiLHRoaXMuX3VwZGF0ZURpc2FibGVkLHRoaXMpLGl9LG9uUmVtb3ZlOmZ1bmN0aW9uKHQpe3Qub2ZmKFwiem9vbWVuZCB6b29tbGV2ZWxzY2hhbmdlXCIsdGhpcy5fdXBkYXRlRGlzYWJsZWQsdGhpcyl9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGlzYWJsZWQ9ITAsdGhpcy5fdXBkYXRlRGlzYWJsZWQoKSx0aGlzfSxlbmFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGlzYWJsZWQ9ITEsdGhpcy5fdXBkYXRlRGlzYWJsZWQoKSx0aGlzfSxfem9vbUluOmZ1bmN0aW9uKHQpeyF0aGlzLl9kaXNhYmxlZCYmdGhpcy5fbWFwLl96b29tPHRoaXMuX21hcC5nZXRNYXhab29tKCkmJnRoaXMuX21hcC56b29tSW4odGhpcy5fbWFwLm9wdGlvbnMuem9vbURlbHRhKih0LnNoaWZ0S2V5PzM6MSkpfSxfem9vbU91dDpmdW5jdGlvbih0KXshdGhpcy5fZGlzYWJsZWQmJnRoaXMuX21hcC5fem9vbT50aGlzLl9tYXAuZ2V0TWluWm9vbSgpJiZ0aGlzLl9tYXAuem9vbU91dCh0aGlzLl9tYXAub3B0aW9ucy56b29tRGVsdGEqKHQuc2hpZnRLZXk/MzoxKSl9LF9jcmVhdGVCdXR0b246ZnVuY3Rpb24odCxlLGksbixzKXt2YXIgcj1vLkRvbVV0aWwuY3JlYXRlKFwiYVwiLGksbik7cmV0dXJuIHIuaW5uZXJIVE1MPXQsci5ocmVmPVwiI1wiLHIudGl0bGU9ZSxyLnNldEF0dHJpYnV0ZShcInJvbGVcIixcImJ1dHRvblwiKSxyLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIixlKSxvLkRvbUV2ZW50Lm9uKHIsXCJtb3VzZWRvd24gZGJsY2xpY2tcIixvLkRvbUV2ZW50LnN0b3BQcm9wYWdhdGlvbikub24ocixcImNsaWNrXCIsby5Eb21FdmVudC5zdG9wKS5vbihyLFwiY2xpY2tcIixzLHRoaXMpLm9uKHIsXCJjbGlja1wiLHRoaXMuX3JlZm9jdXNPbk1hcCx0aGlzKSxyfSxfdXBkYXRlRGlzYWJsZWQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9tYXAsZT1cImxlYWZsZXQtZGlzYWJsZWRcIjtvLkRvbVV0aWwucmVtb3ZlQ2xhc3ModGhpcy5fem9vbUluQnV0dG9uLGUpLG8uRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl96b29tT3V0QnV0dG9uLGUpLCh0aGlzLl9kaXNhYmxlZHx8dC5fem9vbT09PXQuZ2V0TWluWm9vbSgpKSYmby5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX3pvb21PdXRCdXR0b24sZSksKHRoaXMuX2Rpc2FibGVkfHx0Ll96b29tPT09dC5nZXRNYXhab29tKCkpJiZvLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5fem9vbUluQnV0dG9uLGUpfX0pLG8uTWFwLm1lcmdlT3B0aW9ucyh7em9vbUNvbnRyb2w6ITB9KSxvLk1hcC5hZGRJbml0SG9vayhmdW5jdGlvbigpe3RoaXMub3B0aW9ucy56b29tQ29udHJvbCYmKHRoaXMuem9vbUNvbnRyb2w9bmV3IG8uQ29udHJvbC5ab29tLHRoaXMuYWRkQ29udHJvbCh0aGlzLnpvb21Db250cm9sKSl9KSxvLmNvbnRyb2wuem9vbT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8uQ29udHJvbC5ab29tKHQpfSxvLkNvbnRyb2wuQXR0cmlidXRpb249by5Db250cm9sLmV4dGVuZCh7b3B0aW9uczp7cG9zaXRpb246XCJib3R0b21yaWdodFwiLHByZWZpeDonPGEgaHJlZj1cImh0dHA6Ly9sZWFmbGV0anMuY29tXCIgdGl0bGU9XCJBIEpTIGxpYnJhcnkgZm9yIGludGVyYWN0aXZlIG1hcHNcIj5MZWFmbGV0PC9hPid9LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7by5zZXRPcHRpb25zKHRoaXMsdCksdGhpcy5fYXR0cmlidXRpb25zPXt9fSxvbkFkZDpmdW5jdGlvbih0KXt0LmF0dHJpYnV0aW9uQ29udHJvbD10aGlzLHRoaXMuX2NvbnRhaW5lcj1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsXCJsZWFmbGV0LWNvbnRyb2wtYXR0cmlidXRpb25cIiksby5Eb21FdmVudCYmby5Eb21FdmVudC5kaXNhYmxlQ2xpY2tQcm9wYWdhdGlvbih0aGlzLl9jb250YWluZXIpO2Zvcih2YXIgZSBpbiB0Ll9sYXllcnMpdC5fbGF5ZXJzW2VdLmdldEF0dHJpYnV0aW9uJiZ0aGlzLmFkZEF0dHJpYnV0aW9uKHQuX2xheWVyc1tlXS5nZXRBdHRyaWJ1dGlvbigpKTtyZXR1cm4gdGhpcy5fdXBkYXRlKCksdGhpcy5fY29udGFpbmVyfSxzZXRQcmVmaXg6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3B0aW9ucy5wcmVmaXg9dCx0aGlzLl91cGRhdGUoKSx0aGlzfSxhZGRBdHRyaWJ1dGlvbjpmdW5jdGlvbih0KXtyZXR1cm4gdD8odGhpcy5fYXR0cmlidXRpb25zW3RdfHwodGhpcy5fYXR0cmlidXRpb25zW3RdPTApLHRoaXMuX2F0dHJpYnV0aW9uc1t0XSsrLHRoaXMuX3VwZGF0ZSgpLHRoaXMpOnRoaXN9LHJlbW92ZUF0dHJpYnV0aW9uOmZ1bmN0aW9uKHQpe3JldHVybiB0Pyh0aGlzLl9hdHRyaWJ1dGlvbnNbdF0mJih0aGlzLl9hdHRyaWJ1dGlvbnNbdF0tLSx0aGlzLl91cGRhdGUoKSksdGhpcyk6dGhpc30sX3VwZGF0ZTpmdW5jdGlvbigpe2lmKHRoaXMuX21hcCl7dmFyIHQ9W107Zm9yKHZhciBlIGluIHRoaXMuX2F0dHJpYnV0aW9ucyl0aGlzLl9hdHRyaWJ1dGlvbnNbZV0mJnQucHVzaChlKTt2YXIgaT1bXTt0aGlzLm9wdGlvbnMucHJlZml4JiZpLnB1c2godGhpcy5vcHRpb25zLnByZWZpeCksdC5sZW5ndGgmJmkucHVzaCh0LmpvaW4oXCIsIFwiKSksdGhpcy5fY29udGFpbmVyLmlubmVySFRNTD1pLmpvaW4oXCIgfCBcIil9fX0pLG8uTWFwLm1lcmdlT3B0aW9ucyh7YXR0cmlidXRpb25Db250cm9sOiEwfSksby5NYXAuYWRkSW5pdEhvb2soZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXR0cmlidXRpb25Db250cm9sJiYobmV3IG8uQ29udHJvbC5BdHRyaWJ1dGlvbikuYWRkVG8odGhpcyl9KSxvLmNvbnRyb2wuYXR0cmlidXRpb249ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvLkNvbnRyb2wuQXR0cmlidXRpb24odCl9LG8uQ29udHJvbC5TY2FsZT1vLkNvbnRyb2wuZXh0ZW5kKHtvcHRpb25zOntwb3NpdGlvbjpcImJvdHRvbWxlZnRcIixtYXhXaWR0aDoxMDAsbWV0cmljOiEwLGltcGVyaWFsOiEwfSxvbkFkZDpmdW5jdGlvbih0KXt2YXIgZT1cImxlYWZsZXQtY29udHJvbC1zY2FsZVwiLGk9by5Eb21VdGlsLmNyZWF0ZShcImRpdlwiLGUpLG49dGhpcy5vcHRpb25zO3JldHVybiB0aGlzLl9hZGRTY2FsZXMobixlK1wiLWxpbmVcIixpKSx0Lm9uKG4udXBkYXRlV2hlbklkbGU/XCJtb3ZlZW5kXCI6XCJtb3ZlXCIsdGhpcy5fdXBkYXRlLHRoaXMpLHQud2hlblJlYWR5KHRoaXMuX3VwZGF0ZSx0aGlzKSxpfSxvblJlbW92ZTpmdW5jdGlvbih0KXt0Lm9mZih0aGlzLm9wdGlvbnMudXBkYXRlV2hlbklkbGU/XCJtb3ZlZW5kXCI6XCJtb3ZlXCIsdGhpcy5fdXBkYXRlLHRoaXMpfSxfYWRkU2NhbGVzOmZ1bmN0aW9uKHQsZSxpKXt0Lm1ldHJpYyYmKHRoaXMuX21TY2FsZT1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsZSxpKSksdC5pbXBlcmlhbCYmKHRoaXMuX2lTY2FsZT1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsZSxpKSl9LF91cGRhdGU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9tYXAsZT10LmdldFNpemUoKS55LzIsaT10LmRpc3RhbmNlKHQuY29udGFpbmVyUG9pbnRUb0xhdExuZyhbMCxlXSksdC5jb250YWluZXJQb2ludFRvTGF0TG5nKFt0aGlzLm9wdGlvbnMubWF4V2lkdGgsZV0pKTt0aGlzLl91cGRhdGVTY2FsZXMoaSl9LF91cGRhdGVTY2FsZXM6ZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zLm1ldHJpYyYmdCYmdGhpcy5fdXBkYXRlTWV0cmljKHQpLHRoaXMub3B0aW9ucy5pbXBlcmlhbCYmdCYmdGhpcy5fdXBkYXRlSW1wZXJpYWwodCl9LF91cGRhdGVNZXRyaWM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZ2V0Um91bmROdW0odCksaT1lPDFlMz9lK1wiIG1cIjplLzFlMytcIiBrbVwiO3RoaXMuX3VwZGF0ZVNjYWxlKHRoaXMuX21TY2FsZSxpLGUvdCl9LF91cGRhdGVJbXBlcmlhbDpmdW5jdGlvbih0KXt2YXIgZSxpLG4sbz0zLjI4MDgzOTkqdDtvPjUyODA/KGU9by81MjgwLGk9dGhpcy5fZ2V0Um91bmROdW0oZSksdGhpcy5fdXBkYXRlU2NhbGUodGhpcy5faVNjYWxlLGkrXCIgbWlcIixpL2UpKToobj10aGlzLl9nZXRSb3VuZE51bShvKSx0aGlzLl91cGRhdGVTY2FsZSh0aGlzLl9pU2NhbGUsbitcIiBmdFwiLG4vbykpfSxfdXBkYXRlU2NhbGU6ZnVuY3Rpb24odCxlLGkpe3Quc3R5bGUud2lkdGg9TWF0aC5yb3VuZCh0aGlzLm9wdGlvbnMubWF4V2lkdGgqaSkrXCJweFwiLHQuaW5uZXJIVE1MPWV9LF9nZXRSb3VuZE51bTpmdW5jdGlvbih0KXt2YXIgZT1NYXRoLnBvdygxMCwoTWF0aC5mbG9vcih0KStcIlwiKS5sZW5ndGgtMSksaT10L2U7cmV0dXJuIGk9aT49MTA/MTA6aT49NT81Omk+PTM/MzppPj0yPzI6MSxlKml9fSksby5jb250cm9sLnNjYWxlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgby5Db250cm9sLlNjYWxlKHQpfSxvLkNvbnRyb2wuTGF5ZXJzPW8uQ29udHJvbC5leHRlbmQoe29wdGlvbnM6e2NvbGxhcHNlZDohMCxwb3NpdGlvbjpcInRvcHJpZ2h0XCIsYXV0b1pJbmRleDohMCxoaWRlU2luZ2xlQmFzZTohMSxzb3J0TGF5ZXJzOiExLHNvcnRGdW5jdGlvbjpmdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gaTxuPy0xOm48aT8xOjB9fSxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSxpKXtvLnNldE9wdGlvbnModGhpcyxpKSx0aGlzLl9sYXllcnM9W10sdGhpcy5fbGFzdFpJbmRleD0wLHRoaXMuX2hhbmRsaW5nQ2xpY2s9ITE7Zm9yKHZhciBuIGluIHQpdGhpcy5fYWRkTGF5ZXIodFtuXSxuKTtmb3IobiBpbiBlKXRoaXMuX2FkZExheWVyKGVbbl0sbiwhMCl9LG9uQWRkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9pbml0TGF5b3V0KCksdGhpcy5fdXBkYXRlKCksdGhpcy5fbWFwPXQsdC5vbihcInpvb21lbmRcIix0aGlzLl9jaGVja0Rpc2FibGVkTGF5ZXJzLHRoaXMpLHRoaXMuX2NvbnRhaW5lcn0sb25SZW1vdmU6ZnVuY3Rpb24oKXt0aGlzLl9tYXAub2ZmKFwiem9vbWVuZFwiLHRoaXMuX2NoZWNrRGlzYWJsZWRMYXllcnMsdGhpcyk7Zm9yKHZhciB0PTA7dDx0aGlzLl9sYXllcnMubGVuZ3RoO3QrKyl0aGlzLl9sYXllcnNbdF0ubGF5ZXIub2ZmKFwiYWRkIHJlbW92ZVwiLHRoaXMuX29uTGF5ZXJDaGFuZ2UsdGhpcyl9LGFkZEJhc2VMYXllcjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9hZGRMYXllcih0LGUpLHRoaXMuX21hcD90aGlzLl91cGRhdGUoKTp0aGlzfSxhZGRPdmVybGF5OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX2FkZExheWVyKHQsZSwhMCksdGhpcy5fbWFwP3RoaXMuX3VwZGF0ZSgpOnRoaXN9LHJlbW92ZUxheWVyOmZ1bmN0aW9uKHQpe3Qub2ZmKFwiYWRkIHJlbW92ZVwiLHRoaXMuX29uTGF5ZXJDaGFuZ2UsdGhpcyk7dmFyIGU9dGhpcy5fZ2V0TGF5ZXIoby5zdGFtcCh0KSk7cmV0dXJuIGUmJnRoaXMuX2xheWVycy5zcGxpY2UodGhpcy5fbGF5ZXJzLmluZGV4T2YoZSksMSksdGhpcy5fbWFwP3RoaXMuX3VwZGF0ZSgpOnRoaXN9LGV4cGFuZDpmdW5jdGlvbigpe28uRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9jb250YWluZXIsXCJsZWFmbGV0LWNvbnRyb2wtbGF5ZXJzLWV4cGFuZGVkXCIpLHRoaXMuX2Zvcm0uc3R5bGUuaGVpZ2h0PW51bGw7dmFyIHQ9dGhpcy5fbWFwLmdldFNpemUoKS55LSh0aGlzLl9jb250YWluZXIub2Zmc2V0VG9wKzUwKTtyZXR1cm4gdDx0aGlzLl9mb3JtLmNsaWVudEhlaWdodD8oby5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX2Zvcm0sXCJsZWFmbGV0LWNvbnRyb2wtbGF5ZXJzLXNjcm9sbGJhclwiKSx0aGlzLl9mb3JtLnN0eWxlLmhlaWdodD10K1wicHhcIik6by5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX2Zvcm0sXCJsZWFmbGV0LWNvbnRyb2wtbGF5ZXJzLXNjcm9sbGJhclwiKSx0aGlzLl9jaGVja0Rpc2FibGVkTGF5ZXJzKCksdGhpc30sY29sbGFwc2U6ZnVuY3Rpb24oKXtyZXR1cm4gby5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX2NvbnRhaW5lcixcImxlYWZsZXQtY29udHJvbC1sYXllcnMtZXhwYW5kZWRcIiksdGhpc30sX2luaXRMYXlvdXQ6ZnVuY3Rpb24oKXt2YXIgdD1cImxlYWZsZXQtY29udHJvbC1sYXllcnNcIixlPXRoaXMuX2NvbnRhaW5lcj1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsdCksaT10aGlzLm9wdGlvbnMuY29sbGFwc2VkO2Uuc2V0QXR0cmlidXRlKFwiYXJpYS1oYXNwb3B1cFwiLCEwKSxvLkRvbUV2ZW50LmRpc2FibGVDbGlja1Byb3BhZ2F0aW9uKGUpLG8uQnJvd3Nlci50b3VjaHx8by5Eb21FdmVudC5kaXNhYmxlU2Nyb2xsUHJvcGFnYXRpb24oZSk7dmFyIG49dGhpcy5fZm9ybT1vLkRvbVV0aWwuY3JlYXRlKFwiZm9ybVwiLHQrXCItbGlzdFwiKTtpJiYodGhpcy5fbWFwLm9uKFwiY2xpY2tcIix0aGlzLmNvbGxhcHNlLHRoaXMpLG8uQnJvd3Nlci5hbmRyb2lkfHxvLkRvbUV2ZW50Lm9uKGUse21vdXNlZW50ZXI6dGhpcy5leHBhbmQsbW91c2VsZWF2ZTp0aGlzLmNvbGxhcHNlfSx0aGlzKSk7dmFyIHM9dGhpcy5fbGF5ZXJzTGluaz1vLkRvbVV0aWwuY3JlYXRlKFwiYVwiLHQrXCItdG9nZ2xlXCIsZSk7cy5ocmVmPVwiI1wiLHMudGl0bGU9XCJMYXllcnNcIixvLkJyb3dzZXIudG91Y2g/by5Eb21FdmVudC5vbihzLFwiY2xpY2tcIixvLkRvbUV2ZW50LnN0b3ApLm9uKHMsXCJjbGlja1wiLHRoaXMuZXhwYW5kLHRoaXMpOm8uRG9tRXZlbnQub24ocyxcImZvY3VzXCIsdGhpcy5leHBhbmQsdGhpcyksby5Eb21FdmVudC5vbihuLFwiY2xpY2tcIixmdW5jdGlvbigpe3NldFRpbWVvdXQoby5iaW5kKHRoaXMuX29uSW5wdXRDbGljayx0aGlzKSwwKX0sdGhpcyksaXx8dGhpcy5leHBhbmQoKSx0aGlzLl9iYXNlTGF5ZXJzTGlzdD1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsdCtcIi1iYXNlXCIsbiksdGhpcy5fc2VwYXJhdG9yPW8uRG9tVXRpbC5jcmVhdGUoXCJkaXZcIix0K1wiLXNlcGFyYXRvclwiLG4pLHRoaXMuX292ZXJsYXlzTGlzdD1vLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsdCtcIi1vdmVybGF5c1wiLG4pLGUuYXBwZW5kQ2hpbGQobil9LF9nZXRMYXllcjpmdW5jdGlvbih0KXtmb3IodmFyIGU9MDtlPHRoaXMuX2xheWVycy5sZW5ndGg7ZSsrKWlmKHRoaXMuX2xheWVyc1tlXSYmby5zdGFtcCh0aGlzLl9sYXllcnNbZV0ubGF5ZXIpPT09dClyZXR1cm4gdGhpcy5fbGF5ZXJzW2VdfSxfYWRkTGF5ZXI6ZnVuY3Rpb24odCxlLGkpe3Qub24oXCJhZGQgcmVtb3ZlXCIsdGhpcy5fb25MYXllckNoYW5nZSx0aGlzKSx0aGlzLl9sYXllcnMucHVzaCh7bGF5ZXI6dCxuYW1lOmUsb3ZlcmxheTppfSksdGhpcy5vcHRpb25zLnNvcnRMYXllcnMmJnRoaXMuX2xheWVycy5zb3J0KG8uYmluZChmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLm9wdGlvbnMuc29ydEZ1bmN0aW9uKHQubGF5ZXIsZS5sYXllcix0Lm5hbWUsZS5uYW1lKX0sdGhpcykpLHRoaXMub3B0aW9ucy5hdXRvWkluZGV4JiZ0LnNldFpJbmRleCYmKHRoaXMuX2xhc3RaSW5kZXgrKyx0LnNldFpJbmRleCh0aGlzLl9sYXN0WkluZGV4KSl9LF91cGRhdGU6ZnVuY3Rpb24oKXtpZighdGhpcy5fY29udGFpbmVyKXJldHVybiB0aGlzO28uRG9tVXRpbC5lbXB0eSh0aGlzLl9iYXNlTGF5ZXJzTGlzdCksby5Eb21VdGlsLmVtcHR5KHRoaXMuX292ZXJsYXlzTGlzdCk7dmFyIHQsZSxpLG4scz0wO2ZvcihpPTA7aTx0aGlzLl9sYXllcnMubGVuZ3RoO2krKyluPXRoaXMuX2xheWVyc1tpXSx0aGlzLl9hZGRJdGVtKG4pLGU9ZXx8bi5vdmVybGF5LHQ9dHx8IW4ub3ZlcmxheSxzKz1uLm92ZXJsYXk/MDoxO3JldHVybiB0aGlzLm9wdGlvbnMuaGlkZVNpbmdsZUJhc2UmJih0PXQmJnM+MSx0aGlzLl9iYXNlTGF5ZXJzTGlzdC5zdHlsZS5kaXNwbGF5PXQ/XCJcIjpcIm5vbmVcIiksdGhpcy5fc2VwYXJhdG9yLnN0eWxlLmRpc3BsYXk9ZSYmdD9cIlwiOlwibm9uZVwiLHRoaXN9LF9vbkxheWVyQ2hhbmdlOmZ1bmN0aW9uKHQpe3RoaXMuX2hhbmRsaW5nQ2xpY2t8fHRoaXMuX3VwZGF0ZSgpO3ZhciBlPXRoaXMuX2dldExheWVyKG8uc3RhbXAodC50YXJnZXQpKSxpPWUub3ZlcmxheT9cImFkZFwiPT09dC50eXBlP1wib3ZlcmxheWFkZFwiOlwib3ZlcmxheXJlbW92ZVwiOlwiYWRkXCI9PT10LnR5cGU/XCJiYXNlbGF5ZXJjaGFuZ2VcIjpudWxsO2kmJnRoaXMuX21hcC5maXJlKGksZSl9LF9jcmVhdGVSYWRpb0VsZW1lbnQ6ZnVuY3Rpb24odCxpKXt2YXIgbj0nPGlucHV0IHR5cGU9XCJyYWRpb1wiIGNsYXNzPVwibGVhZmxldC1jb250cm9sLWxheWVycy1zZWxlY3RvclwiIG5hbWU9XCInK3QrJ1wiJysoaT8nIGNoZWNrZWQ9XCJjaGVja2VkXCInOlwiXCIpK1wiLz5cIixvPWUuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gby5pbm5lckhUTUw9bixvLmZpcnN0Q2hpbGR9LF9hZGRJdGVtOmZ1bmN0aW9uKHQpe3ZhciBpLG49ZS5jcmVhdGVFbGVtZW50KFwibGFiZWxcIikscz10aGlzLl9tYXAuaGFzTGF5ZXIodC5sYXllcik7dC5vdmVybGF5PyhpPWUuY3JlYXRlRWxlbWVudChcImlucHV0XCIpLGkudHlwZT1cImNoZWNrYm94XCIsaS5jbGFzc05hbWU9XCJsZWFmbGV0LWNvbnRyb2wtbGF5ZXJzLXNlbGVjdG9yXCIsaS5kZWZhdWx0Q2hlY2tlZD1zKTppPXRoaXMuX2NyZWF0ZVJhZGlvRWxlbWVudChcImxlYWZsZXQtYmFzZS1sYXllcnNcIixzKSxpLmxheWVySWQ9by5zdGFtcCh0LmxheWVyKSxvLkRvbUV2ZW50Lm9uKGksXCJjbGlja1wiLHRoaXMuX29uSW5wdXRDbGljayx0aGlzKTt2YXIgcj1lLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3IuaW5uZXJIVE1MPVwiIFwiK3QubmFtZTt2YXIgYT1lLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7bi5hcHBlbmRDaGlsZChhKSxhLmFwcGVuZENoaWxkKGkpLGEuYXBwZW5kQ2hpbGQocik7dmFyIGg9dC5vdmVybGF5P3RoaXMuX292ZXJsYXlzTGlzdDp0aGlzLl9iYXNlTGF5ZXJzTGlzdDtyZXR1cm4gaC5hcHBlbmRDaGlsZChuKSx0aGlzLl9jaGVja0Rpc2FibGVkTGF5ZXJzKCksbn0sX29uSW5wdXRDbGljazpmdW5jdGlvbigpe3ZhciB0LGUsaSxuPXRoaXMuX2Zvcm0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKSxvPVtdLHM9W107dGhpcy5faGFuZGxpbmdDbGljaz0hMDtmb3IodmFyIHI9bi5sZW5ndGgtMTtyPj0wO3ItLSl0PW5bcl0sZT10aGlzLl9nZXRMYXllcih0LmxheWVySWQpLmxheWVyLGk9dGhpcy5fbWFwLmhhc0xheWVyKGUpLHQuY2hlY2tlZCYmIWk/by5wdXNoKGUpOiF0LmNoZWNrZWQmJmkmJnMucHVzaChlKTtmb3Iocj0wO3I8cy5sZW5ndGg7cisrKXRoaXMuX21hcC5yZW1vdmVMYXllcihzW3JdKTtmb3Iocj0wO3I8by5sZW5ndGg7cisrKXRoaXMuX21hcC5hZGRMYXllcihvW3JdKTt0aGlzLl9oYW5kbGluZ0NsaWNrPSExLHRoaXMuX3JlZm9jdXNPbk1hcCgpfSxfY2hlY2tEaXNhYmxlZExheWVyczpmdW5jdGlvbigpe2Zvcih2YXIgdCxlLG49dGhpcy5fZm9ybS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpLG89dGhpcy5fbWFwLmdldFpvb20oKSxzPW4ubGVuZ3RoLTE7cz49MDtzLS0pdD1uW3NdLGU9dGhpcy5fZ2V0TGF5ZXIodC5sYXllcklkKS5sYXllcix0LmRpc2FibGVkPWUub3B0aW9ucy5taW5ab29tIT09aSYmbzxlLm9wdGlvbnMubWluWm9vbXx8ZS5vcHRpb25zLm1heFpvb20hPT1pJiZvPmUub3B0aW9ucy5tYXhab29tfSxfZXhwYW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXhwYW5kKCl9LF9jb2xsYXBzZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbGxhcHNlKCl9fSksby5jb250cm9sLmxheWVycz1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIG5ldyBvLkNvbnRyb2wuTGF5ZXJzKHQsZSxpKX19KHdpbmRvdyxkb2N1bWVudCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgIC8vIHNhdmUgdGhlc2Ugb3JpZ2luYWwgbWV0aG9kcyBiZWZvcmUgdGhleSBhcmUgb3ZlcndyaXR0ZW5cbiAgICB2YXIgcHJvdG9faW5pdEljb24gPSBMLk1hcmtlci5wcm90b3R5cGUuX2luaXRJY29uO1xuICAgIHZhciBwcm90b19zZXRQb3MgPSBMLk1hcmtlci5wcm90b3R5cGUuX3NldFBvcztcbiAgICB2YXIgcHJvdG9fb25EcmFnID0gTC5IYW5kbGVyLk1hcmtlckRyYWcucHJvdG90eXBlLl9vbkRyYWc7XG5cbiAgICB2YXIgb2xkSUUgPSAoTC5Eb21VdGlsLlRSQU5TRk9STSA9PT0gJ21zVHJhbnNmb3JtJyk7XG5cbiAgICBMLk1hcmtlci5hZGRJbml0SG9vayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpY29uT3B0aW9ucyA9IHRoaXMub3B0aW9ucy5pY29uICYmIHRoaXMub3B0aW9ucy5pY29uLm9wdGlvbnM7XG4gICAgICAgIHZhciBpY29uQW5jaG9yID0gaWNvbk9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLmljb24ub3B0aW9ucy5pY29uQW5jaG9yO1xuICAgICAgICBpZiAoaWNvbkFuY2hvcikge1xuICAgICAgICAgICAgaWNvbkFuY2hvciA9IChpY29uQW5jaG9yWzBdICsgJ3B4ICcgKyBpY29uQW5jaG9yWzFdICsgJ3B4Jyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vcHRpb25zLnJvdGF0aW9uT3JpZ2luID0gdGhpcy5vcHRpb25zLnJvdGF0aW9uT3JpZ2luIHx8IGljb25BbmNob3IgfHwgJ2NlbnRlciBib3R0b20nIDtcbiAgICAgICAgdGhpcy5vcHRpb25zLnJvdGF0aW9uQW5nbGUgPSB0aGlzLm9wdGlvbnMucm90YXRpb25BbmdsZSB8fCAwO1xuICAgIH0pO1xuXG4gICAgTC5NYXJrZXIuaW5jbHVkZSh7XG4gICAgICAgIF9pbml0SWNvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBwcm90b19pbml0SWNvbi5jYWxsKHRoaXMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9zZXRQb3M6IGZ1bmN0aW9uIChwb3MpIHtcbiAgICAgICAgICAgIHByb3RvX3NldFBvcy5jYWxsKHRoaXMsIHBvcyk7XG4gICAgICAgICAgICB0aGlzLl9hcHBseVJvdGF0aW9uKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2FwcGx5Um90YXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmKHRoaXMub3B0aW9ucy5yb3RhdGlvbkFuZ2xlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faWNvbi5zdHlsZVtMLkRvbVV0aWwuVFJBTlNGT1JNKydPcmlnaW4nXSA9IHRoaXMub3B0aW9ucy5yb3RhdGlvbk9yaWdpbjtcblxuICAgICAgICAgICAgICAgIGlmKG9sZElFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciBJRSA5LCB1c2UgdGhlIDJEIHJvdGF0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ljb24uc3R5bGVbTC5Eb21VdGlsLlRSQU5TRk9STV0gPSAncm90YXRlKCcgKyB0aGlzLm9wdGlvbnMucm90YXRpb25BbmdsZSArICdkZWcpJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgbW9kZXJuIGJyb3dzZXJzLCBwcmVmZXIgdGhlIDNEIGFjY2VsZXJhdGVkIHZlcnNpb25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faWNvbi5zdHlsZVtMLkRvbVV0aWwuVFJBTlNGT1JNXSArPSAnIHJvdGF0ZVooJyArIHRoaXMub3B0aW9ucy5yb3RhdGlvbkFuZ2xlICsgJ2RlZyknO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzZXRSb3RhdGlvbkFuZ2xlOiBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnJvdGF0aW9uQW5nbGUgPSBhbmdsZTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRSb3RhdGlvbk9yaWdpbjogZnVuY3Rpb24ob3JpZ2luKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucm90YXRpb25PcmlnaW4gPSBvcmlnaW47XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIEwuSGFuZGxlci5NYXJrZXJEcmFnLmluY2x1ZGUoe1xuICAgICAgICBfb25EcmFnOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgcHJvdG9fb25EcmFnLmNhbGwodGhpcywgZSk7XG4gICAgICAgICAgICB0aGlzLl9tYXJrZXIuX2FwcGx5Um90YXRpb24oKTtcbiAgICAgICAgfVxuICAgIH0pXG59KSgpO1xuIiwiLyohIExlYWZsZXQuQ29vcmRpbmF0ZXMgMDMtMDctMjAxMyAqL1xuTC5Db250cm9sLkNvb3JkaW5hdGVzPUwuQ29udHJvbC5leHRlbmQoe29wdGlvbnM6e3Bvc2l0aW9uOlwiYm90dG9tcmlnaHRcIixkZWNpbWFsczo0LGRlY2ltYWxTZXBlcmF0b3I6XCIuXCIsbGFiZWxUZW1wbGF0ZUxhdDpcIkxhdDoge3l9XCIsbGFiZWxUZW1wbGF0ZUxuZzpcIkxuZzoge3h9XCIsbGFiZWxGb3JtYXR0ZXJMYXQ6dm9pZCAwLGxhYmVsRm9ybWF0dGVyTG5nOnZvaWQgMCxlbmFibGVVc2VySW5wdXQ6ITAsdXNlRE1TOiExLHVzZUxhdExuZ09yZGVyOiExfSxvbkFkZDpmdW5jdGlvbihhKXt0aGlzLl9tYXA9YTt2YXIgYj1cImxlYWZsZXQtY29udHJvbC1jb29yZGluYXRlc1wiLGM9dGhpcy5fY29udGFpbmVyPUwuRG9tVXRpbC5jcmVhdGUoXCJkaXZcIixiKSxkPXRoaXMub3B0aW9uczt0aGlzLl9sYWJlbGNvbnRhaW5lcj1MLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsXCJ1aUVsZW1lbnQgbGFiZWxcIixjKSx0aGlzLl9sYWJlbD1MLkRvbVV0aWwuY3JlYXRlKFwic3BhblwiLFwibGFiZWxGaXJzdFwiLHRoaXMuX2xhYmVsY29udGFpbmVyKSx0aGlzLl9pbnB1dGNvbnRhaW5lcj1MLkRvbVV0aWwuY3JlYXRlKFwiZGl2XCIsXCJ1aUVsZW1lbnQgaW5wdXQgdWlIaWRkZW5cIixjKTt2YXIgZSxmO3JldHVybiBkLnVzZUxhdExuZ09yZGVyPyhmPUwuRG9tVXRpbC5jcmVhdGUoXCJzcGFuXCIsXCJcIix0aGlzLl9pbnB1dGNvbnRhaW5lciksdGhpcy5faW5wdXRZPXRoaXMuX2NyZWF0ZUlucHV0KFwiaW5wdXRZXCIsdGhpcy5faW5wdXRjb250YWluZXIpLGU9TC5Eb21VdGlsLmNyZWF0ZShcInNwYW5cIixcIlwiLHRoaXMuX2lucHV0Y29udGFpbmVyKSx0aGlzLl9pbnB1dFg9dGhpcy5fY3JlYXRlSW5wdXQoXCJpbnB1dFhcIix0aGlzLl9pbnB1dGNvbnRhaW5lcikpOihlPUwuRG9tVXRpbC5jcmVhdGUoXCJzcGFuXCIsXCJcIix0aGlzLl9pbnB1dGNvbnRhaW5lciksdGhpcy5faW5wdXRYPXRoaXMuX2NyZWF0ZUlucHV0KFwiaW5wdXRYXCIsdGhpcy5faW5wdXRjb250YWluZXIpLGY9TC5Eb21VdGlsLmNyZWF0ZShcInNwYW5cIixcIlwiLHRoaXMuX2lucHV0Y29udGFpbmVyKSx0aGlzLl9pbnB1dFk9dGhpcy5fY3JlYXRlSW5wdXQoXCJpbnB1dFlcIix0aGlzLl9pbnB1dGNvbnRhaW5lcikpLGUuaW5uZXJIVE1MPWQubGFiZWxUZW1wbGF0ZUxuZy5yZXBsYWNlKFwie3h9XCIsXCJcIiksZi5pbm5lckhUTUw9ZC5sYWJlbFRlbXBsYXRlTGF0LnJlcGxhY2UoXCJ7eX1cIixcIlwiKSxMLkRvbUV2ZW50Lm9uKHRoaXMuX2lucHV0WCxcImtleXVwXCIsdGhpcy5faGFuZGxlS2V5cHJlc3MsdGhpcyksTC5Eb21FdmVudC5vbih0aGlzLl9pbnB1dFksXCJrZXl1cFwiLHRoaXMuX2hhbmRsZUtleXByZXNzLHRoaXMpLGEub24oXCJtb3VzZW1vdmVcIix0aGlzLl91cGRhdGUsdGhpcyksYS5vbihcImRyYWdzdGFydFwiLHRoaXMuY29sbGFwc2UsdGhpcyksYS53aGVuUmVhZHkodGhpcy5fdXBkYXRlLHRoaXMpLHRoaXMuX3Nob3dzQ29vcmRpbmF0ZXM9ITAsZC5lbmFibGVVc2VySW5wdXQmJkwuRG9tRXZlbnQuYWRkTGlzdGVuZXIodGhpcy5fY29udGFpbmVyLFwiY2xpY2tcIix0aGlzLl9zd2l0Y2hVSSx0aGlzKSxjfSxfY3JlYXRlSW5wdXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1MLkRvbVV0aWwuY3JlYXRlKFwiaW5wdXRcIixhLGIpO3JldHVybiBjLnR5cGU9XCJ0ZXh0XCIsTC5Eb21FdmVudC5kaXNhYmxlQ2xpY2tQcm9wYWdhdGlvbihjKSxjfSxfY2xlYXJNYXJrZXI6ZnVuY3Rpb24oKXt0aGlzLl9tYXAucmVtb3ZlTGF5ZXIodGhpcy5fbWFya2VyKX0sX2hhbmRsZUtleXByZXNzOmZ1bmN0aW9uKGEpe3N3aXRjaChhLmtleUNvZGUpe2Nhc2UgMjc6dGhpcy5jb2xsYXBzZSgpO2JyZWFrO2Nhc2UgMTM6dGhpcy5faGFuZGxlU3VibWl0KCksdGhpcy5jb2xsYXBzZSgpO2JyZWFrO2RlZmF1bHQ6dGhpcy5faGFuZGxlU3VibWl0KCl9fSxfaGFuZGxlU3VibWl0OmZ1bmN0aW9uKCl7dmFyIGE9TC5OdW1iZXJGb3JtYXR0ZXIuY3JlYXRlVmFsaWROdW1iZXIodGhpcy5faW5wdXRYLnZhbHVlLHRoaXMub3B0aW9ucy5kZWNpbWFsU2VwZXJhdG9yKSxiPUwuTnVtYmVyRm9ybWF0dGVyLmNyZWF0ZVZhbGlkTnVtYmVyKHRoaXMuX2lucHV0WS52YWx1ZSx0aGlzLm9wdGlvbnMuZGVjaW1hbFNlcGVyYXRvcik7aWYodm9pZCAwIT09YSYmdm9pZCAwIT09Yil7dmFyIGM9dGhpcy5fbWFya2VyO2N8fChjPXRoaXMuX21hcmtlcj1MLm1hcmtlcigpLGMub24oXCJjbGlja1wiLHRoaXMuX2NsZWFyTWFya2VyLHRoaXMpKSxjLnNldExhdExuZyhuZXcgTC5MYXRMbmcoYixhKSksYy5hZGRUbyh0aGlzLl9tYXApfX0sZXhwYW5kOmZ1bmN0aW9uKCl7dGhpcy5fc2hvd3NDb29yZGluYXRlcz0hMSx0aGlzLl9tYXAub2ZmKFwibW91c2Vtb3ZlXCIsdGhpcy5fdXBkYXRlLHRoaXMpLEwuRG9tRXZlbnQuYWRkTGlzdGVuZXIodGhpcy5fY29udGFpbmVyLFwibW91c2Vtb3ZlXCIsTC5Eb21FdmVudC5zdG9wKSxMLkRvbUV2ZW50LnJlbW92ZUxpc3RlbmVyKHRoaXMuX2NvbnRhaW5lcixcImNsaWNrXCIsdGhpcy5fc3dpdGNoVUksdGhpcyksTC5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX2xhYmVsY29udGFpbmVyLFwidWlIaWRkZW5cIiksTC5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX2lucHV0Y29udGFpbmVyLFwidWlIaWRkZW5cIil9LF9jcmVhdGVDb29yZGluYXRlTGFiZWw6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPXRoaXMub3B0aW9ucztyZXR1cm4gYj1kLmxhYmVsRm9ybWF0dGVyTG5nP2QubGFiZWxGb3JtYXR0ZXJMbmcoYS5sbmcpOkwuVXRpbC50ZW1wbGF0ZShkLmxhYmVsVGVtcGxhdGVMbmcse3g6dGhpcy5fZ2V0TnVtYmVyKGEubG5nLGQpfSksYz1kLmxhYmVsRm9ybWF0dGVyTGF0P2QubGFiZWxGb3JtYXR0ZXJMYXQoYS5sYXQpOkwuVXRpbC50ZW1wbGF0ZShkLmxhYmVsVGVtcGxhdGVMYXQse3k6dGhpcy5fZ2V0TnVtYmVyKGEubGF0LGQpfSksZC51c2VMYXRMbmdPcmRlcj9jK1wiIFwiK2I6YitcIiBcIitjfSxfZ2V0TnVtYmVyOmZ1bmN0aW9uKGEsYil7dmFyIGM7cmV0dXJuIGM9Yi51c2VETVM/TC5OdW1iZXJGb3JtYXR0ZXIudG9ETVMoYSk6TC5OdW1iZXJGb3JtYXR0ZXIucm91bmQoYSxiLmRlY2ltYWxzLGIuZGVjaW1hbFNlcGVyYXRvcil9LGNvbGxhcHNlOmZ1bmN0aW9uKCl7aWYoIXRoaXMuX3Nob3dzQ29vcmRpbmF0ZXMmJih0aGlzLl9tYXAub24oXCJtb3VzZW1vdmVcIix0aGlzLl91cGRhdGUsdGhpcyksdGhpcy5fc2hvd3NDb29yZGluYXRlcz0hMCx0aGlzLm9wdGlvbnMsTC5Eb21FdmVudC5hZGRMaXN0ZW5lcih0aGlzLl9jb250YWluZXIsXCJjbGlja1wiLHRoaXMuX3N3aXRjaFVJLHRoaXMpLEwuRG9tRXZlbnQucmVtb3ZlTGlzdGVuZXIodGhpcy5fY29udGFpbmVyLFwibW91c2Vtb3ZlXCIsTC5Eb21FdmVudC5zdG9wKSxMLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5faW5wdXRjb250YWluZXIsXCJ1aUhpZGRlblwiKSxMLkRvbVV0aWwucmVtb3ZlQ2xhc3ModGhpcy5fbGFiZWxjb250YWluZXIsXCJ1aUhpZGRlblwiKSx0aGlzLl9tYXJrZXIpKXt2YXIgYT1MLm1hcmtlcigpLGI9dGhpcy5fbWFya2VyLmdldExhdExuZygpO2Euc2V0TGF0TG5nKGIpO3ZhciBjPUwuRG9tVXRpbC5jcmVhdGUoXCJkaXZcIixcIlwiKSxkPUwuRG9tVXRpbC5jcmVhdGUoXCJkaXZcIixcIlwiLGMpO2QuaW5uZXJIVE1MPXRoaXMuX2NyZWF0ZUNvb3JkaW5hdGVMYWJlbChiKTt2YXIgZT1MLkRvbVV0aWwuY3JlYXRlKFwiYVwiLFwiXCIsYyk7ZS5pbm5lckhUTUw9XCJSZW1vdmVcIixlLmhyZWY9XCIjXCI7dmFyIGY9TC5Eb21FdmVudC5zdG9wUHJvcGFnYXRpb247TC5Eb21FdmVudC5vbihlLFwiY2xpY2tcIixmKS5vbihlLFwibW91c2Vkb3duXCIsZikub24oZSxcImRibGNsaWNrXCIsZikub24oZSxcImNsaWNrXCIsTC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdCkub24oZSxcImNsaWNrXCIsZnVuY3Rpb24oKXt0aGlzLl9tYXAucmVtb3ZlTGF5ZXIoYSl9LHRoaXMpLGEuYmluZFBvcHVwKGMpLGEuYWRkVG8odGhpcy5fbWFwKSx0aGlzLl9tYXAucmVtb3ZlTGF5ZXIodGhpcy5fbWFya2VyKSx0aGlzLl9tYXJrZXI9bnVsbH19LF9zd2l0Y2hVSTpmdW5jdGlvbihhKXtMLkRvbUV2ZW50LnN0b3AoYSksTC5Eb21FdmVudC5zdG9wUHJvcGFnYXRpb24oYSksTC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdChhKSx0aGlzLl9zaG93c0Nvb3JkaW5hdGVzP3RoaXMuZXhwYW5kKCk6dGhpcy5jb2xsYXBzZSgpfSxvblJlbW92ZTpmdW5jdGlvbihhKXthLm9mZihcIm1vdXNlbW92ZVwiLHRoaXMuX3VwZGF0ZSx0aGlzKX0sX3VwZGF0ZTpmdW5jdGlvbihhKXt2YXIgYj1hLmxhdGxuZyxjPXRoaXMub3B0aW9ucztiJiYoYj1iLndyYXAoKSx0aGlzLl9jdXJyZW50UG9zPWIsdGhpcy5faW5wdXRZLnZhbHVlPUwuTnVtYmVyRm9ybWF0dGVyLnJvdW5kKGIubGF0LGMuZGVjaW1hbHMsYy5kZWNpbWFsU2VwZXJhdG9yKSx0aGlzLl9pbnB1dFgudmFsdWU9TC5OdW1iZXJGb3JtYXR0ZXIucm91bmQoYi5sbmcsYy5kZWNpbWFscyxjLmRlY2ltYWxTZXBlcmF0b3IpLHRoaXMuX2xhYmVsLmlubmVySFRNTD10aGlzLl9jcmVhdGVDb29yZGluYXRlTGFiZWwoYikpfX0pLEwuY29udHJvbC5jb29yZGluYXRlcz1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IEwuQ29udHJvbC5Db29yZGluYXRlcyhhKX0sTC5NYXAubWVyZ2VPcHRpb25zKHtjb29yZGluYXRlQ29udHJvbDohMX0pLEwuTWFwLmFkZEluaXRIb29rKGZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmNvb3JkaW5hdGVDb250cm9sJiYodGhpcy5jb29yZGluYXRlQ29udHJvbD1uZXcgTC5Db250cm9sLkNvb3JkaW5hdGVzLHRoaXMuYWRkQ29udHJvbCh0aGlzLmNvb3JkaW5hdGVDb250cm9sKSl9KSxMLk51bWJlckZvcm1hdHRlcj17cm91bmQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPUwuVXRpbC5mb3JtYXROdW0oYSxiKStcIlwiLGU9ZC5zcGxpdChcIi5cIik7aWYoZVsxXSl7Zm9yKHZhciBmPWItZVsxXS5sZW5ndGg7Zj4wO2YtLSllWzFdKz1cIjBcIjtkPWUuam9pbihjfHxcIi5cIil9cmV0dXJuIGR9LHRvRE1TOmZ1bmN0aW9uKGEpe3ZhciBiPU1hdGguZmxvb3IoYSksYz02MCooYS1iKSxkPU1hdGguZmxvb3IoYyksZT02MCooYy1kKSxmPU1hdGgucm91bmQoZSk7cmV0dXJuIDYwPT1mJiYoZCsrLGY9XCIwMFwiKSw2MD09ZCYmKGIrKyxkPVwiMDBcIiksMTA+ZiYmKGY9XCIwXCIrZiksMTA+ZCYmKGQ9XCIwXCIrZCksXCJcIitiK1wiJmRlZzsgXCIrZCtcIicgXCIrZitcIicnXCJ9LGNyZWF0ZVZhbGlkTnVtYmVyOmZ1bmN0aW9uKGEsYil7aWYoYSYmYS5sZW5ndGg+MCl7dmFyIGM9YS5zcGxpdChifHxcIi5cIik7dHJ5e3ZhciBkPU51bWJlcihjLmpvaW4oXCIuXCIpKTtyZXR1cm4gaXNOYU4oZCk/dm9pZCAwOmR9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgMH19cmV0dXJuIHZvaWQgMH19OyIsIi8qXG5cdExlYWZsZXQuY29udGV4dG1lbnUsIGEgY29udGV4dCBtZW51IGZvciBMZWFmbGV0LlxuXHQoYykgMjAxNSwgQWRhbSBSYXRjbGlmZmUsIEdlb1NtYXJ0IE1hcHMgTGltaXRlZFxuXG5cdEBwcmVzZXJ2ZVxuKi9cbihmdW5jdGlvbih0KXt2YXIgZTtpZih0eXBlb2YgZGVmaW5lPT09XCJmdW5jdGlvblwiJiZkZWZpbmUuYW1kKXtkZWZpbmUoW1wibGVhZmxldFwiXSx0KX1lbHNlIGlmKHR5cGVvZiBtb2R1bGU9PT1cIm9iamVjdFwiJiZ0eXBlb2YgbW9kdWxlLmV4cG9ydHM9PT1cIm9iamVjdFwiKXtlPXJlcXVpcmUoXCJsZWFmbGV0XCIpO21vZHVsZS5leHBvcnRzPXQoZSl9ZWxzZXtpZih0eXBlb2Ygd2luZG93Lkw9PT1cInVuZGVmaW5lZFwiKXt0aHJvdyBuZXcgRXJyb3IoXCJMZWFmbGV0IG11c3QgYmUgbG9hZGVkIGZpcnN0XCIpfXQod2luZG93LkwpfX0pKGZ1bmN0aW9uKHQpe3QuTWFwLm1lcmdlT3B0aW9ucyh7Y29udGV4dG1lbnVJdGVtczpbXX0pO3QuTWFwLkNvbnRleHRNZW51PXQuSGFuZGxlci5leHRlbmQoe190b3VjaHN0YXJ0OnQuQnJvd3Nlci5tc1BvaW50ZXI/XCJNU1BvaW50ZXJEb3duXCI6dC5Ccm93c2VyLnBvaW50ZXI/XCJwb2ludGVyZG93blwiOlwidG91Y2hzdGFydFwiLHN0YXRpY3M6e0JBU0VfQ0xTOlwibGVhZmxldC1jb250ZXh0bWVudVwifSxpbml0aWFsaXplOmZ1bmN0aW9uKGUpe3QuSGFuZGxlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsZSk7dGhpcy5faXRlbXM9W107dGhpcy5fdmlzaWJsZT1mYWxzZTt2YXIgbj10aGlzLl9jb250YWluZXI9dC5Eb21VdGlsLmNyZWF0ZShcImRpdlwiLHQuTWFwLkNvbnRleHRNZW51LkJBU0VfQ0xTLGUuX2NvbnRhaW5lcik7bi5zdHlsZS56SW5kZXg9MWU0O24uc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO2lmKGUub3B0aW9ucy5jb250ZXh0bWVudVdpZHRoKXtuLnN0eWxlLndpZHRoPWUub3B0aW9ucy5jb250ZXh0bWVudVdpZHRoK1wicHhcIn10aGlzLl9jcmVhdGVJdGVtcygpO3QuRG9tRXZlbnQub24obixcImNsaWNrXCIsdC5Eb21FdmVudC5zdG9wKS5vbihuLFwibW91c2Vkb3duXCIsdC5Eb21FdmVudC5zdG9wKS5vbihuLFwiZGJsY2xpY2tcIix0LkRvbUV2ZW50LnN0b3ApLm9uKG4sXCJjb250ZXh0bWVudVwiLHQuRG9tRXZlbnQuc3RvcCl9LGFkZEhvb2tzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fbWFwLmdldENvbnRhaW5lcigpO3QuRG9tRXZlbnQub24oZSxcIm1vdXNlbGVhdmVcIix0aGlzLl9oaWRlLHRoaXMpLm9uKGRvY3VtZW50LFwia2V5ZG93blwiLHRoaXMuX29uS2V5RG93bix0aGlzKTtpZih0LkJyb3dzZXIudG91Y2gpe3QuRG9tRXZlbnQub24oZG9jdW1lbnQsdGhpcy5fdG91Y2hzdGFydCx0aGlzLl9oaWRlLHRoaXMpfXRoaXMuX21hcC5vbih7Y29udGV4dG1lbnU6dGhpcy5fc2hvdyxtb3VzZWRvd246dGhpcy5faGlkZSxtb3Zlc3RhcnQ6dGhpcy5faGlkZSx6b29tc3RhcnQ6dGhpcy5faGlkZX0sdGhpcyl9LHJlbW92ZUhvb2tzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fbWFwLmdldENvbnRhaW5lcigpO3QuRG9tRXZlbnQub2ZmKGUsXCJtb3VzZWxlYXZlXCIsdGhpcy5faGlkZSx0aGlzKS5vZmYoZG9jdW1lbnQsXCJrZXlkb3duXCIsdGhpcy5fb25LZXlEb3duLHRoaXMpO2lmKHQuQnJvd3Nlci50b3VjaCl7dC5Eb21FdmVudC5vZmYoZG9jdW1lbnQsdGhpcy5fdG91Y2hzdGFydCx0aGlzLl9oaWRlLHRoaXMpfXRoaXMuX21hcC5vZmYoe2NvbnRleHRtZW51OnRoaXMuX3Nob3csbW91c2Vkb3duOnRoaXMuX2hpZGUsbW92ZXN0YXJ0OnRoaXMuX2hpZGUsem9vbXN0YXJ0OnRoaXMuX2hpZGV9LHRoaXMpfSxzaG93QXQ6ZnVuY3Rpb24oZSxuKXtpZihlIGluc3RhbmNlb2YgdC5MYXRMbmcpe2U9dGhpcy5fbWFwLmxhdExuZ1RvQ29udGFpbmVyUG9pbnQoZSl9dGhpcy5fc2hvd0F0UG9pbnQoZSxuKX0saGlkZTpmdW5jdGlvbigpe3RoaXMuX2hpZGUoKX0sYWRkSXRlbTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5pbnNlcnRJdGVtKHQpfSxpbnNlcnRJdGVtOmZ1bmN0aW9uKHQsZSl7ZT1lIT09dW5kZWZpbmVkP2U6dGhpcy5faXRlbXMubGVuZ3RoO3ZhciBuPXRoaXMuX2NyZWF0ZUl0ZW0odGhpcy5fY29udGFpbmVyLHQsZSk7dGhpcy5faXRlbXMucHVzaChuKTt0aGlzLl9zaXplQ2hhbmdlZD10cnVlO3RoaXMuX21hcC5maXJlKFwiY29udGV4dG1lbnUuYWRkaXRlbVwiLHtjb250ZXh0bWVudTp0aGlzLGVsOm4uZWwsaW5kZXg6ZX0pO3JldHVybiBuLmVsfSxyZW1vdmVJdGVtOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMuX2NvbnRhaW5lcjtpZighaXNOYU4oZSkpe2U9bi5jaGlsZHJlbltlXX1pZihlKXt0aGlzLl9yZW1vdmVJdGVtKHQuVXRpbC5zdGFtcChlKSk7dGhpcy5fc2l6ZUNoYW5nZWQ9dHJ1ZTt0aGlzLl9tYXAuZmlyZShcImNvbnRleHRtZW51LnJlbW92ZWl0ZW1cIix7Y29udGV4dG1lbnU6dGhpcyxlbDplfSk7cmV0dXJuIGV9cmV0dXJuIG51bGx9LHJlbW92ZUFsbEl0ZW1zOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fY29udGFpbmVyLmNoaWxkcmVuLG47d2hpbGUoZS5sZW5ndGgpe249ZVswXTt0aGlzLl9yZW1vdmVJdGVtKHQuVXRpbC5zdGFtcChuKSl9cmV0dXJuIGV9LGhpZGVBbGxJdGVtczpmdW5jdGlvbigpe3ZhciB0LGUsbjtmb3IoZT0wLG49dGhpcy5faXRlbXMubGVuZ3RoO2U8bjtlKyspe3Q9dGhpcy5faXRlbXNbZV07dC5lbC5zdHlsZS5kaXNwbGF5PVwibm9uZVwifX0sc2hvd0FsbEl0ZW1zOmZ1bmN0aW9uKCl7dmFyIHQsZSxuO2ZvcihlPTAsbj10aGlzLl9pdGVtcy5sZW5ndGg7ZTxuO2UrKyl7dD10aGlzLl9pdGVtc1tlXTt0LmVsLnN0eWxlLmRpc3BsYXk9XCJcIn19LHNldERpc2FibGVkOmZ1bmN0aW9uKGUsbil7dmFyIGk9dGhpcy5fY29udGFpbmVyLG89dC5NYXAuQ29udGV4dE1lbnUuQkFTRV9DTFMrXCItaXRlbVwiO2lmKCFpc05hTihlKSl7ZT1pLmNoaWxkcmVuW2VdfWlmKGUmJnQuRG9tVXRpbC5oYXNDbGFzcyhlLG8pKXtpZihuKXt0LkRvbVV0aWwuYWRkQ2xhc3MoZSxvK1wiLWRpc2FibGVkXCIpO3RoaXMuX21hcC5maXJlKFwiY29udGV4dG1lbnUuZGlzYWJsZWl0ZW1cIix7Y29udGV4dG1lbnU6dGhpcyxlbDplfSl9ZWxzZXt0LkRvbVV0aWwucmVtb3ZlQ2xhc3MoZSxvK1wiLWRpc2FibGVkXCIpO3RoaXMuX21hcC5maXJlKFwiY29udGV4dG1lbnUuZW5hYmxlaXRlbVwiLHtjb250ZXh0bWVudTp0aGlzLGVsOmV9KX19fSxpc1Zpc2libGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdmlzaWJsZX0sX2NyZWF0ZUl0ZW1zOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fbWFwLm9wdGlvbnMuY29udGV4dG1lbnVJdGVtcyxlLG4saTtmb3Iobj0wLGk9dC5sZW5ndGg7bjxpO24rKyl7dGhpcy5faXRlbXMucHVzaCh0aGlzLl9jcmVhdGVJdGVtKHRoaXMuX2NvbnRhaW5lcix0W25dKSl9fSxfY3JlYXRlSXRlbTpmdW5jdGlvbihlLG4saSl7aWYobi5zZXBhcmF0b3J8fG49PT1cIi1cIil7cmV0dXJuIHRoaXMuX2NyZWF0ZVNlcGFyYXRvcihlLGkpfXZhciBvPXQuTWFwLkNvbnRleHRNZW51LkJBU0VfQ0xTK1wiLWl0ZW1cIixzPW4uZGlzYWJsZWQ/bytcIiBcIitvK1wiLWRpc2FibGVkXCI6byxoPXRoaXMuX2luc2VydEVsZW1lbnRBdChcImFcIixzLGUsaSkscj10aGlzLl9jcmVhdGVFdmVudEhhbmRsZXIoaCxuLmNhbGxiYWNrLG4uY29udGV4dCxuLmhpZGVPblNlbGVjdCksYT10aGlzLl9nZXRJY29uKG4pLG09dGhpcy5fZ2V0SWNvbkNscyhuKSx1PVwiXCI7aWYoYSl7dT0nPGltZyBjbGFzcz1cIicrdC5NYXAuQ29udGV4dE1lbnUuQkFTRV9DTFMrJy1pY29uXCIgc3JjPVwiJythKydcIi8+J31lbHNlIGlmKG0pe3U9JzxzcGFuIGNsYXNzPVwiJyt0Lk1hcC5Db250ZXh0TWVudS5CQVNFX0NMUytcIi1pY29uIFwiK20rJ1wiPjwvc3Bhbj4nfWguaW5uZXJIVE1MPXUrbi50ZXh0O2guaHJlZj1cIiNcIjt0LkRvbUV2ZW50Lm9uKGgsXCJtb3VzZW92ZXJcIix0aGlzLl9vbkl0ZW1Nb3VzZU92ZXIsdGhpcykub24oaCxcIm1vdXNlb3V0XCIsdGhpcy5fb25JdGVtTW91c2VPdXQsdGhpcykub24oaCxcIm1vdXNlZG93blwiLHQuRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKS5vbihoLFwiY2xpY2tcIixyKTtpZih0LkJyb3dzZXIudG91Y2gpe3QuRG9tRXZlbnQub24oaCx0aGlzLl90b3VjaHN0YXJ0LHQuRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKX1pZighdC5Ccm93c2VyLnBvaW50ZXIpe3QuRG9tRXZlbnQub24oaCxcImNsaWNrXCIsdGhpcy5fb25JdGVtTW91c2VPdXQsdGhpcyl9cmV0dXJue2lkOnQuVXRpbC5zdGFtcChoKSxlbDpoLGNhbGxiYWNrOnJ9fSxfcmVtb3ZlSXRlbTpmdW5jdGlvbihlKXt2YXIgbixpLG8scyxoO2ZvcihvPTAscz10aGlzLl9pdGVtcy5sZW5ndGg7bzxzO28rKyl7bj10aGlzLl9pdGVtc1tvXTtpZihuLmlkPT09ZSl7aT1uLmVsO2g9bi5jYWxsYmFjaztpZihoKXt0LkRvbUV2ZW50Lm9mZihpLFwibW91c2VvdmVyXCIsdGhpcy5fb25JdGVtTW91c2VPdmVyLHRoaXMpLm9mZihpLFwibW91c2VvdmVyXCIsdGhpcy5fb25JdGVtTW91c2VPdXQsdGhpcykub2ZmKGksXCJtb3VzZWRvd25cIix0LkRvbUV2ZW50LnN0b3BQcm9wYWdhdGlvbikub2ZmKGksXCJjbGlja1wiLGgpO2lmKHQuQnJvd3Nlci50b3VjaCl7dC5Eb21FdmVudC5vZmYoaSx0aGlzLl90b3VjaHN0YXJ0LHQuRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKX1pZighdC5Ccm93c2VyLnBvaW50ZXIpe3QuRG9tRXZlbnQub24oaSxcImNsaWNrXCIsdGhpcy5fb25JdGVtTW91c2VPdXQsdGhpcyl9fXRoaXMuX2NvbnRhaW5lci5yZW1vdmVDaGlsZChpKTt0aGlzLl9pdGVtcy5zcGxpY2UobywxKTtyZXR1cm4gbn19cmV0dXJuIG51bGx9LF9jcmVhdGVTZXBhcmF0b3I6ZnVuY3Rpb24oZSxuKXt2YXIgaT10aGlzLl9pbnNlcnRFbGVtZW50QXQoXCJkaXZcIix0Lk1hcC5Db250ZXh0TWVudS5CQVNFX0NMUytcIi1zZXBhcmF0b3JcIixlLG4pO3JldHVybntpZDp0LlV0aWwuc3RhbXAoaSksZWw6aX19LF9jcmVhdGVFdmVudEhhbmRsZXI6ZnVuY3Rpb24oZSxuLGksbyl7dmFyIHM9dGhpcyxoPXRoaXMuX21hcCxyPXQuTWFwLkNvbnRleHRNZW51LkJBU0VfQ0xTK1wiLWl0ZW0tZGlzYWJsZWRcIixvPW8hPT11bmRlZmluZWQ/bzp0cnVlO3JldHVybiBmdW5jdGlvbihhKXtpZih0LkRvbVV0aWwuaGFzQ2xhc3MoZSxyKSl7cmV0dXJufWlmKG8pe3MuX2hpZGUoKX1pZihuKXtuLmNhbGwoaXx8aCxzLl9zaG93TG9jYXRpb24pfXMuX21hcC5maXJlKFwiY29udGV4dG1lbnUuc2VsZWN0XCIse2NvbnRleHRtZW51OnMsZWw6ZX0pfX0sX2luc2VydEVsZW1lbnRBdDpmdW5jdGlvbih0LGUsbixpKXt2YXIgbyxzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCk7cy5jbGFzc05hbWU9ZTtpZihpIT09dW5kZWZpbmVkKXtvPW4uY2hpbGRyZW5baV19aWYobyl7bi5pbnNlcnRCZWZvcmUocyxvKX1lbHNle24uYXBwZW5kQ2hpbGQocyl9cmV0dXJuIHN9LF9zaG93OmZ1bmN0aW9uKHQpe3RoaXMuX3Nob3dBdFBvaW50KHQuY29udGFpbmVyUG9pbnQsdCl9LF9zaG93QXRQb2ludDpmdW5jdGlvbihlLG4pe2lmKHRoaXMuX2l0ZW1zLmxlbmd0aCl7dmFyIGk9dGhpcy5fbWFwLG89aS5jb250YWluZXJQb2ludFRvTGF5ZXJQb2ludChlKSxzPWkubGF5ZXJQb2ludFRvTGF0TG5nKG8pLGg9dC5leHRlbmQobnx8e30se2NvbnRleHRtZW51OnRoaXN9KTt0aGlzLl9zaG93TG9jYXRpb249e2xhdGxuZzpzLGxheWVyUG9pbnQ6byxjb250YWluZXJQb2ludDplfTtpZihuJiZuLnJlbGF0ZWRUYXJnZXQpe3RoaXMuX3Nob3dMb2NhdGlvbi5yZWxhdGVkVGFyZ2V0PW4ucmVsYXRlZFRhcmdldH10aGlzLl9zZXRQb3NpdGlvbihlKTtpZighdGhpcy5fdmlzaWJsZSl7dGhpcy5fY29udGFpbmVyLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiO3RoaXMuX3Zpc2libGU9dHJ1ZX10aGlzLl9tYXAuZmlyZShcImNvbnRleHRtZW51LnNob3dcIixoKX19LF9oaWRlOmZ1bmN0aW9uKCl7aWYodGhpcy5fdmlzaWJsZSl7dGhpcy5fdmlzaWJsZT1mYWxzZTt0aGlzLl9jb250YWluZXIuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjt0aGlzLl9tYXAuZmlyZShcImNvbnRleHRtZW51LmhpZGVcIix7Y29udGV4dG1lbnU6dGhpc30pfX0sX2dldEljb246ZnVuY3Rpb24oZSl7cmV0dXJuIHQuQnJvd3Nlci5yZXRpbmEmJmUucmV0aW5hSWNvbnx8ZS5pY29ufSxfZ2V0SWNvbkNsczpmdW5jdGlvbihlKXtyZXR1cm4gdC5Ccm93c2VyLnJldGluYSYmZS5yZXRpbmFJY29uQ2xzfHxlLmljb25DbHN9LF9zZXRQb3NpdGlvbjpmdW5jdGlvbihlKXt2YXIgbj10aGlzLl9tYXAuZ2V0U2l6ZSgpLGk9dGhpcy5fY29udGFpbmVyLG89dGhpcy5fZ2V0RWxlbWVudFNpemUoaSkscztpZih0aGlzLl9tYXAub3B0aW9ucy5jb250ZXh0bWVudUFuY2hvcil7cz10LnBvaW50KHRoaXMuX21hcC5vcHRpb25zLmNvbnRleHRtZW51QW5jaG9yKTtlPWUuYWRkKHMpfWkuX2xlYWZsZXRfcG9zPWU7aWYoZS54K28ueD5uLngpe2kuc3R5bGUubGVmdD1cImF1dG9cIjtpLnN0eWxlLnJpZ2h0PU1hdGgubWluKE1hdGgubWF4KG4ueC1lLngsMCksbi54LW8ueC0xKStcInB4XCJ9ZWxzZXtpLnN0eWxlLmxlZnQ9TWF0aC5tYXgoZS54LDApK1wicHhcIjtpLnN0eWxlLnJpZ2h0PVwiYXV0b1wifWlmKGUueStvLnk+bi55KXtpLnN0eWxlLnRvcD1cImF1dG9cIjtpLnN0eWxlLmJvdHRvbT1NYXRoLm1pbihNYXRoLm1heChuLnktZS55LDApLG4ueS1vLnktMSkrXCJweFwifWVsc2V7aS5zdHlsZS50b3A9TWF0aC5tYXgoZS55LDApK1wicHhcIjtpLnN0eWxlLmJvdHRvbT1cImF1dG9cIn19LF9nZXRFbGVtZW50U2l6ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9zaXplLG49dC5zdHlsZS5kaXNwbGF5O2lmKCFlfHx0aGlzLl9zaXplQ2hhbmdlZCl7ZT17fTt0LnN0eWxlLmxlZnQ9XCItOTk5OTk5cHhcIjt0LnN0eWxlLnJpZ2h0PVwiYXV0b1wiO3Quc3R5bGUuZGlzcGxheT1cImJsb2NrXCI7ZS54PXQub2Zmc2V0V2lkdGg7ZS55PXQub2Zmc2V0SGVpZ2h0O3Quc3R5bGUubGVmdD1cImF1dG9cIjt0LnN0eWxlLmRpc3BsYXk9bjt0aGlzLl9zaXplQ2hhbmdlZD1mYWxzZX1yZXR1cm4gZX0sX29uS2V5RG93bjpmdW5jdGlvbih0KXt2YXIgZT10LmtleUNvZGU7aWYoZT09PTI3KXt0aGlzLl9oaWRlKCl9fSxfb25JdGVtTW91c2VPdmVyOmZ1bmN0aW9uKGUpe3QuRG9tVXRpbC5hZGRDbGFzcyhlLnRhcmdldHx8ZS5zcmNFbGVtZW50LFwib3ZlclwiKX0sX29uSXRlbU1vdXNlT3V0OmZ1bmN0aW9uKGUpe3QuRG9tVXRpbC5yZW1vdmVDbGFzcyhlLnRhcmdldHx8ZS5zcmNFbGVtZW50LFwib3ZlclwiKX19KTt0Lk1hcC5hZGRJbml0SG9vayhcImFkZEhhbmRsZXJcIixcImNvbnRleHRtZW51XCIsdC5NYXAuQ29udGV4dE1lbnUpO3QuTWl4aW4uQ29udGV4dE1lbnU9e2JpbmRDb250ZXh0TWVudTpmdW5jdGlvbihlKXt0LnNldE9wdGlvbnModGhpcyxlKTt0aGlzLl9pbml0Q29udGV4dE1lbnUoKTtyZXR1cm4gdGhpc30sdW5iaW5kQ29udGV4dE1lbnU6ZnVuY3Rpb24oKXt0aGlzLm9mZihcImNvbnRleHRtZW51XCIsdGhpcy5fc2hvd0NvbnRleHRNZW51LHRoaXMpO3JldHVybiB0aGlzfSxhZGRDb250ZXh0TWVudUl0ZW06ZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zLmNvbnRleHRtZW51SXRlbXMucHVzaCh0KX0scmVtb3ZlQ29udGV4dE1lbnVJdGVtV2l0aEluZGV4OmZ1bmN0aW9uKHQpe3ZhciBlPVtdO2Zvcih2YXIgbj0wO248dGhpcy5vcHRpb25zLmNvbnRleHRtZW51SXRlbXMubGVuZ3RoO24rKyl7aWYodGhpcy5vcHRpb25zLmNvbnRleHRtZW51SXRlbXNbbl0uaW5kZXg9PXQpe2UucHVzaChuKX19dmFyIGk9ZS5wb3AoKTt3aGlsZShpIT09dW5kZWZpbmVkKXt0aGlzLm9wdGlvbnMuY29udGV4dG1lbnVJdGVtcy5zcGxpY2UoaSwxKTtpPWUucG9wKCl9fSxyZXBsYWNlQ29udGV4dE1lbnVJdGVtOmZ1bmN0aW9uKHQpe3RoaXMucmVtb3ZlQ29udGV4dE1lbnVJdGVtV2l0aEluZGV4KHQuaW5kZXgpO3RoaXMuYWRkQ29udGV4dE1lbnVJdGVtKHQpfSxfaW5pdENvbnRleHRNZW51OmZ1bmN0aW9uKCl7dGhpcy5faXRlbXM9W107dGhpcy5vbihcImNvbnRleHRtZW51XCIsdGhpcy5fc2hvd0NvbnRleHRNZW51LHRoaXMpfSxfc2hvd0NvbnRleHRNZW51OmZ1bmN0aW9uKGUpe3ZhciBuLGksbyxzLGg7aWYodGhpcy5fbWFwLmNvbnRleHRtZW51KXtpPXQuZXh0ZW5kKHtyZWxhdGVkVGFyZ2V0OnRoaXN9LGUpO289dGhpcy5fbWFwLm1vdXNlRXZlbnRUb0NvbnRhaW5lclBvaW50KGUub3JpZ2luYWxFdmVudCk7aWYoIXRoaXMub3B0aW9ucy5jb250ZXh0bWVudUluaGVyaXRJdGVtcyl7dGhpcy5fbWFwLmNvbnRleHRtZW51LmhpZGVBbGxJdGVtcygpfWZvcihzPTAsaD10aGlzLm9wdGlvbnMuY29udGV4dG1lbnVJdGVtcy5sZW5ndGg7czxoO3MrKyl7bj10aGlzLm9wdGlvbnMuY29udGV4dG1lbnVJdGVtc1tzXTt0aGlzLl9pdGVtcy5wdXNoKHRoaXMuX21hcC5jb250ZXh0bWVudS5pbnNlcnRJdGVtKG4sbi5pbmRleCkpfXRoaXMuX21hcC5vbmNlKFwiY29udGV4dG1lbnUuaGlkZVwiLHRoaXMuX2hpZGVDb250ZXh0TWVudSx0aGlzKTt0aGlzLl9tYXAuY29udGV4dG1lbnUuc2hvd0F0KG8saSl9fSxfaGlkZUNvbnRleHRNZW51OmZ1bmN0aW9uKCl7dmFyIHQsZTtmb3IodD0wLGU9dGhpcy5faXRlbXMubGVuZ3RoO3Q8ZTt0Kyspe3RoaXMuX21hcC5jb250ZXh0bWVudS5yZW1vdmVJdGVtKHRoaXMuX2l0ZW1zW3RdKX10aGlzLl9pdGVtcy5sZW5ndGg9MDtpZighdGhpcy5vcHRpb25zLmNvbnRleHRtZW51SW5oZXJpdEl0ZW1zKXt0aGlzLl9tYXAuY29udGV4dG1lbnUuc2hvd0FsbEl0ZW1zKCl9fX07dmFyIGU9W3QuTWFya2VyLHQuUGF0aF0sbj17Y29udGV4dG1lbnU6ZmFsc2UsY29udGV4dG1lbnVJdGVtczpbXSxjb250ZXh0bWVudUluaGVyaXRJdGVtczp0cnVlfSxpLG8scztmb3Iobz0wLHM9ZS5sZW5ndGg7bzxzO28rKyl7aT1lW29dO2lmKCFpLnByb3RvdHlwZS5vcHRpb25zKXtpLnByb3RvdHlwZS5vcHRpb25zPW59ZWxzZXtpLm1lcmdlT3B0aW9ucyhuKX1pLmFkZEluaXRIb29rKGZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmNvbnRleHRtZW51KXt0aGlzLl9pbml0Q29udGV4dE1lbnUoKX19KTtpLmluY2x1ZGUodC5NaXhpbi5Db250ZXh0TWVudSl9cmV0dXJuIHQuTWFwLkNvbnRleHRNZW51fSk7IiwiJCQubW9kdWxlLnJlZ2lzdGVyTW9kdWxlKCdicmFpbmpzLm1hcC5pY29uLmFpcycsIGZ1bmN0aW9uKCkge1xuXG5cdHJldHVybiBmdW5jdGlvbihkYXRhKSB7XG5cblx0XHR2YXIgY29sb3IgPSBkYXRhLmNvbG9yIHx8ICdncmVlbidcblxuXHRcdHZhciB0ZW1wbGF0ZSA9ICBgXG5cdFx0XHQ8c3ZnIHdpZHRoPVwiNDBcIiBoZWlnaHQ9XCI0MFwiIHN0eWxlPVwiYm9yZGVyOiAxcHggc29saWQgYmFjaztcIj5cblx0XHRcdFx0PGcgdHJhbnNmb3JtPVwidHJhbnNsYXRlKDIwLCAyMClcIiBzdHJva2U9XCIke2NvbG9yfVwiIGZpbGw9XCIke2NvbG9yfVwiPlxuXHRcdFx0XHRcdDxjaXJjbGUgcj1cIjNcIj48L2NpcmNsZT5cblx0XHRcdFx0XHQ8cmVjdCB4PVwiLTdcIiB5PVwiLTdcIiB3aWR0aD1cIjE1XCIgaGVpZ2h0PVwiMTVcIiBmaWxsPSR7Y29sb3J9IGZpbGwtb3BhY2l0eT1cIjAuM1wiPjwvcmVjdD5cblx0XHRcdFx0XHQ8bGluZSB5Mj1cIi0zMFwiPjwvbGluZT5cblx0XHRcdFx0PC9nPlxuXHRcdFx0PC9zdmc+XG5cdFx0YFxuXG5cdFx0cmV0dXJuIEwuZGl2SWNvbih7XG5cdFx0XHRjbGFzc05hbWU6ICdhaXNNYXJrZXInLFxuXHRcdFx0aWNvblNpemU6IFs0MCwgNDBdLFxuXHRcdFx0aWNvbkFuY2hvcjogWzIwLCAyMF0sXG5cdFx0XHRodG1sOiB0ZW1wbGF0ZVxuXHRcdH0pXHRcdFxuXHR9XG59KTtcbiIsIiQkLm1vZHVsZS5yZWdpc3Rlck1vZHVsZSgnYnJhaW5qcy5tYXAuc2hhcGUuY2lyY2xlJywgZnVuY3Rpb24oKSB7XG5cblx0cmV0dXJuIHtcblx0XHRcblx0XHRjcmVhdGU6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdHJldHVybiBMLmNpcmNsZShkYXRhLmxhdGxuZywgZGF0YS5yYWRpdXMsIGRhdGEuc3R5bGUpXG5cdFx0fSxcblx0XHR1cGRhdGU6IGZ1bmN0aW9uKGxheWVyLCBkYXRhKSB7XG5cdFx0XG5cdFx0XHRpZiAoZGF0YS5sYXRsbmcpIHtcblx0XHRcdFx0bGF5ZXIuc2V0TGF0TG5nKGRhdGEubGF0bG5nKVxuXHRcdFx0fVx0XG5cdFx0XHRcblx0XHRcdGlmIChkYXRhLnJhZGl1cykge1xuXHRcdFx0XHRsYXllci5zZXRSYWRpdXMoZGF0YS5yYWRpdXMpXG5cdFx0XHR9XG5cdFx0XHRpZiAoZGF0YS5zdHlsZSkge1xuXHRcdFx0XHRsYXllci5zZXRTdHlsZShkYXRhLnN0eWxlKVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0fSxcblx0XHRnZXREYXRhOiBmdW5jdGlvbihsYXllciwgZGF0YSkge1xuXHRcdFx0ZGF0YS5yYWRpdXMgPSBsYXllci5nZXRSYWRpdXMoKVxuXHRcdFx0ZGF0YS5sYXRsbmcgPSBsYXllci5nZXRMYXRMbmcoKVx0XG5cdFx0fVx0XHRcblxuXHR9XG59KTtcblxuIiwiKGZ1bmN0aW9uKCkge1xuXG5cblxuZnVuY3Rpb24gZ2V0SWNvbk1hcmtlcihkYXRhKSB7XG5cdGlmICh0eXBlb2YgZGF0YS50eXBlICE9ICdzdHJpbmcnKSB7XG5cdFx0Y29uc29sZS5lcnJvcignW2JyYWluanMubWFwXSBnZXRJY29uTWFya2VyLCBtaXNzaW5nIHR5cGUgZmllbGQnKVxuXHRcdHJldHVyblxuXHR9XG5cdGNvbnN0IGZ1bmMgPSAkJC5tb2R1bGUuZ2V0TW9kdWxlKCdicmFpbmpzLm1hcC5pY29uLicgKyBkYXRhLnR5cGUpXG5cblx0aWYgKHR5cGVvZiBmdW5jID09ICdmdW5jdGlvbicpIHtcblx0XHRyZXR1cm4gZnVuYyhkYXRhKVxuXHR9XG59XG5cbiQkLm1vZHVsZS5yZWdpc3Rlck1vZHVsZSgnYnJhaW5qcy5tYXAuc2hhcGUubWFya2VyJywgZnVuY3Rpb24oKSB7XG5cblx0cmV0dXJuIHtcblx0XHRcblx0XHRjcmVhdGU6IGZ1bmN0aW9uKGRhdGEpIHtcblxuXHRcdFx0Y29uc3Qgb3B0aW9ucyA9IGRhdGEub3B0aW9ucyB8fCB7fVxuXHRcdFx0aWYgKGRhdGEuaWNvbikge1xuXHRcdFx0XHRvcHRpb25zLmljb24gPSBnZXRJY29uTWFya2VyKGRhdGEuaWNvbilcblx0XHRcdH1cblx0XHRcdGlmIChkYXRhLnJvdGF0aW9uQW5nbGUpIHtcblx0XHRcdFx0b3B0aW9ucy5yb3RhdGlvbkFuZ2xlID0gZGF0YS5yb3RhdGlvbkFuZ2xlXG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IG1hcmtlciA9IEwubWFya2VyKGRhdGEubGF0bG5nLCBvcHRpb25zKVx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcblx0XHRcdGlmIChkYXRhLnBvcHVwQ29udGVudCkge1xuXHRcdFx0XHRsZXQgcG9wdXAgPSBMLnBvcHVwKHthdXRvQ2xvc2U6IGZhbHNlLCBjbG9zZUJ1dHRvbjogdHJ1ZSwgYXV0b1BhbjogZmFsc2V9KVxuXHRcdFx0XHRwb3B1cC5zZXRDb250ZW50KGRhdGEucG9wdXBDb250ZW50KVxuXHRcdFx0XHRtYXJrZXIuYmluZFBvcHVwKHBvcHVwKVxuXHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdHJldHVybiBtYXJrZXJcblx0XHR9LFxuXG5cdFx0dXBkYXRlOiBmdW5jdGlvbihsYXllciwgZGF0YSkge1xuXHRcdFxuXG5cdFx0XHRpZiAoZGF0YS5sYXRsbmcpIHtcblx0XHRcdFx0bGF5ZXIuc2V0TGF0TG5nKGRhdGEubGF0bG5nKVxuXHRcdFx0fVxuXHRcdFx0aWYgKGRhdGEuaWNvbikge1xuXHRcdFx0XHRsYXllci5zZXRJY29uKGdldEljb25NYXJrZXIoZGF0YS5pY29uKSlcblx0XHRcdH1cblx0XHRcdGlmIChkYXRhLnJvdGF0aW9uQW5nbGUpIHtcblx0XHRcdFx0bGF5ZXIuc2V0Um90YXRpb25BbmdsZShkYXRhLnJvdGF0aW9uQW5nbGUpXG5cdFx0XHR9XHRcblxuXHRcdFx0aWYgKGRhdGEucG9wdXBDb250ZW50KSB7XG5cdFx0XHRcdGxheWVyLnNldFBvcHVwQ29udGVudChkYXRhLnBvcHVwQ29udGVudClcblx0XHRcdH1cdFxuXG5cdFx0fSxcblx0XHRnZXREYXRhOiBmdW5jdGlvbihsYXllciwgZGF0YSkge1xuXHRcdFx0ZGF0YS5sYXRsbmcgPSBsYXllci5nZXRMYXRMbmcoKVxuXHRcdH1cblx0fVxufSlcblxufSkoKTsiLCIkJC5tb2R1bGUucmVnaXN0ZXJNb2R1bGUoJ2JyYWluanMubWFwLnNoYXBlLnBvbHlnb24nLCBmdW5jdGlvbigpIHtcblxuXHRyZXR1cm4ge1xuXHRcdFxuXHRcdGNyZWF0ZTogZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0cmV0dXJuIEwucG9seWdvbihkYXRhLmxhdGxuZ3MsIGRhdGEuc3R5bGUpXG5cdFx0fSxcblx0XHR1cGRhdGU6IGZ1bmN0aW9uKGxheWVyLCBkYXRhKSB7XG5cdFx0XG5cdFx0XHRpZiAoZGF0YS5sYXRsbmdzKSB7XG5cdFx0XHRcdGxheWVyLnNldExhdExuZ3MoZGF0YS5sYXRsbmdzKVxuXHRcdFx0fVxuXHRcdFx0aWYgKGRhdGEuc3R5bGUpIHtcblx0XHRcdFx0bGF5ZXIuc2V0U3R5bGUoZGF0YS5zdHlsZSlcblx0XHRcdH1cblx0XHRcdFxuXHRcdH0sXG5cdFx0Z2V0RGF0YTogZnVuY3Rpb24obGF5ZXIsIGRhdGEpIHtcblx0XHRcdGRhdGEubGF0bG5ncyA9IGxheWVyLmdldExhdExuZ3MoKVswXVxuXHRcdH1cdFx0XG5cblx0fVxufSk7XG5cbiIsIiQkLm1vZHVsZS5yZWdpc3Rlck1vZHVsZSgnYnJhaW5qcy5tYXAuc2hhcGUucG9seWxpbmUnLCBmdW5jdGlvbigpIHtcblxuXHRyZXR1cm4ge1xuXHRcdFxuXHRcdGNyZWF0ZTogZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0cmV0dXJuIEwucG9seWxpbmUoZGF0YS5sYXRsbmdzLCBkYXRhLnN0eWxlKVxuXHRcdH0sXG5cdFx0dXBkYXRlOiBmdW5jdGlvbihsYXllciwgZGF0YSkge1xuXHRcdFxuXHRcdFx0aWYgKGRhdGEubGF0bG5ncykge1xuXHRcdFx0XHRsYXllci5zZXRMYXRMbmdzKGRhdGEubGF0bG5ncylcblx0XHRcdH1cblx0XHRcdGlmIChkYXRhLnN0eWxlKSB7XG5cdFx0XHRcdGxheWVyLnNldFN0eWxlKGRhdGEuc3R5bGUpXG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9LFxuXHRcdGdldERhdGE6IGZ1bmN0aW9uKGxheWVyLCBkYXRhKSB7XG5cdFx0XHRkYXRhLmxhdGxuZ3MgPSBsYXllci5nZXRMYXRMbmdzKClcblx0XHR9XHRcblx0fVxufSk7XG5cbiIsIiQkLm1vZHVsZS5yZWdpc3Rlck1vZHVsZSgnYnJhaW5qcy5tYXAuc2hhcGUucmVjdGFuZ2xlJywgZnVuY3Rpb24oKSB7XG5cblx0cmV0dXJuIHtcblx0XHRcblx0XHRjcmVhdGU6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcblx0XHRcdGNvbnN0IGJvdW5kcyA9IEwubGF0TG5nQm91bmRzKGRhdGEubm9ydGhXZXN0LCBkYXRhLnNvdXRoRWFzdClcblx0XHRcdHJldHVybiBMLnJlY3RhbmdsZShib3VuZHMsIGRhdGEuc3R5bGUpXG5cdFx0fSxcblxuXHRcdHVwZGF0ZTogZnVuY3Rpb24obGF5ZXIsIGRhdGEpIHtcblx0XHRcdFxuXHRcdFx0aWYgKGRhdGEubm9ydGhXZXN0ICYmIGRhdGEuc291dGhFYXN0KSB7XG5cdFx0XHRcdGNvbnN0IGJvdW5kcyA9IEwubGF0TG5nQm91bmRzKGRhdGEubm9ydGhXZXN0LCBkYXRhLnNvdXRoRWFzdClcblx0XHRcdFx0bGF5ZXIuc2V0Qm91bmRzKGJvdW5kcylcblx0XHRcdH1cblx0XHRcdGlmIChkYXRhLnN0eWxlKSB7XG5cdFx0XHRcdGxheWVyLnNldFN0eWxlKGRhdGEuc3R5bGUpXG5cdFx0XHR9XG5cdFx0fSxcblx0XHRnZXREYXRhOiBmdW5jdGlvbihsYXllciwgZGF0YSkge1xuXHRcdFx0Y29uc3QgYm91bmRzID0gbGF5ZXIuZ2V0Qm91bmRzKClcblx0XHRcdGRhdGEubm9ydGhXZXN0ID0gIGJvdW5kcy5nZXROb3J0aFdlc3QoKVxuXHRcdFx0ZGF0YS5zb3V0aEVhc3QgPSAgYm91bmRzLmdldFNvdXRoRWFzdCgpXG5cdFx0fVxuXHR9XG59KTtcblxuIiwiJChmdW5jdGlvbigpIHtcblx0Y29uc29sZS5sb2coJ1ticmFpbmpzLm1hcF0gTGVhZmxldCB2ZXJzaW9uJywgTC52ZXJzaW9uKVxuXHQkJC51dGlsLmxvYWRTdHlsZSgnbWFwL2JyYWluanMtbWFwLmNzcycpXG59KVxuXG5cblxuJCQuY29udHJvbC5yZWdpc3RlckNvbnRyb2woJ2JyYWluanMubWFwJywge1xuXHRwcm9wczoge1xuXHRcdHRpbGVVcmw6ICdodHRwczovL3tzfS50aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZycsXG5cdFx0Y2VudGVyOiB7bGF0OiA1MS41MDUsIGxuZzogLTAuMDl9LCAvLyBsb25kb24gY2l0eVxuXHRcdHpvb206IDEzLFxuXHRcdGxheWVyczoge30sXG5cdFx0c2NhbGU6IGZhbHNlLFxuXHRcdGNvb3JkaW5hdGVzOiBmYWxzZSxcblx0XHRwbHVnaW5zOiB7fSxcblx0XHRjb250ZXh0TWVudToge30sXG5cdFx0c2hhcGVzOiB7fVxuXHR9LFxuXHRpbml0OiBmdW5jdGlvbihlbHQpIHtcblxuXHRcdGNvbnN0IGRpdiA9ICQoJzxkaXY+JykuY3NzKCdoZWlnaHQnLCAnMTAwJScpLmFwcGVuZFRvKGVsdCkuZ2V0KDApXG5cblx0XHRjb25zdCB7Y2VudGVyLCB6b29tLCB0aWxlVXJsLCBjb250ZXh0TWVudX0gPSB0aGlzLnByb3BzXG5cblx0XHRjb25zdCBtYXBPcHRpb25zID0ge1xuXHRcdFx0Y2VudGVyLCBcblx0XHRcdHpvb20sXG5cdFx0XHRjbG9zZVBvcHVwT25DbGljazogZmFsc2UsXG5cdFx0XHRjb250ZXh0bWVudTogdHJ1ZSxcblx0XHRcdGNvbnRleHRtZW51V2lkdGg6IDE0MFxuXHRcdH1cblxuXHRcdG1hcE9wdGlvbnMuY29udGV4dG1lbnVJdGVtcyA9IE9iamVjdC5rZXlzKGNvbnRleHRNZW51KS5tYXAoZnVuY3Rpb24oY21kKSB7XG5cdFx0XHRjb25zdCB0ZXh0ID0gY29udGV4dE1lbnVbY21kXS5uYW1lXG5cdFx0XHRpZiAodGV4dCA9PT0gJy0tJykge1xuXHRcdFx0XHRyZXR1cm4ge3NlcGFyYXRvcjogdHJ1ZX1cblx0XHRcdH1cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHRleHQsXG5cdFx0XHRcdGNhbGxiYWNrOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdGVsdC50cmlnZ2VyKCdtYXBjb250ZXh0bWVudScsIHtjbWQsICBsYXRsbmc6IGV2LmxhdGxuZ30pXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdH0pXG5cblx0XHRjb25zdCBtYXAgPSBMLm1hcChkaXYsIG1hcE9wdGlvbnMpXG5cdFx0Y29uc3Qgc2hhcGVzID0ge31cblx0XHRjb25zdCBsYXllcnMgPSB7fVxuXG5cdFx0Y29uc3QgY29uZkxheWVyID0ge31cblxuXHRcdGZvcihsZXQgbGF5ZXJOYW1lIGluIHRoaXMucHJvcHMubGF5ZXJzKSB7XG5cdFx0XHRjb25zdCB7bGFiZWwsIHZpc2libGV9ID0gdGhpcy5wcm9wcy5sYXllcnNbbGF5ZXJOYW1lXVxuXHRcdFx0Y29uc3QgbGF5ZXIgPSBuZXcgTC5GZWF0dXJlR3JvdXAoKVxuXHRcdFx0bGF5ZXJzW2xheWVyTmFtZV0gPSBsYXllclxuXHRcdFx0aWYgKHR5cGVvZiBsYWJlbCA9PSAnc3RyaW5nJykge1xuXHRcdFx0XHRjb25mTGF5ZXJbbGFiZWxdID0gbGF5ZXJcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKHZpc2libGUgPT09IHRydWUpIHtcblx0XHRcdFx0bWFwLmFkZExheWVyKGxheWVyKVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChPYmplY3Qua2V5cyhjb25mTGF5ZXIpLmxlbmd0aCAhPSAwKSB7XG5cdFx0XHRMLmNvbnRyb2wubGF5ZXJzKHt9LCBjb25mTGF5ZXIpLmFkZFRvKG1hcClcblx0XHR9XHRcblxuXHRcdGlmICh0aGlzLnByb3BzLnNjYWxlKSB7XHRcdFx0XG5cdFx0XHRMLmNvbnRyb2wuc2NhbGUoe2ltcGVyaWFsOiBmYWxzZSwgcG9zaXRpb246ICdib3R0b21yaWdodCd9KS5hZGRUbyhtYXApXG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMucHJvcHMuY29vcmRpbmF0ZXMpIHtcblx0XHRcdEwuY29udHJvbC5jb29yZGluYXRlcyh7XG5cdFx0XHRcdHBvc2l0aW9uOiAnYm90dG9tbGVmdCcsXG5cdFx0XHRcdHVzZUxhdExuZ09yZGVyOiB0cnVlLFxuXHRcdFx0XHRlbmFibGVVc2VySW5wdXQ6IGZhbHNlLFxuXHRcdFx0XHRkZWNpbWFsczogNVx0XHRcdFx0XHRcblx0XHRcdH0pLmFkZFRvKG1hcClcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0ge2VsdCwgbWFwLCBsYXllcnMsIHNoYXBlc31cblxuXHRcdGZvcihsZXQgcGx1Z2luTmFtZSBpbiB0aGlzLnByb3BzLnBsdWdpbnMpIHtcblx0XHRcdGNvbnN0IGZ1bmMgPSAkJC5tb2R1bGUuZ2V0TW9kdWxlKCdicmFpbmpzLm1hcC5wbHVnaW4uJyArIHBsdWdpbk5hbWUpXG5cdFx0XHRjb25zdCBjb25maWcgPSB0aGlzLnByb3BzLnBsdWdpbnNbcGx1Z2luTmFtZV1cblx0XHRcdGlmICh0eXBlb2YgZnVuYyA9PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGBbYnJhaW5qcy5tYXBdIGluc3RhbmNlIHBsdWdpbiAnJHtwbHVnaW5OYW1lfScgd2l0aCBjb25maWdgLCBjb25maWcpXG5cdFx0XHRcdGZ1bmMoZGF0YSwgY29uZmlnKVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdEwudGlsZUxheWVyKHRpbGVVcmwsIHtcblx0XHRcdGF0dHJpYnV0aW9uOiAnJmNvcHk7IDxhIGhyZWY9XCJodHRwczovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9jb3B5cmlnaHRcIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMnXG5cdFx0fSkuYWRkVG8obWFwKVxuXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0bWFwLmludmFsaWRhdGVTaXplKClcblx0XHR9LCAxMDApXG5cblx0XHRtYXAub24oJ2NsaWNrJywgZnVuY3Rpb24oZXYpIHtcblx0XHRcdC8vY29uc29sZS5sb2coJ1ttYXBdIG9uY2xpY2snLCBldilcblx0XHRcdGVsdC50cmlnZ2VyKCdtYXBjbGljaycsIHtsYXRsbmc6IGV2LmxhdGxuZ30pXG5cdFx0fSlcblxuXHRcdHRoaXMuZ2V0U2hhcGVzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gT2JqZWN0LmtleXMoc2hhcGVzKVxuXHRcdH1cblxuXHRcdHRoaXMudXBkYXRlU2hhcGUgPSBmdW5jdGlvbihpZCwgb3B0aW9ucykge1xuXHRcdFx0Y29uc3Qgc2hhcGUgPSBzaGFwZXNbaWRdXG5cdFx0XHRpZiAoc2hhcGUpIHtcblx0XHRcdFx0Y29uc3Qgc2hhcGVEZXNjID0gJCQubW9kdWxlLmdldE1vZHVsZSgnYnJhaW5qcy5tYXAuc2hhcGUuJyArIHNoYXBlLnR5cGUpXG5cdFx0XHRcdGlmIChzaGFwZURlc2MgJiYgdHlwZW9mIHNoYXBlRGVzYy51cGRhdGUgPT0gJ2Z1bmN0aW9uJykge1xuXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ1ticmFpbmpzLm1hcF0gdXBkYXRlU2hhcGUgd2l0aCBpZCcsIGlkKVxuXHRcdFx0XHRcdHNoYXBlRGVzYy51cGRhdGUoc2hhcGUsIG9wdGlvbnMpXG5cdFx0XHRcdFx0JC5leHRlbmQoc2hhcGUuaW5mbywgb3B0aW9ucylcblx0XHRcdFx0fVx0XHRcdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0dGhyb3cgYFticmFpbmpzLm1hcF0gdXBkYXRlU2hhcGUgaWQgJyR7aWR9JyBkb2Vzbid0IGV4aXN0YFxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuYWRkU2hhcGUgPSBmdW5jdGlvbihpZCwgb3B0aW9ucykge1xuXHRcdFx0aWYgKHNoYXBlc1tpZF0pIHtcblx0XHRcdFx0dGhyb3cgYFticmFpbmpzLm1hcF0gYWRkU2hhcGUgaWQgJyR7aWR9JyBhbHJlYWR5IGV4aXN0YFxuXHRcdFx0fVxuXHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge31cblxuXHRcdFx0aWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgIT0gJ3N0cmluZycpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignW2JyYWluanMubWFwXSBhZGRTaGFwZSwgbWlzc2luZyB0eXBlIGZpZWxkJylcblx0XHRcdFx0cmV0dXJuXG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHNoYXBlRGVzYyA9ICQkLm1vZHVsZS5nZXRNb2R1bGUoJ2JyYWluanMubWFwLnNoYXBlLicgKyBvcHRpb25zLnR5cGUpXG5cblx0XHRcdGxldCBsYXllciA9IG1hcFxuXHRcdFx0aWYgKHR5cGVvZiBvcHRpb25zLmxheWVyID09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdGxheWVyID0gbGF5ZXJzW29wdGlvbnMubGF5ZXJdXG5cdFx0XHRcdGlmIChsYXllciA9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHR0aHJvdyBgbGF5ZXIgJyR7b3B0aW9ucy5sYXllcn0nIGRvZXNuJ3QgZXhpc3RgXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKHNoYXBlRGVzYyAmJiB0eXBlb2Ygc2hhcGVEZXNjLmNyZWF0ZSA9PSAnZnVuY3Rpb24nKSB7XG5cblx0XHRcdFx0Y29uc29sZS5sb2coJ1ticmFpbmpzLm1hcF0gYWRkU2hhcGUgd2l0aCBpZCcsIGlkKVxuXHRcdFx0XHRzaGFwZSA9IHNoYXBlRGVzYy5jcmVhdGUob3B0aW9ucylcblx0XHRcdFx0c2hhcGUudHlwZSA9IG9wdGlvbnMudHlwZVxuXHRcdFx0XHRzaGFwZS5vd25sYXllciA9IGxheWVyXG5cdFx0XHRcdHNoYXBlLmluZm8gPSBvcHRpb25zXG5cdFx0XHRcdHNoYXBlLmlkID0gaWRcblx0XHRcdFx0c2hhcGVzW2lkXSA9IHNoYXBlXG5cdFx0XHRcdHNoYXBlLm9uKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdFx0Y29uc3QgZGF0YSA9IHtpZCwgbGF0bG5nOiBldi5sYXRsbmd9XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBldi50YXJnZXQuZ2V0TGF0TG5nID09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRcdGRhdGEucG9zID0gbWFwLmxhdExuZ1RvQ29udGFpbmVyUG9pbnQoZXYudGFyZ2V0LmdldExhdExuZygpKVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHQudHJpZ2dlcignbWFwc2hhcGVjb250ZXh0bWVudScsIGRhdGEpXG5cdFx0XHRcdH0pXG5cdFx0XHRcdHNoYXBlLmFkZFRvKGxheWVyKVxuXHRcdFx0fVx0XHRcdFx0XHRcblx0XHR9XG5cblx0XHR0aGlzLnJlbW92ZVNoYXBlID0gZnVuY3Rpb24oaWQpIHtcblx0XG5cdFx0XHRjb25zdCBzaGFwZSA9IHNoYXBlc1tpZF1cblx0XHRcdGlmIChzaGFwZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZygnW2JyYWluanMubWFwXSByZW1vdmVTaGFwZSB3aXRoIGlkJywgaWQpXG5cdFx0XHRcdHNoYXBlLnJlbW92ZUZyb20oc2hhcGUub3dubGF5ZXIpXG5cdFx0XHRcdGRlbGV0ZSBzaGFwZXNbaWRdXG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKGBbYnJhaW5qcy5tYXBdIHJlbW92ZVNoYXBlIGlkICcke2lkfScgZG9lc24ndCBleGlzdGApXG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHR0aGlzLmdldFNoYXBlSW5mbyA9IGZ1bmN0aW9uKGlkKSB7XG5cdFxuXHRcdFx0Y29uc3Qgc2hhcGUgPSBzaGFwZXNbaWRdXG5cdFx0XHRpZiAoc2hhcGUpIHtcblx0XHRcdFx0cmV0dXJuIHNoYXBlLmluZm9cblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oYFticmFpbmpzLm1hcF0gcmVtb3ZlU2hhcGUgaWQgJyR7aWR9JyBkb2Vzbid0IGV4aXN0YClcblx0XHRcdH1cblx0XHR9XHRcblxuXHRcdHRoaXMuZW5hYmxlSGFuZGxlcnMgPWZ1bmN0aW9uIChlbmFibGVkKSB7XG5cdFx0XHRtYXAuX2hhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24oaGFuZGxlcikge1xuXHRcdFx0XHRpZiAoZW5hYmxlZClcblx0XHRcdFx0XHRoYW5kbGVyLmVuYWJsZSgpXG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRoYW5kbGVyLmRpc2FibGUoKVxuXHRcdFx0fSlcdFx0XHRcblx0XHR9XG5cblx0XHRmb3IobGV0IHNoYXBlSWQgaW4gdGhpcy5wcm9wcy5zaGFwZXMpIHtcblx0XHRcdHRoaXMuYWRkU2hhcGUoc2hhcGVJZCwgdGhpcy5wcm9wcy5zaGFwZXNbc2hhcGVJZF0pXG5cdFx0fVxuXG5cdH1cbn0pO1xuIl19
